<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/logo32.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/logo16.ico">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"silenthly.github.io","root":"/","scheme":"Mist","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"b2t":true,"scrollpercent":true,"onmobile":true},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="我见过真正难过的人，但他一滴泪也没流">
<meta property="og:type" content="website">
<meta property="og:title" content="Buyan-Blog">
<meta property="og:url" content="https://silenthly.github.io/page/5/index.html">
<meta property="og:site_name" content="Buyan-Blog">
<meta property="og:description" content="我见过真正难过的人，但他一滴泪也没流">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="buyan">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://silenthly.github.io/page/5/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>Buyan-Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="Buyan-Blog" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Buyan-Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://silenthly.github.io/2021/08/07/Object%E7%B1%BB/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="buyan">
      <meta itemprop="description" content="我见过真正难过的人，但他一滴泪也没流">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Buyan-Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/08/07/Object%E7%B1%BB/" class="post-title-link" itemprop="url">Object类</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-08-07 20:52:54" itemprop="dateCreated datePublished" datetime="2021-08-07T20:52:54+08:00">2021-08-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-08-17 04:58:20" itemprop="dateModified" datetime="2021-08-17T04:58:20+08:00">2021-08-17</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/java/" itemprop="url" rel="index"><span itemprop="name">java</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2021/08/07/Object%E7%B1%BB/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2021/08/07/Object%E7%B1%BB/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>​		java中所有的类都直接或间接地继承自Object类，即使没有显式地使用extends关键字指定Object为父类，系统也会自动继承该类。所以说，Object类是整个java语言继承树的唯一根。</p>
<p>注意：数组和枚举类也是Object类的子类。</p>
<p>​		根据继承特性，任何java对象都可以调用Object类的方法。常用的Object类方法被人们熟知，本文主要介绍Object类中的clone()、equals()和toString()等方法，功能如下表所示。</p>
<table>
<thead>
<tr>
<th style="text-align:center">序号</th>
<th style="text-align:center">方法</th>
<th style="text-align:center">类型</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><strong>1</strong></td>
<td style="text-align:center"><strong>protected native Object clone() throws CloneNotSupportedException</strong></td>
<td style="text-align:center"><strong>普通</strong></td>
<td style="text-align:center"><strong>创建并返回与该对象相同的新对象，即克隆该对象</strong></td>
</tr>
<tr>
<td style="text-align:center"><strong>2</strong></td>
<td style="text-align:center"><strong>public boolean equals(Object obj)</strong></td>
<td style="text-align:center"><strong>普通</strong></td>
<td style="text-align:center"><strong>比较两个对象是否“相等”</strong></td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">protected void finalize() throws Thowable</td>
<td style="text-align:center">普通</td>
<td style="text-align:center">当垃圾回收器确定不存在对该对象的更多引用时，由对象的垃圾回收器调用此方法</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:center">public final Class&lt;? extends Object&gt;getClass()</td>
<td style="text-align:center">普通</td>
<td style="text-align:center">返回一个对象的运行时类</td>
</tr>
<tr>
<td style="text-align:center"><strong>5</strong></td>
<td style="text-align:center"><strong>public int hashCode()</strong></td>
<td style="text-align:center"><strong>普通</strong></td>
<td style="text-align:center"><strong>返回该对象的哈希码值</strong></td>
</tr>
<tr>
<td style="text-align:center"><strong>6</strong></td>
<td style="text-align:center"><strong>public String toString()</strong></td>
<td style="text-align:center"><strong>普通</strong></td>
<td style="text-align:center"><strong>放回该对象的字符串表示</strong></td>
</tr>
</tbody>
</table>
<h4 id="重写tostring方法"><a class="markdownIt-Anchor" href="#重写tostring方法"></a> 重写toString()方法</h4>
<p>​		java中的大多数类都会重写该方法，通常的方式是将类名及类成员的状态信息转换为字符串后返回。</p>
<p>代码示例：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Person</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Person</span><span class="params">(String name,<span class="keyword">int</span> age)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name=name;</span><br><span class="line">        <span class="keyword">this</span>.age=age;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span>	(<span class="string">&quot;姓名&quot;</span>+name+<span class="string">&quot;，年龄&quot;</span>+age);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Person p=<span class="keyword">new</span> Person(<span class="string">&quot;小强&quot;</span>,<span class="number">18</span>);</span><br><span class="line">        System.out.println(p.toString());</span><br><span class="line">        System.out.println(p);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">姓名小强，年龄<span class="number">18</span></span><br><span class="line">姓名小强，年龄<span class="number">18</span></span><br></pre></td></tr></table></figure>
<p>​		以上程序中，为了缩减代码量，没有写入setter和getter方法，但是在类中最好是写上。可以发现两次打印的结果都是相同的，这是因为System.out.println()在打印引用数据类型时，若不为空，则首先调用引用对象的toString()方法获取字符串，然后再打印字符串内容。如果没有重写toString()方法将大隐输出的是引用对象的内存地址。</p>
<h4 id="equals比较"><a class="markdownIt-Anchor" href="#equals比较"></a> equals()比较</h4>
<p>​		在比较两个字符串的内容是否相等时，我们就使用到了equals()方法。其实equals()方法源自Object类，而在Stirng类中对equals()方法进行类重写，以满足比较字符串的内容是否相等的要求。在Object类中equals()方法的定义如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object obj)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="keyword">this</span>==obj);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>​		可以看出，Object类中的equals()方法并没有比较两个对象是否相等的功能，只是判断两个引用是否指向同一个对象。在Object类中设计equals()方法就是让其子类来重写，以满足比较不同类的对象是否相等的要求。</p>
<p>代码示例：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Person</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Person</span><span class="params">(String name,<span class="keyword">int</span> age)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name=name;</span><br><span class="line">        <span class="keyword">this</span>.age=age;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object obj)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">this</span>==obj)			<span class="comment">//判断当前对象与指定对象是否相等</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">this</span>==<span class="keyword">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(!(obj <span class="keyword">instanceof</span> Person))		<span class="comment">//判断指定对象是否为Person的示例</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        Person per=(Person)obj;				<span class="comment">//将指定对象转化为Person对象</span></span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">this</span>.name.equals(per.name)&amp;&amp;<span class="keyword">this</span>.age==per.age)	<span class="comment">//比较对象的属性是否相等</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span></span><br><span class="line">        	&#123;</span><br><span class="line">            	<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        	&#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Person p1=<span class="keyword">new</span> Person(<span class="string">&quot;小强&quot;</span>,<span class="number">18</span>);</span><br><span class="line">        Person p2=<span class="keyword">new</span> Person(<span class="string">&quot;小强&quot;</span>,<span class="number">18</span>);</span><br><span class="line">        Person p3=<span class="keyword">new</span> Person(<span class="string">&quot;小明&quot;</span>,<span class="number">19</span>);</span><br><span class="line">        <span class="keyword">if</span>(p1.equals(p2))</span><br><span class="line">        &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;p1和p2相同&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span></span><br><span class="line">        	&#123;</span><br><span class="line">            	System.out.println(<span class="string">&quot;p1和p2不相同&quot;</span>);</span><br><span class="line">        	&#125;</span><br><span class="line">        <span class="keyword">if</span>(p1.equals(p3))</span><br><span class="line">        &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;p1和p3相同&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span></span><br><span class="line">        	&#123;</span><br><span class="line">            	System.out.println(<span class="string">&quot;p1和p3不相同&quot;</span>);</span><br><span class="line">        	&#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">p1和p2相同</span><br><span class="line">p1和p3不相同</span><br></pre></td></tr></table></figure>
<p>​		从程序的运行结果可以看出，重写equals()方法后可以比较两个对象是否相等。在很多时候，如果需要重写equals()方法，则必须重写hashCode()方法。</p>
<p>注意：equals()方法的形参必须是Object类型，不能是其他类型。</p>
<h4 id="重写hashcode方法"><a class="markdownIt-Anchor" href="#重写hashcode方法"></a> 重写hashCode()方法</h4>
<p>​		在java中对equals()方法和hashCode()方法有以下的约定：</p>
<p>1、在程序的执行期间，如果一个对象的equals()方法做比较所用到的信息没有被修改，则该对象多次调用的hashCode()方法返回的结果值必然是同一个整数。</p>
<p>2、如果两个对象根据equals()方法结果值是true，则调用这两个对象中任一对象的hashCode()方法必须返回同一个整数值。</p>
<p>3、如果两个对象数据equals()方法结果值为false，则调用这两个对象中人任一个对象的hashCode()方法，不要求尝试不同的整数结果。但如果不同，则可以提高散列表的性能。就是说，这两个对象的hashCode()值相同，并不代表这两个对象相等。</p>
<p>代码示例：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Person</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Person</span><span class="params">(String name,<span class="keyword">int</span> age)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name=name;</span><br><span class="line">        <span class="keyword">this</span>.age=age;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object obj)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">this</span>==obj)			<span class="comment">//判断当前对象与指定对象是否相等</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">this</span>==<span class="keyword">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(!(obj <span class="keyword">instanceof</span> Person))		<span class="comment">//判断指定对象是否为Person的示例</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        Person per=(Person)obj;				<span class="comment">//将指定对象转化为Person对象</span></span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">this</span>.name.equals(per.name)&amp;&amp;<span class="keyword">this</span>.age==per.age)	<span class="comment">//比较对象的属性是否相等</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span></span><br><span class="line">        	&#123;</span><br><span class="line">            	<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        	&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">hashCode</span><span class="params">()</span>		<span class="comment">//重写hashCode()函数</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">final</span> <span class="keyword">int</span> prime=<span class="number">13</span>;</span><br><span class="line">        <span class="keyword">int</span> result=<span class="number">13</span>;</span><br><span class="line">        result=prime*result+((name==<span class="keyword">null</span>)?<span class="number">0</span>:name.hashCode());</span><br><span class="line">        result=prime*result+age;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Person p1=<span class="keyword">new</span> Person(<span class="string">&quot;小强&quot;</span>,<span class="number">18</span>);</span><br><span class="line">        Person p2=<span class="keyword">new</span> Person(<span class="string">&quot;小强&quot;</span>,<span class="number">18</span>);</span><br><span class="line">        Person p3=<span class="keyword">new</span> Person(<span class="string">&quot;小明&quot;</span>,<span class="number">19</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;p1的哈希码：&quot;</span>+p1.hashCode());</span><br><span class="line">        System.out.println(<span class="string">&quot;p2的哈希码：&quot;</span>+p2.hashCode());</span><br><span class="line">        System.out.println(<span class="string">&quot;p3的哈希码：&quot;</span>+p3.hashCode());</span><br><span class="line">        <span class="keyword">if</span>(p1.equals(p2))</span><br><span class="line">        &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;p1和p2相同&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span></span><br><span class="line">        	&#123;</span><br><span class="line">            	System.out.println(<span class="string">&quot;p1和p2不相同&quot;</span>);</span><br><span class="line">        	&#125;</span><br><span class="line">        <span class="keyword">if</span>(p1.equals(p3))</span><br><span class="line">        &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;p1和p3相同&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span></span><br><span class="line">        	&#123;</span><br><span class="line">            	System.out.println(<span class="string">&quot;p1和p3不相同&quot;</span>);</span><br><span class="line">        	&#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">p1的哈希码：<span class="number">9816630</span></span><br><span class="line">p2的哈希码：<span class="number">9816630</span></span><br><span class="line">p3的哈希码：<span class="number">9839355</span></span><br><span class="line">p1和p2相同</span><br><span class="line">p1和p3不相同</span><br></pre></td></tr></table></figure>
<p>​		从程序运行结果可以发现，p1和p2的哈希码值相同，而p1与p3的哈希码值不同。</p>
<h4 id="克隆对象"><a class="markdownIt-Anchor" href="#克隆对象"></a> 克隆对象</h4>
<p>​		java语言支持对象的克隆。可以通过Object类中的clone()方法，创建一个和该对象的内容完全一样的对象，新的对象也会拥有独立的内存空间。</p>
<p>在Object类中clone()方法定义格式：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">native</span> Object <span class="title">clone</span><span class="params">()</span> <span class="keyword">throws</span> CloneNotSupportedException</span></span><br></pre></td></tr></table></figure>
<p>​		从格式可以看到，在Object类中的clone()是被protected修饰的，若要从系统中任意位置的类访问它，那么在重写clone()方法时，应该扩大访问权限为public。但具体的克隆方法还是在Object类中实现，所以只需在重写clone()方法中的调用Object类的clone()方法即可。需要注意的是，在对象所在的类要实现Cloneable接口，该接口只是一个标识接口，表示该对象可以被克隆。</p>
<p>代码示例：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> <span class="keyword">implements</span> <span class="title">Cloneable</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Person</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Person</span><span class="params">(String name,<span class="keyword">int</span> age)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name=name;</span><br><span class="line">        <span class="keyword">this</span>.age=age;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object obj)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">this</span>==obj)			<span class="comment">//判断当前对象与指定对象是否相等</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">this</span>==<span class="keyword">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(!(obj <span class="keyword">instanceof</span> Person))		<span class="comment">//判断指定对象是否为Person的示例</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        Person per=(Person)obj;				<span class="comment">//将指定对象转化为Person对象</span></span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">this</span>.name.equals(per.name)&amp;&amp;<span class="keyword">this</span>.age==per.age)	<span class="comment">//比较对象的属性是否相等</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span></span><br><span class="line">        	&#123;</span><br><span class="line">            	<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        	&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">hashCode</span><span class="params">()</span>		<span class="comment">//重写hashCode()函数</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">final</span> <span class="keyword">int</span> prime=<span class="number">13</span>;</span><br><span class="line">        <span class="keyword">int</span> result=<span class="number">13</span>;</span><br><span class="line">        result=prime*result+((name==<span class="keyword">null</span>)?<span class="number">0</span>:name.hashCode());</span><br><span class="line">        result=prime*result+age;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">clone</span><span class="params">()</span> <span class="keyword">throws</span> CloneNotSupportedException		<span class="comment">//重写clone()方法</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">super</span>.clone();		<span class="comment">//调用Object类的clone()方法</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span>	(<span class="string">&quot;姓名&quot;</span>+name+<span class="string">&quot;，年龄&quot;</span>+age);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> CloneNotSupportedException</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Person p1=<span class="keyword">new</span> Person(<span class="string">&quot;小强&quot;</span>,<span class="number">18</span>);</span><br><span class="line">        Person p2=(Person)p1.clone();</span><br><span class="line">        System.out.println(p1+<span class="string">&quot;p1的哈希码：&quot;</span>+p1.hashCode());</span><br><span class="line">        System.out.println(p2+<span class="string">&quot;p2的哈希码：&quot;</span>+p2.hashCode());</span><br><span class="line">        <span class="keyword">if</span>(p1.equals(p2))</span><br><span class="line">        &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;p1和p2相同&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span></span><br><span class="line">        	&#123;</span><br><span class="line">            	System.out.println(<span class="string">&quot;p1和p2不相同&quot;</span>);</span><br><span class="line">        	&#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">姓名小强，年龄18p1的哈希码：<span class="number">9816630</span></span><br><span class="line">姓名小强，年龄18p2的哈希码：<span class="number">9816630</span></span><br><span class="line">p1和p2相同</span><br></pre></td></tr></table></figure>
<p>​		从程序的运行结果可以发现，通过clone()方法克隆出来的对象p1和p2的哈希码值相同，而且内容也完全相同。</p>
<p>参考链接：</p>
<p><a target="_blank" rel="noopener" href="https://www.nhooo.com/note/qa0n6p.html">重写clone方法时，为什么需要在Java中将它声明为public？ - 经验笔记 (nhooo.com)</a></p>
<p>参考书目：</p>
<p><a target="_blank" rel="noopener" href="http://product.dangdang.com/23248198.html?ref=book-35530-3032_5-231497-4">《Java编程手记——从实践中学习Java（配光盘）》(欧二强　等编著)【简介_书评_在线阅读】 - 当当图书 (dangdang.com)</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://silenthly.github.io/2021/08/07/%E7%BA%BF%E7%A8%8B%E9%97%B4%E7%9A%84%E9%80%9A%E4%BF%A1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="buyan">
      <meta itemprop="description" content="我见过真正难过的人，但他一滴泪也没流">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Buyan-Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/08/07/%E7%BA%BF%E7%A8%8B%E9%97%B4%E7%9A%84%E9%80%9A%E4%BF%A1/" class="post-title-link" itemprop="url">线程间的通信</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-08-07 10:45:23" itemprop="dateCreated datePublished" datetime="2021-08-07T10:45:23+08:00">2021-08-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-08-14 17:18:36" itemprop="dateModified" datetime="2021-08-14T17:18:36+08:00">2021-08-14</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/java/" itemprop="url" rel="index"><span itemprop="name">java</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2021/08/07/%E7%BA%BF%E7%A8%8B%E9%97%B4%E7%9A%84%E9%80%9A%E4%BF%A1/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2021/08/07/%E7%BA%BF%E7%A8%8B%E9%97%B4%E7%9A%84%E9%80%9A%E4%BF%A1/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>​		多线程的主要作用是多个线程处理锁个不同的任务，这就必然存在多个线程的协调问题。在运用多线程时，除了可以使用synchronized关键字，让多个线程实现同步处理之外，还可以利用Object类中的notify()、notifyAll()和wait()方法，让多个同时处理的线程之间能能够主动的&quot;沟通协调&quot;。</p>
<p>​		java.lang.Object类是所有类的父类，该类中有以上提到的notify()、notifyAll()和wait()方法，它们时专门用于线程通信的方法。它们的作用如下表所示。(等待池与锁池的概念在线程同步一文里面有介绍)</p>
<table>
<thead>
<tr>
<th style="text-align:center">序号</th>
<th style="text-align:center">方法</th>
<th style="text-align:center">类型</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><strong>1</strong></td>
<td style="text-align:center"><strong>public final void notify()</strong></td>
<td style="text-align:center"><strong>普通</strong></td>
<td style="text-align:center"><strong>唤醒等待池中的线程。当执行该方法时，从此对象等待池中随机选择一个线程放到对象的锁池中</strong></td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">public final void notifyAll()</td>
<td style="text-align:center">普通</td>
<td style="text-align:center">唤醒等待池中的所有线程。当执行该方法时，从此对象等待池中随机选择一个线程放到对象的锁池中</td>
</tr>
<tr>
<td style="text-align:center"><strong>3</strong></td>
<td style="text-align:center"><strong>public final void wait() throws InterruptedException</strong></td>
<td style="text-align:center"><strong>普通</strong></td>
<td style="text-align:center"><strong>使当前的线程等待，并让该线程释放对象锁，放进对象的等待池中，等待其他线程将其唤醒</strong></td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:center">public final void wait(long timeout) throws InterruptedException</td>
<td style="text-align:center">普通</td>
<td style="text-align:center">与前者类似，指定等待的最长时间，以毫秒为单位</td>
</tr>
<tr>
<td style="text-align:center">5</td>
<td style="text-align:center">public final void wait(long timeout,int nanos) throws InterruptedException</td>
<td style="text-align:center">普通</td>
<td style="text-align:center">与前者类似，指定等待的最长时间为毫秒加纳秒，时间精度更高</td>
</tr>
</tbody>
</table>
<p>​		下面通过一个范例来介绍多线程的通信问题。有两个线程，分别为sf和gf，sf用来放置食物，gf用来取走食物，并规定：</p>
<p>1、sf一次只能放置一批次的食物，sf放置好食物后通知gf取走。</p>
<p>2、gf也只能一次取走一批次的食物，等到gf取走食物后通知sf放置食物。</p>
<p>3、sf不放置食物，则gf不能取走食物，若gf没有取走食物，则sf不能放置食物。</p>
<p>4、开始时，先由sf放置，再由gf取走</p>
<p><strong>代码示例：</strong></p>
<p>食物类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Food</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> number=<span class="number">0</span>;			<span class="comment">//食物批次</span></span><br><span class="line">    <span class="keyword">private</span> String food=<span class="keyword">null</span>;		<span class="comment">//食物名称</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Food</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Food</span><span class="params">(String food,<span class="keyword">int</span> number)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.food=food;</span><br><span class="line">        <span class="keyword">this</span>.number=number;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">setFood</span><span class="params">(<span class="keyword">int</span> n)</span>			<span class="comment">//放置食物</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(number!=<span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">try</span></span><br><span class="line">            &#123;</span><br><span class="line">                wait();			<span class="comment">//等待取走食物</span></span><br><span class="line">            &#125;<span class="keyword">catch</span>(InterruptedException e)</span><br><span class="line">            	&#123;</span><br><span class="line">                	e.printStackTrace();</span><br><span class="line">            	&#125;</span><br><span class="line">        &#125;</span><br><span class="line">        number=n;			<span class="comment">//返回批次</span></span><br><span class="line">        System.out.println(<span class="string">&quot;放置&quot;</span>+food+<span class="string">&quot;第&quot;</span>+number+<span class="string">&quot;批次&quot;</span>);</span><br><span class="line">        notify();			<span class="comment">//通知取走食物</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> String <span class="title">getFood</span><span class="params">()</span>		<span class="comment">//取走食物</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(number==<span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">try</span></span><br><span class="line">            &#123;</span><br><span class="line">                wait();			<span class="comment">//等待放置食物</span></span><br><span class="line">            &#125;<span class="keyword">catch</span>(InterruptedException e)</span><br><span class="line">            	&#123;</span><br><span class="line">                	e.printStackTrace();</span><br><span class="line">            	&#125;</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">&quot;\t取走第&quot;</span>+number+<span class="string">&quot;批次&quot;</span>+food);</span><br><span class="line">        number=<span class="number">0</span>;</span><br><span class="line">        notify();			<span class="comment">//通知放置食物</span></span><br><span class="line">        <span class="keyword">return</span> food+number;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Food f=<span class="keyword">new</span> Food(<span class="string">&quot;火腿&quot;</span>,<span class="number">0</span>);</span><br><span class="line">        SetFood sf=<span class="keyword">new</span> SetFood(f);</span><br><span class="line">        GetFood gf=<span class="keyword">new</span> GetFood(f);</span><br><span class="line">        <span class="keyword">new</span> Thread(sf).start();</span><br><span class="line">        <span class="keyword">new</span> Thread(gf).start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>放置食物类：SetFood</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SetFood</span> <span class="keyword">implements</span> <span class="title">Runnable</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Food food;			<span class="comment">//创建对象引用</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">SetFood</span><span class="params">(Food food)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.food=food;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> number=<span class="number">1</span>;number&lt;=<span class="number">5</span>;number++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">try</span></span><br><span class="line">            &#123;</span><br><span class="line">                Thread.sleep(<span class="number">100</span>);</span><br><span class="line">            &#125;<span class="keyword">catch</span>(InterruptedException e)</span><br><span class="line">            	&#123;</span><br><span class="line">                	e.printStackTrace();</span><br><span class="line">            	&#125;</span><br><span class="line">            food.setFood(number);		<span class="comment">//放置食物</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>取走食物类：GetFood</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GetFood</span> <span class="keyword">implements</span> <span class="title">Runnable</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Food food;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">GetFood</span><span class="params">(Food food)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.food=food;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> number=<span class="number">1</span>;number&lt;=<span class="number">5</span>;number++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">try</span></span><br><span class="line">            &#123;</span><br><span class="line">                Thread.sleep(<span class="number">500</span>);</span><br><span class="line">            &#125;<span class="keyword">catch</span>(InterruptedException e)</span><br><span class="line">            	&#123;</span><br><span class="line">                	e.printStackTrace();</span><br><span class="line">            	&#125;</span><br><span class="line">            food.getFood();		<span class="comment">//放置食物</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">放置火腿第1批次</span><br><span class="line">        取走第1批次火腿</span><br><span class="line">放置火腿第2批次</span><br><span class="line">        取走第2批次火腿</span><br><span class="line">放置火腿第3批次</span><br><span class="line">        取走第3批次火腿</span><br><span class="line">放置火腿第4批次</span><br><span class="line">        取走第4批次火腿</span><br><span class="line">放置火腿第5批次</span><br><span class="line">        取走第5批次火腿</span><br></pre></td></tr></table></figure>
<p>​		从程序结果可以发现，每放置一批食物就要等待取走，每一次取走食物就要等待放置食物，避免了重复生成和重复取走的问题。</p>
<p>注意：在调用同一个对象的wait()和notify()方法的语句必须放在同步代码块中，并且同步代码块使用该对象的同步锁，否则在运行时将会抛出InterruptedException异常。</p>
<p>参考书目：</p>
<p><a target="_blank" rel="noopener" href="http://product.dangdang.com/23248198.html?ref=book-35530-3032_5-231497-4">《Java编程手记——从实践中学习Java（配光盘）》(欧二强　等编著)【简介_书评_在线阅读】 - 当当图书 (dangdang.com)</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://silenthly.github.io/2021/08/06/%E7%BA%BF%E7%A8%8B%E5%90%8C%E6%AD%A5/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="buyan">
      <meta itemprop="description" content="我见过真正难过的人，但他一滴泪也没流">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Buyan-Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/08/06/%E7%BA%BF%E7%A8%8B%E5%90%8C%E6%AD%A5/" class="post-title-link" itemprop="url">线程同步</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-08-06 07:14:23" itemprop="dateCreated datePublished" datetime="2021-08-06T07:14:23+08:00">2021-08-06</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-08-24 21:15:37" itemprop="dateModified" datetime="2021-08-24T21:15:37+08:00">2021-08-24</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/java/" itemprop="url" rel="index"><span itemprop="name">java</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2021/08/06/%E7%BA%BF%E7%A8%8B%E5%90%8C%E6%AD%A5/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2021/08/06/%E7%BA%BF%E7%A8%8B%E5%90%8C%E6%AD%A5/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>​		当一个多线程应用程序同时执行多个任务时，这些任务之间有时需要通信与同步，这时可能会出现线程冲突问题。线程安全问题是不容忽视的，但是线程安全问题很难被发现，如多个线程要操作统一资源时就有可能产生程序资源同步问题。(线程安全是指多线程访问同一代码，不会产生不确定的结果)</p>
<h3 id="同步的必要性"><a class="markdownIt-Anchor" href="#同步的必要性"></a> 同步的必要性</h3>
<p>​		如前面讲过的电影院售票系统，从表面上看是没有什么问题。但是在售票时网络是不能实时传输的，总是存在延迟的情况，所以在售出一张门票后，需要一点时间延迟。下面通过范例来了解线程不是同步时，将会出现什么情况。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Ticket</span> <span class="keyword">implements</span> <span class="title">Runnable</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> ticket=<span class="number">10</span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">while</span>(ticket&gt;<span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">try</span></span><br><span class="line">            &#123;</span><br><span class="line">                Thread.sleep(<span class="number">100</span>);			<span class="comment">//模拟售票耗时过程</span></span><br><span class="line">            &#125;<span class="keyword">catch</span>(InterruptedException e)</span><br><span class="line">            	&#123;</span><br><span class="line">                	e.printStackTrace();</span><br><span class="line">            	&#125;</span><br><span class="line">            <span class="keyword">if</span>(ticket&gt;<span class="number">0</span>)</span><br><span class="line">         	&#123;</span><br><span class="line">             	System.out.println(Thread.currentThread().getName()+<span class="string">&quot; 售出第&quot;</span>+(ticket--)+<span class="string">&quot;张门票&quot;</span>);</span><br><span class="line">         	&#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Ticket window=<span class="keyword">new</span> Ticket();</span><br><span class="line">        Thread t1=<span class="keyword">new</span> Thread(window,<span class="string">&quot;第一窗口&quot;</span>);</span><br><span class="line">        Thread t2=<span class="keyword">new</span> Thread(window,<span class="string">&quot;第二窗口&quot;</span>);</span><br><span class="line">        t1.start();</span><br><span class="line">        t2.start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">第二窗口卖出第<span class="number">10</span>张门票.....</span><br><span class="line">第一窗口卖出第<span class="number">9</span>张门票.....</span><br><span class="line">第二窗口卖出第<span class="number">8</span>张门票.....</span><br><span class="line">第一窗口卖出第<span class="number">8</span>张门票.....</span><br><span class="line">第二窗口卖出第<span class="number">7</span>张门票.....</span><br><span class="line">第一窗口卖出第<span class="number">6</span>张门票.....</span><br><span class="line">第二窗口卖出第<span class="number">5</span>张门票.....</span><br><span class="line">第一窗口卖出第<span class="number">4</span>张门票.....</span><br><span class="line">第一窗口卖出第<span class="number">3</span>张门票.....</span><br><span class="line">第二窗口卖出第<span class="number">2</span>张门票.....</span><br><span class="line">第一窗口卖出第<span class="number">1</span>张门票.....</span><br><span class="line">第二窗口卖出第<span class="number">1</span>张门票.....</span><br></pre></td></tr></table></figure>
<p>​		从程序的运行结果可以发现，第1张与第8张票被卖出两次，卖出的是重票，这是绝对不允许的。出现这样的情况，是由于一个线程在没有对票数进行减一操作时，其他线程已对票数进行了减一操作。在java语言中，解决同步问题的方法有两种，一种是同步代码块，另一种是同步方法。</p>
<h3 id="同步机制"><a class="markdownIt-Anchor" href="#同步机制"></a> 同步机制</h3>
<p>​		为了避免多线程在共享资源时发生冲突，所以要在线程使用该资源时，就为资源上一把“锁”。第一个访问资源的线程为资源上锁，其他线程若想访问该资源，则必须等到第一个访问线程对资源解锁。解锁的同时，另一个线程访问资源并为资源上锁。</p>
<h4 id="同步机制的实现"><a class="markdownIt-Anchor" href="#同步机制的实现"></a> 同步机制的实现</h4>
<p>​		同步机制的实现需要依赖Synchronized关键字，在多线程并发编程中Synchronized一直是元老级角色，很多人都会称呼它为重量级锁，但是随着Java SE1.6对synchronized进行了各种优化之后，有些情况下它并不那么重了。在了解锁的概念之前，需要记住，<strong>java中的每一个对象都有一个锁，且是唯一的。</strong></p>
<h4 id="同步代码块"><a class="markdownIt-Anchor" href="#同步代码块"></a> 同步代码块</h4>
<p>格式：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">synchronized</span>(lock)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//操作共享资源代码块</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="锁与锁池的概念"><a class="markdownIt-Anchor" href="#锁与锁池的概念"></a> 锁与锁池的概念</h5>
<p>​		上述代码中，lock是一个锁对象，可以是任意类型的对象，它是同步代码块的关键。当线程执行同步代码块时，首先会检查<strong>锁对象的标志位(即锁对象的&quot;锁&quot;)</strong>，默认情况下标志位为1，此时线程会执行同步代码块，同时<strong>将锁对象的标志位设置为0(即线程获得锁对象的锁)</strong>。</p>
<p>​		当一个新的线程执行到这段同步代码块时，由于锁对象的标志位为0，新线程会发生阻塞**(线程的生命周期状态会被调整为BLOCKED)<strong>，此时新线程就会被放进</strong>锁池**，等待当前线程执行完同步代码块后，<strong>锁对象的标志位被置为1(即释放锁)</strong>，锁池中的任意一个线程会被唤醒**(只能有一个)<strong>，唤醒的线程与其他活跃线程</strong>(即不在锁池中，且线程的生命周期状态为RUNNABLE的线程)**抢占这个锁，若被唤醒的线程抢到锁，那么该线程就从锁池中移除，否则将再次暂停。这样循环往复，直到共享资源被处理完为止。</p>
<p><span style="color:red;background:背景颜色;font-size:文字大小;font-family:字体;">注意：实际上在java中并没有锁池的概念，真正的锁池并不是这个名字，这里使用“锁池”便于理解，若要了解同步阻塞的相关内容，必须回归其实质，否则将不得其法。</span>(<a href="%5BJava%E7%9A%84%E9%94%81%E6%B1%A0%E4%B8%8E%E5%AF%B9%E8%B1%A1%E6%B1%A0_%E6%B8%85%E6%AC%A2-CSDN%E5%8D%9A%E5%AE%A2_java%E9%94%81%E6%B1%A0%5D(https://blog.csdn.net/qq_42191317/article/details/96333961)">点击此处详细了解锁池的实质</a>)</p>
<blockquote>
<p>1、<strong>对象的同步锁在任何时刻最多只能被一个线程所拥有。</strong></p>
<p>2、当拥有锁对象的锁的线程t执行完后，会自动释放锁对象的锁。若在执行中，线程t发生异常退出，也将自动释放锁对象的锁。</p>
<p>3、如果线程t在执行同步代码块时，调用了锁对象的wait()方法，则同样会自动释放锁对象的锁，线程t也将转为阻塞状态。</p>
<p>4、如果线程t在执行同步代码块时，调用了锁对象的sleep()方法，线程t将会放弃cpu运行权，<strong>但不会放弃锁对象的锁</strong>。</p>
</blockquote>
<p>代码示例：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Ticket</span> <span class="keyword">implements</span> <span class="title">Runnable</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> ticket=<span class="number">1000</span>;</span><br><span class="line">    Object lock=<span class="keyword">new</span> Object();		<span class="comment">//定义任意一个对象，用作同步代码块的锁</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">while</span>(ticket&gt;<span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">synchronized</span>(lock)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">try</span></span><br><span class="line">            	&#123;</span><br><span class="line">                	Thread.sleep(<span class="number">10</span>);			<span class="comment">//模拟售票耗时过程</span></span><br><span class="line">            	&#125;<span class="keyword">catch</span>(InterruptedException e)</span><br><span class="line">            		&#123;</span><br><span class="line">                		e.printStackTrace();</span><br><span class="line">            		&#125;</span><br><span class="line">            	<span class="keyword">if</span>(ticket&gt;<span class="number">0</span>)</span><br><span class="line">         		&#123;</span><br><span class="line">             		System.out.println(Thread.currentThread().getName()+<span class="string">&quot; 售出第&quot;</span>+(ticket--)+<span class="string">&quot;张门票&quot;</span>);</span><br><span class="line">         		&#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Ticket window=<span class="keyword">new</span> Ticket();</span><br><span class="line">        Thread t1=<span class="keyword">new</span> Thread(window,<span class="string">&quot;窗口1 &quot;</span>);</span><br><span class="line">        Thread t2=<span class="keyword">new</span> Thread(window,<span class="string">&quot;窗口2 &quot;</span>);</span><br><span class="line">        Thread t3=<span class="keyword">new</span> Thread(window,<span class="string">&quot;窗口3 &quot;</span>);</span><br><span class="line">        Thread t4=<span class="keyword">new</span> Thread(window,<span class="string">&quot;窗口4 &quot;</span>);</span><br><span class="line">        t1.start();</span><br><span class="line">        t2.start();</span><br><span class="line">        t3.start();</span><br><span class="line">        t4.start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">窗口<span class="number">1</span>  售出第<span class="number">10</span>张门票</span><br><span class="line">窗口<span class="number">1</span>  售出第<span class="number">9</span>张门票</span><br><span class="line">窗口<span class="number">1</span>  售出第<span class="number">8</span>张门票</span><br><span class="line">窗口<span class="number">1</span>  售出第<span class="number">7</span>张门票</span><br><span class="line">窗口<span class="number">1</span>  售出第<span class="number">6</span>张门票</span><br><span class="line">窗口<span class="number">1</span>  售出第<span class="number">5</span>张门票</span><br><span class="line">窗口<span class="number">1</span>  售出第<span class="number">4</span>张门票</span><br><span class="line">窗口<span class="number">1</span>  售出第<span class="number">3</span>张门票</span><br><span class="line">窗口<span class="number">1</span>  售出第<span class="number">2</span>张门票</span><br><span class="line">窗口<span class="number">1</span>  售出第<span class="number">1</span>张门票</span><br></pre></td></tr></table></figure>
<p>​		从运行结果发现，没有出现卖出重票的情况，解决了线程安全问题。但从结果上看似乎只有一个线程在执行，其他的三个线程似乎没有什么用。线程这个现象不好解释，在网上查找了许多资料，统合得出结论，这个现象与电脑的cpu有关。</p>
<h5 id="cpu与线程的关系"><a class="markdownIt-Anchor" href="#cpu与线程的关系"></a> cpu与线程的关系</h5>
<p>​		前面我们讲过，当有多个线程在操作时，如果系统只有一个CPU，则它根本不可能真正同时进行一个以上的线程，它只能把CPU运行时间划分成若干个时间段，再将时间段分配给各个线程执行，在一个时间段的线程代码运行时，其它线程处于挂起状态。</p>
<p>​		所以一个线程的执行，需要cpu为其分配时间段。若线程用完了cpu分配的时间时，线程的run()方法还没执行完，那么cpu将会重新为其分配时间；若线程在时间结束前，完成了run()方法，将结束线程，并把时间分给其他线程。</p>
<p>​		在run()方法中，若程序把线程任务放在一个循环中，如while循环，那么线程只有在cpu分配的时间结束时或线程把while循环的任务内容全部做完后的情况下才结束线程。若cpu的性能比较高，那么线程可能会在给定的时间内提前完成while循环的内容，从而出现了上述只有一个线程运行的情况。</p>
<p><img src="https://silenthty.gitee.io/photo/java%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1/%E7%BA%BF%E7%A8%8B1.png" alt="" /></p>
<center>图1</center>
<p><img src="https://silenthty.gitee.io/photo/java%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1/%E7%BA%BF%E7%A8%8B2.png" alt="" /></p>
<center>图2</center>
<p>​		当把循环次数扩大到1000时，该程序一开始由线程2执行，在售出第317张票时，由cpu分配给线程2的时间耗尽，线程2结束。而此时并没有运行完循环的内容，将交给下一个线程去继续执行。需要注意的是，cpu给线程分配的时间并不是固定的，所以有可能当while循环内的任务完成，线程还没结束。</p>
<blockquote>
<p>注意：同步代码块中的锁对象可以是任意类型的对象，它可以是虚假的对象，以实例对象的变量形式存在，仅为了发挥锁的作用而存在，以上代码便是以这种方式实现多线程同步。它也可以是真实的，以当前的实例对象作为锁对象。**但无论是真实的还是虚假的对象，必须满足多个线程共享的锁对象必须是相同的。**所以锁对象的创建代码不能放到run()方法中，否则每个线程运行到run()方法都会创建一个新对象，这样每个线程都会有一个不同的锁，每个锁都有自己的标志位，线程之间便不能产生同步的效果。</p>
</blockquote>
<h4 id="同步方法"><a class="markdownIt-Anchor" href="#同步方法"></a> 同步方法</h4>
<p>​		除了可以使用synchronized关键字将需要的代码设置为同步代码块外，还可以使用synchronized关键字来修饰某个方法，该方法称为同步方法，可以实现多个线程间的同步。</p>
<p>格式：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[访问控制符] [<span class="keyword">static</span>|<span class="keyword">final</span>] <span class="keyword">synchronized</span> 返回类型 方法名(参数列表)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//同步代码</span></span><br><span class="line">    [<span class="keyword">return</span> 返回值]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>​		从以上的定义格式可以发现，同步方法可以分为非静态同步方法和静态同步方法。</p>
<h5 id="非静态同步方法"><a class="markdownIt-Anchor" href="#非静态同步方法"></a> 非静态同步方法</h5>
<p>​		在同步方法的定义格式中，并没有发现锁对象，那同步方法是如何实现”锁“的功能？其实，<strong>非静态同步方法的锁对象为”调用该方法的当前实例对象“</strong>，当线程调用同步方法时，它将自动获取该方法对象的内在锁，在该方法释放锁之前，该对象的其他线程都无法访问该对象的任何同步方法，但可以调用其他非同步方法。需要注意的是，非静态同步方法的作用范围为一个对象，对其他对象是不起作用的，其他对象的线程也能调用该方法。当然，其他对象调用该方法只能调用那个对象的数据资源，而不能调用该对象的数据资源。</p>
<p>代码示例：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Ticket</span> <span class="keyword">implements</span> <span class="title">Runnable</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> ticket=<span class="number">10</span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">while</span>(ticket&gt;<span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">try</span>			<span class="comment">//当前线程让出cpu运行权</span></span><br><span class="line">        	&#123;</span><br><span class="line">            	Thread.sleep(<span class="number">10</span>);</span><br><span class="line">        	&#125;<span class="keyword">catch</span>(InterruptedException e)</span><br><span class="line">            	&#123;</span><br><span class="line">                	e.printStackTrace();</span><br><span class="line">            	&#125;</span><br><span class="line">            sale();		<span class="comment">//调用同步方法</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">sale</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            Thread.sleep(<span class="number">10</span>);			<span class="comment">//模拟售票耗时过程</span></span><br><span class="line">        &#125;<span class="keyword">catch</span>(InterruptedException e)</span><br><span class="line">            &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">         <span class="keyword">if</span>(ticket&gt;<span class="number">0</span>)</span><br><span class="line">         &#123;</span><br><span class="line">             System.out.println(Thread.currentThread().getName()+<span class="string">&quot; 售出第&quot;</span>+(ticket--)+<span class="string">&quot;张门票&quot;</span>);</span><br><span class="line">         &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Ticket window1=<span class="keyword">new</span> Ticket();</span><br><span class="line">        Ticket window2=<span class="keyword">new</span> Ticket();</span><br><span class="line">        Thread t1=<span class="keyword">new</span> Thread(window1,<span class="string">&quot;窗口1-资源1&quot;</span>);</span><br><span class="line">        Thread t2=<span class="keyword">new</span> Thread(window1,<span class="string">&quot;窗口2-资源1&quot;</span>);</span><br><span class="line">        Thread t3=<span class="keyword">new</span> Thread(window2,<span class="string">&quot;窗口3-资源2&quot;</span>);</span><br><span class="line">        Thread t4=<span class="keyword">new</span> Thread(window2,<span class="string">&quot;窗口4-资源2&quot;</span>);</span><br><span class="line">        t1.start();</span><br><span class="line">        t2.start();</span><br><span class="line">        t3.start();</span><br><span class="line">        t4.start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">窗口<span class="number">4</span>-资源<span class="number">2</span> 售出第<span class="number">10</span>张门票</span><br><span class="line">窗口<span class="number">1</span>-资源<span class="number">1</span> 售出第<span class="number">10</span>张门票</span><br><span class="line">窗口<span class="number">2</span>-资源<span class="number">1</span> 售出第<span class="number">9</span>张门票</span><br><span class="line">窗口<span class="number">3</span>-资源<span class="number">2</span> 售出第<span class="number">9</span>张门票</span><br><span class="line">窗口<span class="number">4</span>-资源<span class="number">2</span> 售出第<span class="number">8</span>张门票</span><br><span class="line">窗口<span class="number">1</span>-资源<span class="number">1</span> 售出第<span class="number">8</span>张门票</span><br><span class="line">窗口<span class="number">3</span>-资源<span class="number">2</span> 售出第<span class="number">7</span>张门票</span><br><span class="line">窗口<span class="number">2</span>-资源<span class="number">1</span> 售出第<span class="number">7</span>张门票</span><br><span class="line">窗口<span class="number">1</span>-资源<span class="number">1</span> 售出第<span class="number">6</span>张门票</span><br><span class="line">窗口<span class="number">4</span>-资源<span class="number">2</span> 售出第<span class="number">6</span>张门票</span><br><span class="line">窗口<span class="number">3</span>-资源<span class="number">2</span> 售出第<span class="number">5</span>张门票</span><br><span class="line">窗口<span class="number">2</span>-资源<span class="number">1</span> 售出第<span class="number">5</span>张门票</span><br><span class="line">窗口<span class="number">4</span>-资源<span class="number">2</span> 售出第<span class="number">4</span>张门票</span><br><span class="line">窗口<span class="number">1</span>-资源<span class="number">1</span> 售出第<span class="number">4</span>张门票</span><br><span class="line">窗口<span class="number">3</span>-资源<span class="number">2</span> 售出第<span class="number">3</span>张门票</span><br><span class="line">窗口<span class="number">2</span>-资源<span class="number">1</span> 售出第<span class="number">3</span>张门票</span><br><span class="line">窗口<span class="number">1</span>-资源<span class="number">1</span> 售出第<span class="number">2</span>张门票</span><br><span class="line">窗口<span class="number">4</span>-资源<span class="number">2</span> 售出第<span class="number">2</span>张门票</span><br><span class="line">窗口<span class="number">3</span>-资源<span class="number">2</span> 售出第<span class="number">1</span>张门票</span><br><span class="line">窗口<span class="number">2</span>-资源<span class="number">1</span> 售出第<span class="number">1</span>张门票</span><br></pre></td></tr></table></figure>
<p>​		以上程序，为了观察线程的同步情况，在调用同步方法前，使用了sleep()方法把运行权让出，以便所有线程都有机会执行任务。从程序运行结果上看，这四个线程都调用了同步方法sale()方法，其中，线程t1和线程t2使用同一个实例对象window1创建多线程，所以他们使用的资源相同。而线程t3和线程t4使用另一个实例对象window2创建多线程，所以他们使用的资源相同。两者之间的数据互不影响，所以非静态同步方法的作用范围为一个对象，在该对象范围内不会出现线程安全问题。</p>
<h5 id="静态同步方法"><a class="markdownIt-Anchor" href="#静态同步方法"></a> 静态同步方法</h5>
<p>​		与非静态同步方法不同的是，当调用一个静态同步方法时，该方法的锁对象并不是调用该方法的当前实例对象，而是当前实例对象对应的class对象，即类对象。该方法的作用范围为当前类对象所有实例对象，当一个线程调用了某个类的静态同步方法，其他线程都不能调用该类的其他静态同步方法，但是可以调用非静态同步方法，对该类的所有实例对象都起作用。</p>
<p>​		为什么静态同步方法锁定的对象为class对象呢？由于在调用静态方法时，对象实例不一定被创建，因此，就不能使用this来同步静态方法，而必须使用class对象来同步静态方法。</p>
<p>代码示例：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Demo</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> ticket=<span class="number">10</span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">getTicket</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ticket;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">methodLock</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">         <span class="keyword">if</span>(ticket&gt;<span class="number">0</span>)</span><br><span class="line">         &#123;</span><br><span class="line">             System.out.println(Thread.currentThread().getName()+<span class="string">&quot; 售出第&quot;</span>+(ticket--)+<span class="string">&quot;张门票&quot;</span>);</span><br><span class="line">         &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> <span class="keyword">implements</span> <span class="title">Runnable</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">while</span>(Demo.getTicket()&gt;<span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">try</span>			<span class="comment">//当前线程让出cpu运行权</span></span><br><span class="line">        	&#123;</span><br><span class="line">            	Thread.sleep(<span class="number">10</span>);</span><br><span class="line">        	&#125;<span class="keyword">catch</span>(InterruptedException e)</span><br><span class="line">            	&#123;</span><br><span class="line">                	e.printStackTrace();</span><br><span class="line">            	&#125;</span><br><span class="line">            Demo.methodLock();		<span class="comment">//直接通过类名调用静态同步方法</span></span><br><span class="line">         &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Test window1=<span class="keyword">new</span> Test();</span><br><span class="line">        Test window2=<span class="keyword">new</span> Test();</span><br><span class="line">        Thread t1=<span class="keyword">new</span> Thread(window1,<span class="string">&quot;窗口1 &quot;</span>);</span><br><span class="line">        Thread t2=<span class="keyword">new</span> Thread(window2,<span class="string">&quot;窗口2 &quot;</span>);</span><br><span class="line">        Thread t3=<span class="keyword">new</span> Thread(window2,<span class="string">&quot;窗口3 &quot;</span>);</span><br><span class="line">        t1.start();</span><br><span class="line">        t2.start();</span><br><span class="line">        t3.start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">窗口<span class="number">2</span>  售出第<span class="number">10</span>张门票</span><br><span class="line">窗口<span class="number">1</span>  售出第<span class="number">9</span>张门票</span><br><span class="line">窗口<span class="number">3</span>  售出第<span class="number">8</span>张门票</span><br><span class="line">窗口<span class="number">2</span>  售出第<span class="number">7</span>张门票</span><br><span class="line">窗口<span class="number">3</span>  售出第<span class="number">6</span>张门票</span><br><span class="line">窗口<span class="number">1</span>  售出第<span class="number">5</span>张门票</span><br><span class="line">窗口<span class="number">3</span>  售出第<span class="number">4</span>张门票</span><br><span class="line">窗口<span class="number">2</span>  售出第<span class="number">3</span>张门票</span><br><span class="line">窗口<span class="number">1</span>  售出第<span class="number">2</span>张门票</span><br><span class="line">窗口<span class="number">3</span>  售出第<span class="number">1</span>张门票</span><br></pre></td></tr></table></figure>
<p>​		同上面一样，为了观察线程活动情况，在调用静态同步方法时，使用sleep()方法让出运行权。从程序结果可以发现，线程t1与线程t2、线程t3使用了不同对象创建线程，而线程t2与线程t3是同一个对象的多线程，但这三个线程共同实现了资源同步，没有出现售卖重票的问题。</p>
<h3 id="对象锁与类锁"><a class="markdownIt-Anchor" href="#对象锁与类锁"></a> 对象锁与类锁</h3>
<p>​		上述同步机制使用同步代码块、同步方法解决了线程安全问题，虽然结果一样，但他们的运行过程大不一样，最明显的区别是同步代码块或同步方法在实现同步时所引用的锁对象不尽相同。</p>
<p>1、对于同步方法块，锁对象是Synchronized括号里配置的对象</p>
<p>2、对于非静态同步方法，锁对象是当前实例对象。</p>
<p>3、对于静态同步方法，锁对象是当前对象的Class对象。</p>
<p>​		根据锁对象的引用不同可分为对象锁和类锁，其中情况1和情况2属于对象锁，情况3属于类锁。对象锁。。。算了，累了，先看连接吧，后面再整理。</p>
<p>传送门：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/fengzheng/p/12066239.html">面试官：请说一下对象锁和类锁的区别 - 风的姿态 - 博客园 (cnblogs.com)</a></p>
<h3 id="同步锁"><a class="markdownIt-Anchor" href="#同步锁"></a> 同步锁</h3>
<p>​		synchronized同步代码块和同步方法使用一种封闭式的锁机制，使用起来非常简单，也能够解决线程同步过程中出现的线程安全问题，但也有一些限制，例如它无法中断一个正在等候获得锁的过程，也无法通过轮询得到锁，如果不想等下去，也就没法得锁。</p>
<p>​		从JDk1.5开始，java增加了一个功能更加强大的Lock锁。Lock锁与synchronized隐式锁在功能上基本相同，其最大的优势在于Lock锁可以让某个线程在持续获取同步锁失败后返回，不再继续等待，另外Lock锁在使用时也更加灵活。</p>
<p>​		其中，可通过java.util.concurrent.locks.ReentrantLock类的对象调用lock()方法来实现加锁操作，此时可以进行同步操作。同步操作结束后，调用unlock()方法释放同步锁。</p>
<p>代码示例：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.concurrent.locks.*;		<span class="comment">//*为通配符，在后面讲解</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Ticket</span> <span class="keyword">implements</span> <span class="title">Runnable</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> ReentrantLock lock=<span class="keyword">new</span> ReentrantLock();		<span class="comment">//创建锁</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> ticket=<span class="number">10</span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">while</span>(ticket&gt;<span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            lock.lock();		<span class="comment">//加锁</span></span><br><span class="line">            <span class="keyword">try</span></span><br><span class="line">            &#123;</span><br><span class="line">                Thread.sleep(<span class="number">10</span>);</span><br><span class="line">            &#125;<span class="keyword">catch</span>(InterruptedException e)</span><br><span class="line">            	&#123;</span><br><span class="line">                	e.printStackTrace();</span><br><span class="line">            	&#125;</span><br><span class="line">            <span class="keyword">if</span>(ticket&gt;<span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                System.out.println(Thread.currentThread().getName()+<span class="string">&quot; 售出第&quot;</span>+(ticket--)+<span class="string">&quot;张门票&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            lock.unlock();		<span class="comment">//释放锁</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Ticket window=<span class="keyword">new</span> Ticket();</span><br><span class="line">        Thread t1=<span class="keyword">new</span> Thread(window,<span class="string">&quot;窗口1&quot;</span>);</span><br><span class="line">        Thread t2=<span class="keyword">new</span> Thread(window,<span class="string">&quot;窗口2&quot;</span>);</span><br><span class="line">        t1.start();</span><br><span class="line">        t2.start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">窗口<span class="number">1</span> 售出第<span class="number">10</span>张门票</span><br><span class="line">窗口<span class="number">1</span> 售出第<span class="number">9</span>张门票</span><br><span class="line">窗口<span class="number">1</span> 售出第<span class="number">8</span>张门票</span><br><span class="line">窗口<span class="number">1</span> 售出第<span class="number">7</span>张门票</span><br><span class="line">窗口<span class="number">1</span> 售出第<span class="number">6</span>张门票</span><br><span class="line">窗口<span class="number">1</span> 售出第<span class="number">5</span>张门票</span><br><span class="line">窗口<span class="number">1</span> 售出第<span class="number">4</span>张门票</span><br><span class="line">窗口<span class="number">1</span> 售出第<span class="number">3</span>张门票</span><br><span class="line">窗口<span class="number">1</span> 售出第<span class="number">2</span>张门票</span><br><span class="line">窗口<span class="number">1</span> 售出第<span class="number">1</span>张门票</span><br></pre></td></tr></table></figure>
<h3 id="死锁"><a class="markdownIt-Anchor" href="#死锁"></a> 死锁</h3>
<p>​		每当你有两个线程与两个带锁的对象时，你都可能遇到死锁，就是其中每个对象都在等待另一个对象上的锁。若对象x有一个同步方法调用了对象y上的一个同步方法，而对象y反过来有一个同步方法又调用了对象x上的一个同步方法，两个对象都在等待对方结束以获得锁，因而两者都无法进行。这种情况就是死锁，也可以叫做“死亡拥抱”(deadly embrace)。</p>
<p>代码实例：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Friendly</span> <span class="keyword">implements</span> <span class="title">Runnable</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Friendly partner;		<span class="comment">//创建一个空的对象引用</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Friendly</span><span class="params">(String name)</span>	<span class="comment">//构造方法</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name=name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">becomeFriend</span><span class="params">(Friendly partner)</span>		<span class="comment">//与partner引用的对象绑定朋友关系</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.partner=partner;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">hug</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        System.out.println(name+<span class="string">&quot;中的线程&quot;</span>+Thread.currentThread().getName()+<span class="string">&quot;试图调用&quot;</span>+partner.name+<span class="string">&quot;的同步方法hugBack()&quot;</span>);</span><br><span class="line">        partner.hugBack();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">hugBack</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        System.out.println(name+<span class="string">&quot;中的线程&quot;</span>+Thread.currentThread().getName()+<span class="string">&quot;成功调用hugBack()方法&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        hug();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">final</span> Friendly jonh=<span class="keyword">new</span> Friendly(<span class="string">&quot;john&quot;</span>);</span><br><span class="line">        <span class="keyword">final</span> Friendly ashley=<span class="keyword">new</span> Friendly(<span class="string">&quot;ashley&quot;</span>);</span><br><span class="line">        jonh.becomeFriend(ashley);</span><br><span class="line">        ashley.becomeFriend(jonh);</span><br><span class="line">        Thread t1=<span class="keyword">new</span> Thread(jonh,<span class="string">&quot;线程1&quot;</span>);</span><br><span class="line">        Thread t2=<span class="keyword">new</span> Thread(ashley,<span class="string">&quot;线程2&quot;</span>);</span><br><span class="line">        t1.start();</span><br><span class="line">        t2.start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">john中的线程线程1试图调用ashley的同步方法hugBack()</span><br><span class="line">ashley中的线程线程2试图调用john的同步方法hugBack()</span><br></pre></td></tr></table></figure>
<p>​		以上程序，当jonh.hug调用同步方法ashley.hugback时，线程1进入阻塞，等待ashley上的锁(当前由线程2拥有)释放。同时，ashley.hug调用同步方法jonh.hugback时，线程1进入阻塞，等待jonh上的锁(当前由线程1拥有)释放。至此出现了死锁——在ashley上的锁释放之前jonh无法继续运行，反之亦然。这样两个线程陷入永久的死锁状态。</p>
<p>​		当然，如果够幸运的话，一个线程可能在另一个线程还没有启动的情况下已经完成整个hug。比如线程1在线程2获取ashley上的锁之前提前获得ashley上的锁完成hug与hugBack。但是同一应用程序的另一次运行可能会仅仅由于线程调度器的不同选择而造成死锁，有几种好的设计形式可以解决这个问题。最简单的就是不用synchronized关键字去修饰hug与hugBack方法，但使这两个方法在被所有Friendly对象共享的单个对象上同步。这种设计意味着在一个运行期的所有线程中，每次只能有一个“拥抱”发生，这样排除了死锁的可能性。</p>
<p>​		死锁的问题调试起来很麻烦，并且不能通过编译去检测出死锁，因此在设计阶段就尽量避免出现死锁的可能性。</p>
<p>参考链接：</p>
<p><a target="_blank" rel="noopener" href="https://www.docs4dev.com/docs/zh/java/java8/tutorials/essential-concurrency-locksync.html">Java8 中文教程 - 内在锁和同步 | Docs4dev</a></p>
<p><a target="_blank" rel="noopener" href="https://www.jb51.net/article/83871.htm">详解Java多线程编程中的线程同步方法_java_脚本之家 (jb51.net)</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/gaohanghang/p/12108789.html">如果一个对象有多个方法加了 synchronized，那么该对象有几把锁？ - 高行行 - 博客园 (cnblogs.com)</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq877728715/article/details/108880980?app_version=4.7.0&amp;code=app_1562916241&amp;uLinkId=usr1mkqgl919blen">【Java多线程】了解线程的锁池和等待池概念_墩墩分墩-CSDN博客</a></p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/88541755">Monitor机制介绍 - 知乎 (zhihu.com)</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/Eiji_g/article/details/92812728?depth_1-">synchronized同步方法\块只有一个线程执行\运行_Eiji_g的博客-CSDN博客</a></p>
<p><a target="_blank" rel="noopener" href="https://zhidao.baidu.com/question/386570957.html?sort=11&amp;rn=5&amp;pn=0#wgt-answers">java中 synchronized同步处理后 为什么只有一个线程在运行呢？_百度知道 (baidu.com)</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/fengzheng/p/12066239.html">面试官：请说一下对象锁和类锁的区别 - 风的姿态 - 博客园 (cnblogs.com)</a></p>
<p><a target="_blank" rel="noopener" href="https://tieba.baidu.com/p/5919162079">关于在synchronized块中使用Thread.sleep()的问题【java吧】_百度贴吧 (baidu.com)</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/Mus-Li/p/7351120.html">java多线程学习之——多线程中几种释放锁和不释放锁的操作 - 沐易笙 - 博客园 (cnblogs.com)</a></p>
<p>参考书目：</p>
<p><a target="_blank" rel="noopener" href="https://item.jd.com/10031361832175.html">《国外经典计算机科学教材：Java编程语言(第3版)》【摘要 书评 试读】- 京东图书 (jd.com)</a></p>
<p><a target="_blank" rel="noopener" href="http://product.dangdang.com/23248198.html?ref=book-35530-3032_5-231497-4">《Java编程手记——从实践中学习Java（配光盘）》(欧二强　等编著)【简介_书评_在线阅读】 - 当当图书 (dangdang.com)</a></p>
<p><a target="_blank" rel="noopener" href="https://item.jd.com/36427083594.html">《Java基础入门 第2版 黑马程序员 经典Java入门教材书籍》【摘要 书评 试读】- 京东图书 (jd.com)</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://silenthly.github.io/2021/08/05/%E7%BA%BF%E7%A8%8B%E7%8A%B6%E6%80%81/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="buyan">
      <meta itemprop="description" content="我见过真正难过的人，但他一滴泪也没流">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Buyan-Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/08/05/%E7%BA%BF%E7%A8%8B%E7%8A%B6%E6%80%81/" class="post-title-link" itemprop="url">线程状态和线程操作方法</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-08-05 14:14:23" itemprop="dateCreated datePublished" datetime="2021-08-05T14:14:23+08:00">2021-08-05</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-08-13 12:56:13" itemprop="dateModified" datetime="2021-08-13T12:56:13+08:00">2021-08-13</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/java/" itemprop="url" rel="index"><span itemprop="name">java</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2021/08/05/%E7%BA%BF%E7%A8%8B%E7%8A%B6%E6%80%81/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2021/08/05/%E7%BA%BF%E7%A8%8B%E7%8A%B6%E6%80%81/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>​		线程的状态是一个动态的概念，每一个线程都有产生、存在和消亡的过程。一个线程在其整个生命周期内可处于不同的状态。每一个java程序都有一个默认的主线程，而多线程则是在主线程执行过程中，建立起来的多个线程在同一时间段内执行。</p>
<h3 id="线程状态的概念"><a class="markdownIt-Anchor" href="#线程状态的概念"></a> 线程状态的概念</h3>
<p>​		由于计算机的CPU处理速度非常快，所以当线程启动后，不能让其一直霸占着CPU独立运行。因此，CPU需要在多个线程之间切换。线程在其生命周期内有多种状态，包括<strong>新建状态(New)</strong> 、<strong>就绪状态(Runnable)</strong>、<strong>运行状态(Running)</strong>、<strong>阻塞状态(Blocked)</strong> 和<strong>死亡状态(Dead)</strong> 。线程的装换图如下图所示。</p>
<p><img src="https://silenthty.gitee.io/photo/java%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1/%E7%BA%BF%E7%A8%8B%E7%8A%B6%E6%80%81.jpg" alt="" /></p>
<p><strong>（1）新建状态</strong></p>
<p>​		使用Thread类的构造方法新建一个线程对象，此时新的线程对象便处于新建状态。它已经有了相应的内存空间和其他资源，但还是处于不可运行状态。线程的生命周期就是从新建状态开始的。</p>
<p><strong>（2）就绪状态</strong></p>
<p>​		新建线程对象后，调用该线程的start()方法时，线程就进入就绪状态。此时，java虚拟机就会为它创建方法调用栈和程序计数器。注意，此时线程并没有进入运行状态，只是处于这个状态的线程位于可运行池中，等待CPU的使用权，这表明了他已经具备了运行条件。</p>
<p><strong>（3）运行状态</strong></p>
<p>​		当就绪状态的线程被调用并获得JVM为其分配的CPU时，程序就进入运行状态，此时，该线程自动执行run()方法里定义的操作和功能。</p>
<p><strong>（4）阻塞状态</strong></p>
<p>​		阻塞状态是指线程因为某些原因放弃CPU，暂时停止运行，进入堵塞状态，如被人为挂起或要执行耗时的输入/输出操作。线程在运行状态下，如果调用sleep()、suspend()或wait()等方法，线程都将进入堵塞状态。当线程处于阻塞状态时，JVM不会为其分配CPU，必须等到该线程重新回到就绪状态后，JVM才有可能为其分配CPU，让它进入运行状态。阻塞的情况分三种：</p>
<p>a、 等待阻塞。通过调用线程的wait()方法，让线程等待某工作的完成。</p>
<p>b、 同步阻塞。线程在获取synchronized同步锁失败(因为锁被其它线程所占用)，它会进入同步阻塞状态。</p>
<p>c、 其他阻塞。通过调用线程的sleep()或join()或发出了I/O请求时，线程会进入到阻塞状态。当sleep()状态</p>
<p><strong>（5）死亡状态</strong></p>
<p>​		线程进入死亡状态的情况主要分两种，线程的run()方法执行完毕并退出或线程运行过程中产生异常。前者属于线程的正常死亡，而后者是线程的非正常死亡。处于死亡状态的线程不具有继续运行的能力，即使该线程对象是“活”的，但是其已经不是一个可执行的线程。程序员可以显示将其置为null，等待java垃圾回收器回收。</p>
<p>​		线程状态转换方法在下面介绍。</p>
<h3 id="线程操作的相关方法"><a class="markdownIt-Anchor" href="#线程操作的相关方法"></a> 线程操作的相关方法</h3>
<p>​		前面介绍过创建多线程程序有两种方法，虽然实现多线程一般都使用Runnable接口，但是操作线程的主要方法并不在Runnable接口内，而是在Thread类中。</p>
<p>​		无论是采用implements Runnable’还是使用extends Thread的方式，实际上都是以Thread类实现线程程序。下面介绍Thread类的常用方法。</p>
<table>
<thead>
<tr>
<th style="text-align:center">序号</th>
<th style="text-align:center">方法</th>
<th style="text-align:center">类型</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">public Thread()</td>
<td style="text-align:center">构造</td>
<td style="text-align:center">创建新的Thread对象</td>
</tr>
<tr>
<td style="text-align:center"><strong>2</strong></td>
<td style="text-align:center"><strong>public Thread(Runnable target)</strong></td>
<td style="text-align:center"><strong>构造</strong></td>
<td style="text-align:center"><strong>创建新的Thread对象，并使用taget指定Runnable对象的run()实现</strong></td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">public Thread(String name)</td>
<td style="text-align:center">构造</td>
<td style="text-align:center">创建新的Thread对象，并以name参数为此Thread对象设定名称</td>
</tr>
<tr>
<td style="text-align:center"><strong>4</strong></td>
<td style="text-align:center"><strong>public Thread(Runnable target,String name)</strong></td>
<td style="text-align:center"><strong>构造</strong></td>
<td style="text-align:center"><strong>创建新的Thread对象，使用target指定Runnable对象的run()实现，并以name参数为此Thread对象设定名称</strong></td>
</tr>
<tr>
<td style="text-align:center"><strong>5</strong></td>
<td style="text-align:center"><strong>public static int activeCount()</strong></td>
<td style="text-align:center"><strong>静态</strong></td>
<td style="text-align:center"><strong>返回当前线程的线程组中活动线程的数目</strong></td>
</tr>
<tr>
<td style="text-align:center">6</td>
<td style="text-align:center">public void checkAccess()</td>
<td style="text-align:center">普通</td>
<td style="text-align:center">判断当前运行的线程是否有权修改该线程</td>
</tr>
<tr>
<td style="text-align:center"><strong>7</strong></td>
<td style="text-align:center"><strong>public static Thread currentThread()</strong></td>
<td style="text-align:center"><strong>静态</strong></td>
<td style="text-align:center"><strong>返回对当前正在执行的线程对象的引用</strong></td>
</tr>
<tr>
<td style="text-align:center">8</td>
<td style="text-align:center">public static int enumerate(Thread[] tarray)</td>
<td style="text-align:center">静态</td>
<td style="text-align:center">将当前线程的线程组及其子组中的每一个活动线程复制到指定的数组tarray中</td>
</tr>
<tr>
<td style="text-align:center">9</td>
<td style="text-align:center">public long getId()</td>
<td style="text-align:center">普通</td>
<td style="text-align:center">返回当前线程的标识符</td>
</tr>
<tr>
<td style="text-align:center"><strong>10</strong></td>
<td style="text-align:center"><strong>public final String getName()</strong></td>
<td style="text-align:center"><strong>普通</strong></td>
<td style="text-align:center"><strong>返回当前线程的名称</strong></td>
</tr>
<tr>
<td style="text-align:center">11</td>
<td style="text-align:center">public final int getPriority()</td>
<td style="text-align:center">普通</td>
<td style="text-align:center">返回当前线程的优先级</td>
</tr>
<tr>
<td style="text-align:center">12</td>
<td style="text-align:center">public Thread.State getState()</td>
<td style="text-align:center">普通</td>
<td style="text-align:center">返回当前线程的状态</td>
</tr>
<tr>
<td style="text-align:center">13</td>
<td style="text-align:center">public final ThreadGroup getThreadGroup()</td>
<td style="text-align:center">普通</td>
<td style="text-align:center">返回当前线程所属的线程组</td>
</tr>
<tr>
<td style="text-align:center">14</td>
<td style="text-align:center">public static boolean holdsLock(Object obj)</td>
<td style="text-align:center">静态</td>
<td style="text-align:center">判断当前线程是否拥有obj参数指定的对象监视锁。若有，则返回true，否则返回false(该方法与线程同步相关)</td>
</tr>
<tr>
<td style="text-align:center"><strong>15</strong></td>
<td style="text-align:center"><strong>public void interrupt()</strong></td>
<td style="text-align:center"><strong>普通</strong></td>
<td style="text-align:center"><strong>中断当前线程</strong></td>
</tr>
<tr>
<td style="text-align:center">16</td>
<td style="text-align:center">public static boolean interrupted()</td>
<td style="text-align:center">静态</td>
<td style="text-align:center">判断执行中的线程是否已被中断，若是，则返回true，否则返回false</td>
</tr>
<tr>
<td style="text-align:center">17</td>
<td style="text-align:center">public final boolean isAlive()</td>
<td style="text-align:center">普通</td>
<td style="text-align:center">判断当前线程是否处于激活状态，若是，则返回true，否则返回false</td>
</tr>
<tr>
<td style="text-align:center"><strong>18</strong></td>
<td style="text-align:center"><strong>public final boolean isDaemon()</strong></td>
<td style="text-align:center"><strong>普通</strong></td>
<td style="text-align:center"><strong>判断当前线程是否为守护线程，若是，则返回true，否则返回false</strong></td>
</tr>
<tr>
<td style="text-align:center">19</td>
<td style="text-align:center">public final boolean isInterruptde()</td>
<td style="text-align:center">普通</td>
<td style="text-align:center">判断当前线程是否已被中断，若是，则返回true，否则返回false</td>
</tr>
<tr>
<td style="text-align:center"><strong>20</strong></td>
<td style="text-align:center"><strong>public final void join()throws InterruptedException</strong></td>
<td style="text-align:center"><strong>普通</strong></td>
<td style="text-align:center"><strong>当前线程暂停执行，等待调用该方法的线程终止，才能继续执行当前线程</strong></td>
</tr>
<tr>
<td style="text-align:center">21</td>
<td style="text-align:center">public final void join(long millis)throws InterruptedException</td>
<td style="text-align:center">普通</td>
<td style="text-align:center">与前者相似，但等待该线程终止的时间最长为millis毫秒</td>
</tr>
<tr>
<td style="text-align:center">22</td>
<td style="text-align:center">public void join(long millis,int nanos)throws InterruptedException</td>
<td style="text-align:center">普通</td>
<td style="text-align:center">与前者相似，等待该线程终止的时间最长为millis毫秒+nanos纳秒，时间精度更高</td>
</tr>
<tr>
<td style="text-align:center"><strong>23</strong></td>
<td style="text-align:center"><strong>public void run()</strong></td>
<td style="text-align:center"><strong>普通</strong></td>
<td style="text-align:center"><strong>如果该线程构造使用独立的Runnable运行对象，则调用该Runnable对象的run()方法，否则，该方法不执行任何操作</strong></td>
</tr>
<tr>
<td style="text-align:center"><strong>24</strong></td>
<td style="text-align:center"><strong>public final void setDaemon(boolean on)</strong></td>
<td style="text-align:center"><strong>普通</strong></td>
<td style="text-align:center"><strong>将当前线程标记为守护线程或用户线程</strong></td>
</tr>
<tr>
<td style="text-align:center"><strong>25</strong></td>
<td style="text-align:center"><strong>public final void setName(String name)</strong></td>
<td style="text-align:center"><strong>普通</strong></td>
<td style="text-align:center"><strong>设置线程名称</strong></td>
</tr>
<tr>
<td style="text-align:center"><strong>26</strong></td>
<td style="text-align:center"><strong>public final void setPriority(int newPriority)</strong></td>
<td style="text-align:center"><strong>普通</strong></td>
<td style="text-align:center"><strong>更改线程的优先级</strong></td>
</tr>
<tr>
<td style="text-align:center"><strong>27</strong></td>
<td style="text-align:center"><strong>public static void sleep(long millis)throws InterruptedException</strong></td>
<td style="text-align:center"><strong>静态</strong></td>
<td style="text-align:center"><strong>在指定的毫秒数内让当前正在执行的线程休眠(暂停执行)</strong></td>
</tr>
<tr>
<td style="text-align:center">28</td>
<td style="text-align:center">public static void sleep(long millis,int nanos)throws InterruptedException</td>
<td style="text-align:center">静态</td>
<td style="text-align:center">在指定的毫秒数加指定的纳秒数内让当前正在执行的线程休眠(暂停执行)</td>
</tr>
<tr>
<td style="text-align:center"><strong>29</strong></td>
<td style="text-align:center"><strong>public void start()</strong></td>
<td style="text-align:center"><strong>普通</strong></td>
<td style="text-align:center"><strong>是该线程开始执行，JVM调用该线程的run方法。但此线程已启动且仍然存活，若再使用该方法将引发异常</strong></td>
</tr>
<tr>
<td style="text-align:center">30</td>
<td style="text-align:center">public String toString()</td>
<td style="text-align:center">普通</td>
<td style="text-align:center">返回该线程的字符串表示形式，包括线程名称、优先级和线程组</td>
</tr>
<tr>
<td style="text-align:center"><strong>31</strong></td>
<td style="text-align:center"><strong>public static void yield()</strong></td>
<td style="text-align:center"><strong>静态</strong></td>
<td style="text-align:center"><strong>暂停当前正在执行的线程对象，并让其他线程有机会执行</strong></td>
</tr>
</tbody>
</table>
<h4 id="获取并设置线程名称"><a class="markdownIt-Anchor" href="#获取并设置线程名称"></a> 获取并设置线程名称</h4>
<p>​		Thread类的getName()和setName()方法在前面已经多次使用了。如果在创建线程时，没有显式地为其设置名称，系统就会自动地为其分配一个名称，一般格式为：Thread-n(n表示从0开始的整数)</p>
<p>代码示例：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ThreadDemo</span> <span class="keyword">implements</span> <span class="title">Runnable</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=<span class="number">5</span>;i++)</span><br><span class="line">        &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;当前运行线程：&quot;</span>+Thread.currentThread().getName()+<span class="string">&quot;,i=&quot;</span>+i+<span class="string">&quot;，活动线程的数目：&quot;</span>+Thread.activeCount());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        ThreadDemo tm=<span class="keyword">new</span> ThreadDemo();</span><br><span class="line">        Thread t1=<span class="keyword">new</span> Thread(tm);</span><br><span class="line">        Thread t2=<span class="keyword">new</span> Thread(tm,<span class="string">&quot;线程-1&quot;</span>);</span><br><span class="line">        Thread t3=<span class="keyword">new</span> Thread(tm);</span><br><span class="line">        t3.setName(<span class="string">&quot;线程-2&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;当前活动线程的数目：&quot;</span>+Thread.activeCount());</span><br><span class="line">        t1.start();</span><br><span class="line">        t2.start();</span><br><span class="line">        t3.start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">当前活动线程的数目：<span class="number">1</span></span><br><span class="line">当前运行线程：Thread-<span class="number">0</span>,i=<span class="number">1</span>，活动线程的数目：<span class="number">4</span></span><br><span class="line">当前运行线程：Thread-<span class="number">0</span>,i=<span class="number">2</span>，活动线程的数目：<span class="number">4</span></span><br><span class="line">当前运行线程：线程-<span class="number">2</span>,i=<span class="number">1</span>，活动线程的数目：<span class="number">4</span></span><br><span class="line">当前运行线程：线程-<span class="number">2</span>,i=<span class="number">2</span>，活动线程的数目：<span class="number">4</span></span><br><span class="line">当前运行线程：线程-<span class="number">2</span>,i=<span class="number">3</span>，活动线程的数目：<span class="number">4</span></span><br><span class="line">当前运行线程：线程-<span class="number">2</span>,i=<span class="number">4</span>，活动线程的数目：<span class="number">4</span></span><br><span class="line">当前运行线程：线程-<span class="number">2</span>,i=<span class="number">5</span>，活动线程的数目：<span class="number">4</span></span><br><span class="line">当前运行线程：线程-<span class="number">1</span>,i=<span class="number">1</span>，活动线程的数目：<span class="number">4</span></span><br><span class="line">当前运行线程：Thread-<span class="number">0</span>,i=<span class="number">3</span>，活动线程的数目：<span class="number">4</span></span><br><span class="line">当前运行线程：线程-<span class="number">1</span>,i=<span class="number">2</span>，活动线程的数目：<span class="number">3</span></span><br><span class="line">当前运行线程：Thread-<span class="number">0</span>,i=<span class="number">4</span>，活动线程的数目：<span class="number">3</span></span><br><span class="line">当前运行线程：Thread-<span class="number">0</span>,i=<span class="number">5</span>，活动线程的数目：<span class="number">3</span></span><br><span class="line">当前运行线程：线程-<span class="number">1</span>,i=<span class="number">3</span>，活动线程的数目：<span class="number">3</span></span><br><span class="line">当前运行线程：线程-<span class="number">1</span>,i=<span class="number">4</span>，活动线程的数目：<span class="number">2</span></span><br><span class="line">当前运行线程：线程-<span class="number">1</span>,i=<span class="number">5</span>，活动线程的数目：<span class="number">2</span></span><br></pre></td></tr></table></figure>
<p>​		从程序运行结果可以看出，在多线程没启动前，线程组中只有一个线程在运行，这个线程就是主线程main()。</p>
<h4 id="线程的优先级"><a class="markdownIt-Anchor" href="#线程的优先级"></a> 线程的优先级</h4>
<p>​		在java中每个线程都有其优先级，优先级的取值范围为1~10，默认为5。可以使用Thread类中的setPriority()方法设置一个线程的优先级，但必须在1~10范围内，否则会产生异常。在java的线程中一个有3种优先级。如下表所示。</p>
<table>
<thead>
<tr>
<th style="text-align:center">序号</th>
<th style="text-align:center">定义</th>
<th style="text-align:center">说明</th>
<th style="text-align:center">表示常量</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">public static final int MIN_PRIORITY</td>
<td style="text-align:center">线程可以具有的最低优先级</td>
<td style="text-align:center">1</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">public static final int NORM_PRIORITY</td>
<td style="text-align:center">分配给线程的默认优先级</td>
<td style="text-align:center">5</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">public static final int MAX_PRIORITY</td>
<td style="text-align:center">线程可以具有的最高优先级</td>
<td style="text-align:center">10</td>
</tr>
</tbody>
</table>
<p>代码示例：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ThreadDemo</span> <span class="keyword">implements</span> <span class="title">Runnable</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=<span class="number">5</span>;i++)</span><br><span class="line">        &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;当前运行线程：&quot;</span>+Thread.currentThread().getName()+<span class="string">&quot;,i=&quot;</span>+i);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        ThreadDemo tm=<span class="keyword">new</span> ThreadDemo();</span><br><span class="line">        Thread t1=<span class="keyword">new</span> Thread(tm,<span class="string">&quot;线程-1&quot;</span>);</span><br><span class="line">        Thread t2=<span class="keyword">new</span> Thread(tm,<span class="string">&quot;线程-2&quot;</span>);</span><br><span class="line">        Thread t3=<span class="keyword">new</span> Thread(tm,<span class="string">&quot;线程-3&quot;</span>);</span><br><span class="line">        Thread t4=<span class="keyword">new</span> Thread(tm,<span class="string">&quot;线程-4&quot;</span>);</span><br><span class="line">        t1.setPriority(Thread.MIN_PRIORITY);</span><br><span class="line">        t2.setPriority(<span class="number">2</span>);</span><br><span class="line">        t3.setPriority(Thread.NORM_PRIORITY);</span><br><span class="line">        t4.setPriority(Thread.MAX_PRIORITY);</span><br><span class="line">        t1.start();</span><br><span class="line">        t2.start();</span><br><span class="line">        t3.start();</span><br><span class="line">        t4.start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">当前运行线程：线程-<span class="number">4</span>,i=<span class="number">1</span></span><br><span class="line">当前运行线程：线程-<span class="number">3</span>,i=<span class="number">1</span></span><br><span class="line">当前运行线程：线程-<span class="number">1</span>,i=<span class="number">1</span></span><br><span class="line">当前运行线程：线程-<span class="number">2</span>,i=<span class="number">1</span></span><br><span class="line">当前运行线程：线程-<span class="number">2</span>,i=<span class="number">2</span></span><br><span class="line">当前运行线程：线程-<span class="number">2</span>,i=<span class="number">3</span></span><br><span class="line">当前运行线程：线程-<span class="number">2</span>,i=<span class="number">4</span></span><br><span class="line">当前运行线程：线程-<span class="number">2</span>,i=<span class="number">5</span></span><br><span class="line">当前运行线程：线程-<span class="number">1</span>,i=<span class="number">2</span></span><br><span class="line">当前运行线程：线程-<span class="number">1</span>,i=<span class="number">3</span></span><br><span class="line">当前运行线程：线程-<span class="number">3</span>,i=<span class="number">2</span></span><br><span class="line">当前运行线程：线程-<span class="number">4</span>,i=<span class="number">2</span></span><br><span class="line">当前运行线程：线程-<span class="number">3</span>,i=<span class="number">3</span></span><br><span class="line">当前运行线程：线程-<span class="number">3</span>,i=<span class="number">4</span></span><br><span class="line">当前运行线程：线程-<span class="number">3</span>,i=<span class="number">5</span></span><br><span class="line">当前运行线程：线程-<span class="number">1</span>,i=<span class="number">4</span></span><br><span class="line">当前运行线程：线程-<span class="number">4</span>,i=<span class="number">3</span></span><br><span class="line">当前运行线程：线程-<span class="number">1</span>,i=<span class="number">5</span></span><br><span class="line">当前运行线程：线程-<span class="number">4</span>,i=<span class="number">4</span></span><br><span class="line">当前运行线程：线程-<span class="number">4</span>,i=<span class="number">5</span></span><br></pre></td></tr></table></figure>
<p>​		从运行结果可以发现，线程的优先级决定了线程获得CPU的优先权，也就是运行的优先权。需要注意的是，优先级高的线程只是优先获得CPU，不是绝对获得CPU。主线程的优先级为5。</p>
<h4 id="让线程休眠"><a class="markdownIt-Anchor" href="#让线程休眠"></a> 让线程休眠</h4>
<p>​		线程休眠是指线程暂时处于阻塞状态，就是说线程停止运行。当一个程序在执行sleep()方法后，它就会放弃CPU，转到阻塞状态。sleep()方法是Thread类中的静态方法，有两种重载形式。</p>
<p>代码示例：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ThreadDemo</span> <span class="keyword">implements</span> <span class="title">Runnable</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=<span class="number">5</span>;i++)</span><br><span class="line">        &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;当前运行线程：&quot;</span>+Thread.currentThread().getName()+<span class="string">&quot;,i=&quot;</span>+i+<span class="string">&quot;时间：&quot;</span>+(<span class="keyword">new</span> Date()));</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            Thread.sleep(<span class="number">1000</span>);		<span class="comment">//线程休眠1s</span></span><br><span class="line">        &#125;<span class="keyword">catch</span>(InterruptedException e)</span><br><span class="line">        	&#123;</span><br><span class="line">            	e.printStackTrace();</span><br><span class="line">        	&#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        ThreadDemo tm=<span class="keyword">new</span> ThreadDemo();</span><br><span class="line">        Thread t1=<span class="keyword">new</span> Thread(tm,<span class="string">&quot;线程-1&quot;</span>);</span><br><span class="line">        Thread t2=<span class="keyword">new</span> Thread(tm,<span class="string">&quot;线程-2&quot;</span>);</span><br><span class="line">        Thread t3=<span class="keyword">new</span> Thread(tm,<span class="string">&quot;线程-3&quot;</span>);</span><br><span class="line">        t1.start();</span><br><span class="line">        t2.start();</span><br><span class="line">        t3.start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">当前运行线程：线程-<span class="number">1</span>,i=<span class="number">1</span>时间：Thu Aug <span class="number">05</span> 08:08:<span class="number">31</span> CST <span class="number">2021</span></span><br><span class="line">当前运行线程：线程-<span class="number">3</span>,i=<span class="number">1</span>时间：Thu Aug <span class="number">05</span> 08:08:<span class="number">31</span> CST <span class="number">2021</span></span><br><span class="line">当前运行线程：线程-<span class="number">2</span>,i=<span class="number">1</span>时间：Thu Aug <span class="number">05</span> 08:08:<span class="number">31</span> CST <span class="number">2021</span></span><br><span class="line">当前运行线程：线程-<span class="number">1</span>,i=<span class="number">2</span>时间：Thu Aug <span class="number">05</span> 08:08:<span class="number">32</span> CST <span class="number">2021</span></span><br><span class="line">当前运行线程：线程-<span class="number">3</span>,i=<span class="number">2</span>时间：Thu Aug <span class="number">05</span> 08:08:<span class="number">32</span> CST <span class="number">2021</span></span><br><span class="line">当前运行线程：线程-<span class="number">2</span>,i=<span class="number">2</span>时间：Thu Aug <span class="number">05</span> 08:08:<span class="number">32</span> CST <span class="number">2021</span></span><br><span class="line">当前运行线程：线程-<span class="number">1</span>,i=<span class="number">3</span>时间：Thu Aug <span class="number">05</span> 08:08:<span class="number">33</span> CST <span class="number">2021</span></span><br><span class="line">当前运行线程：线程-<span class="number">3</span>,i=<span class="number">3</span>时间：Thu Aug <span class="number">05</span> 08:08:<span class="number">33</span> CST <span class="number">2021</span></span><br><span class="line">当前运行线程：线程-<span class="number">2</span>,i=<span class="number">3</span>时间：Thu Aug <span class="number">05</span> 08:08:<span class="number">33</span> CST <span class="number">2021</span></span><br><span class="line">当前运行线程：线程-<span class="number">1</span>,i=<span class="number">4</span>时间：Thu Aug <span class="number">05</span> 08:08:<span class="number">34</span> CST <span class="number">2021</span></span><br><span class="line">当前运行线程：线程-<span class="number">3</span>,i=<span class="number">4</span>时间：Thu Aug <span class="number">05</span> 08:08:<span class="number">34</span> CST <span class="number">2021</span></span><br><span class="line">当前运行线程：线程-<span class="number">2</span>,i=<span class="number">4</span>时间：Thu Aug <span class="number">05</span> 08:08:<span class="number">34</span> CST <span class="number">2021</span></span><br><span class="line">当前运行线程：线程-<span class="number">1</span>,i=<span class="number">5</span>时间：Thu Aug <span class="number">05</span> 08:08:<span class="number">35</span> CST <span class="number">2021</span></span><br><span class="line">当前运行线程：线程-<span class="number">2</span>,i=<span class="number">5</span>时间：Thu Aug <span class="number">05</span> 08:08:<span class="number">35</span> CST <span class="number">2021</span></span><br><span class="line">当前运行线程：线程-<span class="number">3</span>,i=<span class="number">5</span>时间：Thu Aug <span class="number">05</span> 08:08:<span class="number">35</span> CST <span class="number">2021</span></span><br></pre></td></tr></table></figure>
<p>​		以上程序在运行时，每一次输出的间隔都在1000ms，说明线程休眠了1000ms。</p>
<h5 id="使用sleep注意事项"><a class="markdownIt-Anchor" href="#使用sleep注意事项"></a> 使用sleep()注意事项</h5>
<p>1、当线程休眠结束后，该线程并不会立即进入运行状态，而是进入就绪状态，等待JVM为其分配CPU。</p>
<p>2、当线程处于休眠状态时，如果该线程被中断，则会抛出InterruptedException异常。中断线程可以使用interrupt()方法。</p>
<p>3、sleep()是静态方法。在主方法内，无论是通过线程对象t去调用sleep()还是直接通过Thread.sleep()形式去调用sleep()方法，都是休眠主线程。若想要线程实例休眠，sleep()方法应该放在run()内。</p>
<h4 id="线程的唤醒"><a class="markdownIt-Anchor" href="#线程的唤醒"></a> 线程的唤醒</h4>
<p>​		线程的唤醒是指使线程从休眠的阻塞状态转换为运行状态，可以通过Thread类的interrupt()方法实现。</p>
<p>代码示例：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ThreadDemo</span> <span class="keyword">implements</span> <span class="title">Runnable</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;开始运行run()方法的时刻：&quot;</span>+(<span class="keyword">new</span> Date()));</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            Thread.sleep(<span class="number">5000</span>);			<span class="comment">//线程休眠</span></span><br><span class="line">        &#125;<span class="keyword">catch</span>(Exception e)</span><br><span class="line">        	&#123;</span><br><span class="line">            	System.out.println(<span class="string">&quot;线程已被唤醒&quot;</span>);</span><br><span class="line">        	&#125;</span><br><span class="line">        System.out.println(<span class="string">&quot;结束运行run()方法的时刻：&quot;</span>+(<span class="keyword">new</span> Date()));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        ThreadDemo tm=<span class="keyword">new</span> ThreadDemo();</span><br><span class="line">        Thread t1=<span class="keyword">new</span> Thread(tm,<span class="string">&quot;线程-1&quot;</span>);</span><br><span class="line">        t1.start();</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            t1.sleep(<span class="number">2000</span>);</span><br><span class="line">        &#125;<span class="keyword">catch</span>(Exception e)</span><br><span class="line">        	&#123;</span><br><span class="line">            	e.printStackTrace();</span><br><span class="line">        	&#125;</span><br><span class="line">        t1.interrupt();		<span class="comment">//唤醒线程</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">开始运行run()方法的时刻：Thu Aug 05 09:13:18 CST 2021</span><br><span class="line">线程已被唤醒</span><br><span class="line">结束运行run()方法的时刻：Thu Aug 05 09:13:20 CST 2021</span><br></pre></td></tr></table></figure>
<p>​		从程序的运行结果可以发现，t1线程启动后立即进入休眠，原本需要5000ms，但是主线程启动后两秒就将其中断。前面说过，将休眠的线程唤醒会抛出异常，所以会执行run()方法中catch语句块的内容。</p>
<h5 id="判断线程是否中断的两个方法"><a class="markdownIt-Anchor" href="#判断线程是否中断的两个方法"></a> 判断线程是否中断的两个方法</h5>
<p>1、isInterrupted()：这是一个实例方法，用于判断当前线程是否已被中断。若是，则返回true，否则返回false。线程中的中断状态不受该方法影响。</p>
<p>2、interrupted()：这是一个静态方法，用于判断执行中的线程是否已被中断。若是，则返回true，否则返回false。调用此方法后，线程的中断状态将被消除，即处于中断状态的线程将变为非中断状态。</p>
<h4 id="后台线程"><a class="markdownIt-Anchor" href="#后台线程"></a> 后台线程</h4>
<p>​		后台线程是指在后台执行的服务线程，后台线程也可以称为守护线程。JVM的垃圾回收线程就是经典的后台线程。后台线程的任务就是为其他线程提供服务，仅当所有的非后台线程都结束时，后台线程才会结束。可以使用Thread类的setDaemon()方法将一个线程设置为后台线程。</p>
<p>​		若要将一个线程设置为后台线程，则必须在该线程启动之前调用setDaemon()方法。设置后台线程后，还可以通过isDaemon()方法判断该线程是否已成为后台线程。</p>
<p>代码示例：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ThreadDemo</span> <span class="keyword">implements</span> <span class="title">Runnable</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> i=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(<span class="keyword">true</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;i=&quot;</span>+i++);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        ThreadDemo tm=<span class="keyword">new</span> ThreadDemo();</span><br><span class="line">        Thread t1=<span class="keyword">new</span> Thread(tm,<span class="string">&quot;线程-1&quot;</span>);</span><br><span class="line">        t1.setDaemon(<span class="keyword">true</span>);</span><br><span class="line">        <span class="keyword">if</span>(t1.isDaemon())</span><br><span class="line">        &#123;</span><br><span class="line">            t1.start();</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">&quot;当前线程存活数：&quot;</span>+Thread.activeCount());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>​		以上程序中，若t1不为后台线程，run()方法就是死循环。但将t1设置为后台程序，在非后台线程结束后，后台线程t1也将结束。</p>
<h4 id="线程礼让"><a class="markdownIt-Anchor" href="#线程礼让"></a> 线程礼让</h4>
<p>​		线程礼让是指当前正在运行的线程退出运行状态，暂时让其他线程先执行，可以通过Thread()类的yield()方法来实现，该方法只能把运行权让出来，不能让给指定的线程。</p>
<p>​		yield()的作用是让步，它能够让当前线程从“运行状态”进入到“就绪状态”，从而让其他等待线程获取执行权，但是不能保证在当前线程调用yield()之后，其他线程就一定能获得执行权，也有可能是当前线程又回到“运行状态”继续运行。<span style="color:red;background:背景颜色;font-size:文字大小;font-family:字体;">注意：这里将上面的“具有相同优先级”的线程直接改为了线程，很多资料都写的是让具有相同优先级的线程开始竞争，但其实不是这样的，优先级低的线程在拿到CPU执行权后也是可以执行，只不过优先级高的线程拿到CPU执行权的概率比较大而已，并不是一定能拿到。</span></p>
<p>代码示例：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ThreadDemo</span> <span class="keyword">implements</span> <span class="title">Runnable</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=<span class="number">10</span>;i++)</span><br><span class="line">        &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;当前运行线程：&quot;</span>+Thread.currentThread().getName()+<span class="string">&quot;,i=&quot;</span>+i);</span><br><span class="line">            Thread.currentThread().yield();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ThreadDemo1</span> <span class="keyword">implements</span> <span class="title">Runnable</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=<span class="number">10</span>;i++)</span><br><span class="line">        &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;当前运行线程：&quot;</span>+Thread.currentThread().getName()+<span class="string">&quot;,i=&quot;</span>+i);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        ThreadDemo tm1=<span class="keyword">new</span> ThreadDemo();</span><br><span class="line">        ThreadDemo1 tm2=<span class="keyword">new</span> ThreadDemo1();</span><br><span class="line">        Thread t1=<span class="keyword">new</span> Thread(tm1,<span class="string">&quot;线程-1&quot;</span>);</span><br><span class="line">        Thread t2=<span class="keyword">new</span> Thread(tm2,<span class="string">&quot;线程-2&quot;</span>);</span><br><span class="line">        t1.start();</span><br><span class="line">        t2.start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">当前运行线程：线程-<span class="number">1</span>,i=<span class="number">1</span></span><br><span class="line">当前运行线程：线程-<span class="number">2</span>,i=<span class="number">1</span></span><br><span class="line">当前运行线程：线程-<span class="number">1</span>,i=<span class="number">2</span></span><br><span class="line">当前运行线程：线程-<span class="number">2</span>,i=<span class="number">2</span></span><br><span class="line">当前运行线程：线程-<span class="number">2</span>,i=<span class="number">3</span></span><br><span class="line">当前运行线程：线程-<span class="number">2</span>,i=<span class="number">4</span></span><br><span class="line">当前运行线程：线程-<span class="number">2</span>,i=<span class="number">5</span></span><br><span class="line">当前运行线程：线程-<span class="number">2</span>,i=<span class="number">6</span></span><br><span class="line">当前运行线程：线程-<span class="number">2</span>,i=<span class="number">7</span></span><br><span class="line">当前运行线程：线程-<span class="number">2</span>,i=<span class="number">8</span></span><br><span class="line">当前运行线程：线程-<span class="number">2</span>,i=<span class="number">9</span></span><br><span class="line">当前运行线程：线程-<span class="number">1</span>,i=<span class="number">3</span></span><br><span class="line">当前运行线程：线程-<span class="number">1</span>,i=<span class="number">4</span></span><br><span class="line">当前运行线程：线程-<span class="number">1</span>,i=<span class="number">5</span></span><br><span class="line">当前运行线程：线程-<span class="number">2</span>,i=<span class="number">10</span></span><br><span class="line">当前运行线程：线程-<span class="number">1</span>,i=<span class="number">6</span></span><br><span class="line">当前运行线程：线程-<span class="number">1</span>,i=<span class="number">7</span></span><br><span class="line">当前运行线程：线程-<span class="number">1</span>,i=<span class="number">8</span></span><br><span class="line">当前运行线程：线程-<span class="number">1</span>,i=<span class="number">9</span></span><br><span class="line">当前运行线程：线程-<span class="number">1</span>,i=<span class="number">10</span></span><br></pre></td></tr></table></figure>
<p>​		从程序运行结果可以发现，t1线程比t2线程运行的几率要小，因为t1总是让其他线程先执行。</p>
<h5 id="sleep和yield的区别"><a class="markdownIt-Anchor" href="#sleep和yield的区别"></a> sleep()和yield()的区别</h5>
<p>sleep()和yield()都可以让出运行权，但它们还是有很大的不同</p>
<p>1、sleep()方法让出运行权时，在暂停运行直到结束之前不参与竞争，不考虑其他线程的优先级。而yield()方法只是将运行权让出，但仍与其他不同优先级的线程进行竞争。</p>
<p>2、调用sleep()方法会让当前线程转到阻塞状态。而调用yield()方法则将当前线程转到就绪状态。</p>
<p>3、sleep()方法声明抛出InterruptedException异常，而yield()方法不抛出异常。</p>
<p>4、sleep()方法比yield()方法具有更好的移植性，不能依靠yield()方法来提高程序的并发性。</p>
<h4 id="线程插队"><a class="markdownIt-Anchor" href="#线程插队"></a> 线程插队</h4>
<p>​		现实生活中经常能碰到“插队”的情况，同样，在Thread类中也提供了一个join()方法来实现这个功能。当在某个线程中调用其他线程的join()方法时，调用的线程将会被阻塞。直到被join()方法加入的线程执行完成后他才会继续运行。比如在线程B中调用了线程A的Join()方法，直到线程A执行完毕后，才会继续执行线程B。</p>
<p>代码示例：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ThreadDemo</span> <span class="keyword">implements</span> <span class="title">Runnable</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=<span class="number">5</span>;i++)</span><br><span class="line">        &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;当前运行线程：&quot;</span>+Thread.currentThread().getName()+<span class="string">&quot;,i=&quot;</span>+i);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        ThreadDemo tm=<span class="keyword">new</span> ThreadDemo();</span><br><span class="line">        Thread t1=<span class="keyword">new</span> Thread(tm,<span class="string">&quot;线程-1&quot;</span>);</span><br><span class="line">        t1.start();</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=<span class="number">5</span>;i++)</span><br><span class="line">        	&#123;</span><br><span class="line">            	System.out.println(<span class="string">&quot;当前运行线程：&quot;</span>+Thread.currentThread().getName()+<span class="string">&quot;,i=&quot;</span>+i);</span><br><span class="line">            	<span class="keyword">if</span>(i==<span class="number">2</span>)</span><br><span class="line">            	&#123;</span><br><span class="line">                	t1.join();</span><br><span class="line">            	&#125;</span><br><span class="line">        	&#125;</span><br><span class="line">        &#125;<span class="keyword">catch</span>(InterruptedException e)</span><br><span class="line">        	&#123;</span><br><span class="line">            	e.printStackTrace();</span><br><span class="line">        	&#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">当前运行线程：main,i=<span class="number">1</span></span><br><span class="line">当前运行线程：线程-<span class="number">1</span>,i=<span class="number">1</span></span><br><span class="line">当前运行线程：main,i=<span class="number">2</span></span><br><span class="line">当前运行线程：线程-<span class="number">1</span>,i=<span class="number">2</span></span><br><span class="line">当前运行线程：线程-<span class="number">1</span>,i=<span class="number">3</span></span><br><span class="line">当前运行线程：线程-<span class="number">1</span>,i=<span class="number">4</span></span><br><span class="line">当前运行线程：线程-<span class="number">1</span>,i=<span class="number">5</span></span><br><span class="line">当前运行线程：main,i=<span class="number">3</span></span><br><span class="line">当前运行线程：main,i=<span class="number">4</span></span><br><span class="line">当前运行线程：main,i=<span class="number">5</span></span><br></pre></td></tr></table></figure>
<p>​		从程序结果可以看出，在mian线程中的循环变量为2前，main线程与t1线程会互相争夺cpu使用权。而当mian线程中的循环变量为2时，调用t1线程的join()方法，这时，t1线程就会“插队”优先执行，并且整个线程执行完毕后才会执行其他线程。</p>
<p>​		Thread类中除了提供一个无参数的线程插队join()方法外，还提供了两个带有时间参数的线程插队方法，可前往前面表格查看或者前往API帮助文档查看。join()方法是通过wait()实现的，[点击此处进行了解](<a target="_blank" rel="noopener" href="https://www.cnblogs.com/aademeng/articles/10882539.html">Java中join()方法的理解 - 天涯海角路 - 博客园 (cnblogs.com)</a>)</p>
<p>参考链接：</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_41701956/article/details/84861232">Java线程状态以及 sheep（）、wait()、yield() 的区别_Java笔记-CSDN博客</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/happy-coder/p/6587092.html">JAVA 线程状态及转化 - Happy-Coder - 博客园 (cnblogs.com)</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_33098039/article/details/78179501">Java守护线程和main线程整理_贝西晨的博客-CSDN博客</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/Gabriel576282253/article/details/99437709?depth_1-">启动一个最简单的Java main程序时，有多少个线程被创建_Gabriel576282253的专栏-CSDN博客</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/baizhanshi/p/8289202.html">守护线程与普通线程 - jason.bai - 博客园 (cnblogs.com)</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/aademeng/articles/10882539.html">Java中join()方法的理解 - 天涯海角路 - 博客园 (cnblogs.com)</a></p>
<p>参考书目：</p>
<p><a target="_blank" rel="noopener" href="http://product.dangdang.com/23248198.html?ref=book-35530-3032_5-231497-4">《Java编程手记——从实践中学习Java（配光盘）》(欧二强　等编著)【简介_书评_在线阅读】 - 当当图书 (dangdang.com)</a></p>
<p><a target="_blank" rel="noopener" href="https://item.jd.com/36427083594.html">《Java基础入门 第2版 黑马程序员 经典Java入门教材书籍》【摘要 书评 试读】- 京东图书 (jd.com)</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://silenthly.github.io/2021/08/04/%E7%BA%BF%E7%A8%8B%E7%9A%84%E5%88%9B%E5%BB%BA/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="buyan">
      <meta itemprop="description" content="我见过真正难过的人，但他一滴泪也没流">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Buyan-Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/08/04/%E7%BA%BF%E7%A8%8B%E7%9A%84%E5%88%9B%E5%BB%BA/" class="post-title-link" itemprop="url">线程的创建</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-08-04 11:45:46" itemprop="dateCreated datePublished" datetime="2021-08-04T11:45:46+08:00">2021-08-04</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-08-13 12:56:07" itemprop="dateModified" datetime="2021-08-13T12:56:07+08:00">2021-08-13</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/java/" itemprop="url" rel="index"><span itemprop="name">java</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2021/08/04/%E7%BA%BF%E7%A8%8B%E7%9A%84%E5%88%9B%E5%BB%BA/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2021/08/04/%E7%BA%BF%E7%A8%8B%E7%9A%84%E5%88%9B%E5%BB%BA/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>​		java程序中的线程被设计为一个对象，但不是每一个对象都是线程，只有实现了Runnable接口的类才能称为线程，也就是说，<span style="color:red;background:背景颜色;font-size:文字大小;font-family:字体;"><strong>创建线程必须使用“实现Runnable接口的类创建的对象”</strong></span>。java语言提供了两种途径实现多线程，一种是继承Thread类(该类已实现Runnable接口)，另一种是直接实现Runnable接口。下面分别介绍这两种途径的使用及其区别。</p>
<h3 id="通过继承thread类创建线程"><a class="markdownIt-Anchor" href="#通过继承thread类创建线程"></a> 通过继承Thread类创建线程</h3>
<p>​		Thread类属于java.lang包，系统在运行时会自动导入，所以不需要使用import关键字显式导入Thread类。</p>
<p>Thread类的定义：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Thread</span> <span class="keyword">extends</span> <span class="title">Object</span> <span class="title">implemments</span> <span class="title">Runnable</span></span></span><br></pre></td></tr></table></figure>
<p>​		可以发现Thread类已经实现了Runnable接口，所以只要让一个类继承Thread类，并将线程的程序代码写在run()方法内，即重写Thread类的run()方法即可创建线程。</p>
<p>多线程的定义格式：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[<span class="keyword">public</span>] <span class="class"><span class="keyword">class</span> 类名 <span class="keyword">extends</span> <span class="title">Thread</span>		//继承<span class="title">Thread</span>类</span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">//属性；</span></span><br><span class="line">    <span class="comment">//方法</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span>		<span class="comment">//重写Thread类的run()方法</span></span></span><br><span class="line"><span class="function">    </span>&#123;...&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>​	<strong>注意，Thread只是创建了一个线程，而创建线程需要一个实现Runnable接口的类创建的对象，子类继承Thread类实际上已经间接实现了Runnable接口，通过该子类创建的实例，实质是包含了一个对象的线程。</strong></p>
<h4 id="thread类创建多线程类"><a class="markdownIt-Anchor" href="#thread类创建多线程类"></a> Thread类创建多线程类</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> <span class="keyword">extends</span> <span class="title">Thread</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Test</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Test</span><span class="params">(String name)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        setName(name);			<span class="comment">//调用Thread类中的setName()方法</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=<span class="number">10</span>;i++)</span><br><span class="line">        &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;当前运行的线程&quot;</span>+getName()+<span class="string">&quot;,i=&quot;</span>+i);	<span class="comment">//输出当前运行的线程</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Test t1=<span class="keyword">new</span> Test(<span class="string">&quot;线程-1&quot;</span>);	<span class="comment">//创建线程t1	</span></span><br><span class="line">        Test t2=<span class="keyword">new</span> Test(<span class="string">&quot;线程-2&quot;</span>);	<span class="comment">//创建线程t2</span></span><br><span class="line">        t1.start();			<span class="comment">//启动线程t1</span></span><br><span class="line">        t2.start();			<span class="comment">//启动线程t2</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：（其中一种运行结果，以上程序每次运行结果可能不同，这是正常现象）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">当前运行的线程线程-<span class="number">1</span>,i=<span class="number">1</span></span><br><span class="line">当前运行的线程线程-<span class="number">1</span>,i=<span class="number">2</span></span><br><span class="line">当前运行的线程线程-<span class="number">2</span>,i=<span class="number">1</span></span><br><span class="line">当前运行的线程线程-<span class="number">2</span>,i=<span class="number">2</span></span><br><span class="line">当前运行的线程线程-<span class="number">1</span>,i=<span class="number">3</span></span><br><span class="line">当前运行的线程线程-<span class="number">2</span>,i=<span class="number">3</span></span><br><span class="line">当前运行的线程线程-<span class="number">1</span>,i=<span class="number">4</span></span><br><span class="line">当前运行的线程线程-<span class="number">2</span>,i=<span class="number">4</span></span><br><span class="line">当前运行的线程线程-<span class="number">2</span>,i=<span class="number">5</span></span><br><span class="line">当前运行的线程线程-<span class="number">2</span>,i=<span class="number">6</span></span><br><span class="line">当前运行的线程线程-<span class="number">1</span>,i=<span class="number">5</span></span><br><span class="line">当前运行的线程线程-<span class="number">2</span>,i=<span class="number">7</span></span><br><span class="line">当前运行的线程线程-<span class="number">1</span>,i=<span class="number">6</span></span><br><span class="line">当前运行的线程线程-<span class="number">2</span>,i=<span class="number">8</span></span><br><span class="line">当前运行的线程线程-<span class="number">1</span>,i=<span class="number">7</span></span><br><span class="line">当前运行的线程线程-<span class="number">2</span>,i=<span class="number">9</span></span><br><span class="line">当前运行的线程线程-<span class="number">1</span>,i=<span class="number">8</span></span><br><span class="line">当前运行的线程线程-<span class="number">2</span>,i=<span class="number">10</span></span><br><span class="line">当前运行的线程线程-<span class="number">1</span>,i=<span class="number">9</span></span><br><span class="line">当前运行的线程线程-<span class="number">1</span>,i=<span class="number">10</span></span><br></pre></td></tr></table></figure>
<p>​		从程序的运行结果可以发现，“线程-1”和“线程-2”是交替运行的，也就是说程序是采用了多线程机制运行了。在Test类中没有定义setName()和getName()方法，是因为Thread类中已经定义了final类型的的setName()和getName()方法，所以子类Test不能冲洗定义这些方法，直接使用即可。</p>
<p>​		还可以发现Test类中并没有调用run()方法，而是调用了start()方法，这是为什么呢？run()方法是线程需要执行的内容，但是启动线程并不是直接调用run()方法，而是调用start()方法。Thread类中的start()方法用于启动一个线程，并在该线程上运行Thread类对象的run()方法。通过start()方法启动线程，是因为线程的运行需要本机操作系统的支持。</p>
<p><span style="color:red;background:背景颜色;font-size:文字大小;font-family:字体;">注意：一个线程对象只能调用一次start()方法，若多次调用将会抛出&quot;IllegalThreadStateException&quot;异常。</span></p>
<h3 id="通过实现runnable接口创建线程"><a class="markdownIt-Anchor" href="#通过实现runnable接口创建线程"></a> 通过实现Runnable接口创建线程</h3>
<p>​		一般情况下，实现多线程都可以通过Runnable接口来实现。</p>
<p>Runnable接口的定义：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Runnable</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>​		可以发现，Runnable接口中仅仅提供了一个抽象方法run()。</p>
<p>多线程的定义格式：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[<span class="keyword">public</span>] <span class="class"><span class="keyword">class</span> 类名 <span class="keyword">implements</span> <span class="title">Runnable</span>		//实现<span class="title">Runnable</span>接口</span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">//属性；</span></span><br><span class="line">    <span class="comment">//方法</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span>		<span class="comment">//实现Runnable接口的run()方法</span></span></span><br><span class="line"><span class="function">    </span>&#123;...&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="runnable接口创建多线程"><a class="markdownIt-Anchor" href="#runnable接口创建多线程"></a> Runnable接口创建多线程</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> <span class="keyword">implements</span> <span class="title">Runnable</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Test</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Test</span><span class="params">(String name)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        setName(name);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name=name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=<span class="number">10</span>;i++)</span><br><span class="line">        &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;当前运行的线程&quot;</span>+getName()+<span class="string">&quot;,i=&quot;</span>+i);	<span class="comment">//输出当前运行的线程</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Test r1=<span class="keyword">new</span> Test(<span class="string">&quot;线程-1&quot;</span>);		<span class="comment">//创建对象r1</span></span><br><span class="line">        Test r2=<span class="keyword">new</span> Test(<span class="string">&quot;线程-2&quot;</span>);</span><br><span class="line">        Thread t1=<span class="keyword">new</span> Thread(r1);		<span class="comment">//以对象r1创建线程</span></span><br><span class="line">        Thread t2=<span class="keyword">new</span> Thread(r2);</span><br><span class="line">        t1.start();			<span class="comment">//启动线程t1</span></span><br><span class="line">        t2.start();			<span class="comment">//启动线程t2</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">当前运行的线程线程-<span class="number">1</span>,i=<span class="number">1</span></span><br><span class="line">当前运行的线程线程-<span class="number">1</span>,i=<span class="number">2</span></span><br><span class="line">当前运行的线程线程-<span class="number">1</span>,i=<span class="number">3</span></span><br><span class="line">当前运行的线程线程-<span class="number">1</span>,i=<span class="number">4</span></span><br><span class="line">当前运行的线程线程-<span class="number">1</span>,i=<span class="number">5</span></span><br><span class="line">当前运行的线程线程-<span class="number">2</span>,i=<span class="number">1</span></span><br><span class="line">当前运行的线程线程-<span class="number">2</span>,i=<span class="number">2</span></span><br><span class="line">当前运行的线程线程-<span class="number">2</span>,i=<span class="number">3</span></span><br><span class="line">当前运行的线程线程-<span class="number">2</span>,i=<span class="number">4</span></span><br><span class="line">当前运行的线程线程-<span class="number">2</span>,i=<span class="number">5</span></span><br><span class="line">当前运行的线程线程-<span class="number">2</span>,i=<span class="number">6</span></span><br><span class="line">当前运行的线程线程-<span class="number">2</span>,i=<span class="number">7</span></span><br><span class="line">当前运行的线程线程-<span class="number">2</span>,i=<span class="number">8</span></span><br><span class="line">当前运行的线程线程-<span class="number">2</span>,i=<span class="number">9</span></span><br><span class="line">当前运行的线程线程-<span class="number">2</span>,i=<span class="number">10</span></span><br><span class="line">当前运行的线程线程-<span class="number">1</span>,i=<span class="number">6</span></span><br><span class="line">当前运行的线程线程-<span class="number">1</span>,i=<span class="number">7</span></span><br><span class="line">当前运行的线程线程-<span class="number">1</span>,i=<span class="number">8</span></span><br><span class="line">当前运行的线程线程-<span class="number">1</span>,i=<span class="number">9</span></span><br><span class="line">当前运行的线程线程-<span class="number">1</span>,i=<span class="number">10</span></span><br></pre></td></tr></table></figure>
<p>​		由于Runnable接口对线程没有任何支持，因此在获得线程实例后，必须通过Thread类的构造方法来实现。</p>
<h3 id="java主线程main"><a class="markdownIt-Anchor" href="#java主线程main"></a> java主线程——main()</h3>
<p>​		一个java应用程序的主类main()方法是它的主线程。当java程序启动时，一个主线程自动的被创建并运行。执行的进入点是main()方法，可以将其视为主线程的run()方法。</p>
<p>​		由于主线程是自动建立的，因此很容易忽略它是线程的事实，但我们不能忽略。主线程是产生应用程序所有其他线程的线程，就是说，程序中只要有其他非守护线程尚未结束，主线程就不会结束，即使main()方法中使用了return语句或main()方法的内容已执行结束也是一样的。</p>
<p>​		在Thread类中定义了一个类方法currentThread()，程序员可利用该方法获取主线程对象引用。借此可以对主线程做各种控制处理，因为主线程也是一个对象。</p>
<p>代码示例：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> <span class="keyword">implements</span> <span class="title">Runnable</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=<span class="number">10</span>;i++)</span><br><span class="line">        &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;当前运行的线程：&quot;</span>+Thread.currentThread()+<span class="string">&quot;,i=&quot;</span>+i);	<span class="comment">//输出当前运行的线程</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Thread mt=Thread.currentThread();		<span class="comment">//获取主线程</span></span><br><span class="line">        System.out.println(<span class="string">&quot;线程信息：&quot;</span>+mt);</span><br><span class="line">        System.out.println(<span class="string">&quot;线程名称：&quot;</span>+mt.getName());</span><br><span class="line">        mt.setName(<span class="string">&quot;主线程&quot;</span>);		<span class="comment">//设置主线程名称</span></span><br><span class="line">        System.out.println(<span class="string">&quot;线程名称：&quot;</span>+mt.getName());</span><br><span class="line">        Test mtThread=<span class="keyword">new</span> Test();</span><br><span class="line">        Thread t=<span class="keyword">new</span> Thread(mtThread);</span><br><span class="line">        t.start();</span><br><span class="line">        mtThread.run();		<span class="comment">//直接调用run方法</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">当前运行的线程：Thread[主线程,<span class="number">5</span>,main],i=<span class="number">1</span></span><br><span class="line">当前运行的线程：Thread[主线程,<span class="number">5</span>,main],i=<span class="number">2</span></span><br><span class="line">当前运行的线程：Thread[主线程,<span class="number">5</span>,main],i=<span class="number">3</span></span><br><span class="line">当前运行的线程：Thread[Thread-<span class="number">0</span>,<span class="number">5</span>,main],i=<span class="number">1</span></span><br><span class="line">当前运行的线程：Thread[主线程,<span class="number">5</span>,main],i=<span class="number">4</span></span><br><span class="line">当前运行的线程：Thread[Thread-<span class="number">0</span>,<span class="number">5</span>,main],i=<span class="number">2</span></span><br><span class="line">当前运行的线程：Thread[主线程,<span class="number">5</span>,main],i=<span class="number">5</span></span><br><span class="line">当前运行的线程：Thread[主线程,<span class="number">5</span>,main],i=<span class="number">6</span></span><br><span class="line">当前运行的线程：Thread[主线程,<span class="number">5</span>,main],i=<span class="number">7</span></span><br><span class="line">当前运行的线程：Thread[主线程,<span class="number">5</span>,main],i=<span class="number">8</span></span><br><span class="line">当前运行的线程：Thread[主线程,<span class="number">5</span>,main],i=<span class="number">9</span></span><br><span class="line">当前运行的线程：Thread[主线程,<span class="number">5</span>,main],i=<span class="number">10</span></span><br><span class="line">当前运行的线程：Thread[Thread-<span class="number">0</span>,<span class="number">5</span>,main],i=<span class="number">3</span></span><br><span class="line">当前运行的线程：Thread[Thread-<span class="number">0</span>,<span class="number">5</span>,main],i=<span class="number">4</span></span><br><span class="line">当前运行的线程：Thread[Thread-<span class="number">0</span>,<span class="number">5</span>,main],i=<span class="number">5</span></span><br><span class="line">当前运行的线程：Thread[Thread-<span class="number">0</span>,<span class="number">5</span>,main],i=<span class="number">6</span></span><br><span class="line">当前运行的线程：Thread[Thread-<span class="number">0</span>,<span class="number">5</span>,main],i=<span class="number">7</span></span><br><span class="line">当前运行的线程：Thread[Thread-<span class="number">0</span>,<span class="number">5</span>,main],i=<span class="number">8</span></span><br><span class="line">当前运行的线程：Thread[Thread-<span class="number">0</span>,<span class="number">5</span>,main],i=<span class="number">9</span></span><br><span class="line">当前运行的线程：Thread[Thread-<span class="number">0</span>,<span class="number">5</span>,main],i=<span class="number">10</span></span><br></pre></td></tr></table></figure>
<p>​		从程序运行结果可以发现，默认情况下主线程的名称为main，优先级为5。所以说，一个java程序运行至少会启动两个线程，一个是JVm的垃圾收集线程，一个是主线程。</p>
<h3 id="比价继承thread类和实现runnable接口"><a class="markdownIt-Anchor" href="#比价继承thread类和实现runnable接口"></a> 比价继承Thread类和实现Runnable接口</h3>
<p>​		继承Thread类和实现Runnable接口都可以实现多线程，但是在一般情况下都会选择后者。与继承Thread类相比，实现Runnable接口有以下好处：</p>
<p>（1）可以避免由于java单继承特性带来的局限。一个java类继承继承一个类，但是可以实现多个接口。</p>
<p>（2）适合多个相同程序代码的线程去处理同一资源的情况，有利于程序的健壮性。把线程相同程序的代码、数据有效分离，代码能够被多个线程共享，代码与数据是独立的。可以让多个线程共享一个实例的数据，因为通过Runnable接口实现多线程，可以通过一个对象实例创建多个线程。</p>
<h4 id="案例讲解"><a class="markdownIt-Anchor" href="#案例讲解"></a> 案例讲解：</h4>
<p>​		某电影院有两个售票窗口发售某影片的门票，假设VIP门票只有10张，下面编写一个售票系统，每个窗口用一个线程表示。</p>
<h5 id="thread类设计系统"><a class="markdownIt-Anchor" href="#thread类设计系统"></a> Thread类设计系统</h5>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Ticket</span> <span class="keyword">extends</span> <span class="title">Thread</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> ticket=<span class="number">10</span>;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Ticket</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Ticket</span><span class="params">(String name)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        setName(name);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">while</span>(ticket&gt;<span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            System.out.println(Thread.currentThread().getName()+<span class="string">&quot;卖出第&quot;</span>+(ticket--)+<span class="string">&quot;张门票...&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Ticket window1=<span class="keyword">new</span> Ticket(<span class="string">&quot;第一窗口&quot;</span>);		<span class="comment">//创建线程window1</span></span><br><span class="line">        Ticket window2=<span class="keyword">new</span> Ticket(<span class="string">&quot;第二窗口&quot;</span>);</span><br><span class="line">        window1.start();</span><br><span class="line">        window2.start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">第一窗口卖出第<span class="number">10</span>张门票...</span><br><span class="line">第一窗口卖出第<span class="number">9</span>张门票...</span><br><span class="line">第二窗口卖出第<span class="number">10</span>张门票...</span><br><span class="line">第一窗口卖出第<span class="number">8</span>张门票...</span><br><span class="line">第二窗口卖出第<span class="number">9</span>张门票...</span><br><span class="line">第二窗口卖出第<span class="number">8</span>张门票...</span><br><span class="line">第二窗口卖出第<span class="number">7</span>张门票...</span><br><span class="line">第二窗口卖出第<span class="number">6</span>张门票...</span><br><span class="line">第二窗口卖出第<span class="number">5</span>张门票...</span><br><span class="line">第二窗口卖出第<span class="number">4</span>张门票...</span><br><span class="line">第二窗口卖出第<span class="number">3</span>张门票...</span><br><span class="line">第二窗口卖出第<span class="number">2</span>张门票...</span><br><span class="line">第二窗口卖出第<span class="number">1</span>张门票...</span><br><span class="line">第一窗口卖出第<span class="number">7</span>张门票...</span><br><span class="line">第一窗口卖出第<span class="number">6</span>张门票...</span><br><span class="line">第一窗口卖出第<span class="number">5</span>张门票...</span><br><span class="line">第一窗口卖出第<span class="number">4</span>张门票...</span><br><span class="line">第一窗口卖出第<span class="number">3</span>张门票...</span><br><span class="line">第一窗口卖出第<span class="number">2</span>张门票...</span><br><span class="line">第一窗口卖出第<span class="number">1</span>张门票...</span><br></pre></td></tr></table></figure>
<p>​		以上程序通过继承Thread类实现了多线程，程序中启动了两个程序，但是这两个线程却分别卖出了各自的10张门票，没有达到预期资源共享的目的。</p>
<h5 id="runnable接口设计系统"><a class="markdownIt-Anchor" href="#runnable接口设计系统"></a> Runnable接口设计系统</h5>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Ticket</span> <span class="keyword">extends</span> <span class="title">Thread</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> ticket=<span class="number">10</span>;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Ticket</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Ticket</span><span class="params">(String name)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        setName(name);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">while</span>(ticket&gt;<span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            System.out.println(Thread.currentThread().getName()+<span class="string">&quot;卖出第&quot;</span>+(ticket--)+<span class="string">&quot;张门票...&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Ticket window=<span class="keyword">new</span> Ticket();</span><br><span class="line">        Thread window1=<span class="keyword">new</span> Thread(window,<span class="string">&quot;第一窗口&quot;</span>);		<span class="comment">//以对象window创建线程window1</span></span><br><span class="line">        Thread window2=<span class="keyword">new</span> Thread(window,<span class="string">&quot;第二窗口&quot;</span>);		<span class="comment">//以对象window创建线程window2</span></span><br><span class="line">        window1.start();</span><br><span class="line">        window2.start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">第二窗口卖出第<span class="number">10</span>张门票...</span><br><span class="line">第二窗口卖出第<span class="number">8</span>张门票...</span><br><span class="line">第二窗口卖出第<span class="number">7</span>张门票...</span><br><span class="line">第一窗口卖出第<span class="number">9</span>张门票...</span><br><span class="line">第一窗口卖出第<span class="number">5</span>张门票...</span><br><span class="line">第二窗口卖出第<span class="number">6</span>张门票...</span><br><span class="line">第二窗口卖出第<span class="number">3</span>张门票...</span><br><span class="line">第二窗口卖出第<span class="number">2</span>张门票...</span><br><span class="line">第二窗口卖出第<span class="number">1</span>张门票...</span><br><span class="line">第一窗口卖出第<span class="number">4</span>张门票...</span><br></pre></td></tr></table></figure>
<p>​		上面程序创建了两个线程，每一个线程都是调用同一个Ticket类中的run()方法，访问的是同一个对象(window)的变量ticket的实例。通过Runnable接口可以实现<strong>多线程可以满足资源共享</strong>，达到预期目的。</p>
<h5 id="static实现数据共享"><a class="markdownIt-Anchor" href="#static实现数据共享"></a> static实现数据共享</h5>
<p>​		也可以使用static变量达到数据共享的目的。在前面讲过static成员是类中的所有实例共享的，因此可以通过static变量达到共享数据的目的。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Ticket</span> <span class="keyword">extends</span> <span class="title">Thread</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> ticket=<span class="number">10</span>;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Ticket</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Ticket</span><span class="params">(String name)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        setName(name);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">while</span>(ticket&gt;<span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            System.out.println(Thread.currentThread().getName()+<span class="string">&quot;卖出第&quot;</span>+(ticket--)+<span class="string">&quot;张门票...&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Ticket window1=<span class="keyword">new</span> Ticket(<span class="string">&quot;第一窗口&quot;</span>);</span><br><span class="line">        Ticket window2=<span class="keyword">new</span> Ticket(<span class="string">&quot;第二窗口&quot;</span>);</span><br><span class="line">        window1.start();</span><br><span class="line">        window2.start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">第二窗口卖出第<span class="number">10</span>张门票...</span><br><span class="line">第二窗口卖出第<span class="number">8</span>张门票...</span><br><span class="line">第一窗口卖出第<span class="number">9</span>张门票...</span><br><span class="line">第二窗口卖出第<span class="number">7</span>张门票...</span><br><span class="line">第二窗口卖出第<span class="number">5</span>张门票...</span><br><span class="line">第二窗口卖出第<span class="number">4</span>张门票...</span><br><span class="line">第二窗口卖出第<span class="number">3</span>张门票...</span><br><span class="line">第二窗口卖出第<span class="number">2</span>张门票...</span><br><span class="line">第二窗口卖出第<span class="number">1</span>张门票...</span><br><span class="line">第一窗口卖出第<span class="number">6</span>张门票...</span><br></pre></td></tr></table></figure>
<p>​		不过使用上述代码很容易发生只有一个窗口在卖票，而另一个窗口却没有卖票，这是因为有一个窗口一直在占有CPU。这是可以使用Thread类提供的sleep()方法让其休眠，以便让出CPU给另一个窗口。</p>
<p>参考链接：</p>
<p><a target="_blank" rel="noopener" href="https://zhidao.baidu.com/question/410858151.html?ivk_sa=1022817r">创建多个线程对同一个对象操作是什么意思？线程与对象的关系是什么？_百度知道 (baidu.com)</a></p>
<p>参考书目：</p>
<p><a target="_blank" rel="noopener" href="http://product.dangdang.com/23248198.html?ref=book-35530-3032_5-231497-4">《Java编程手记——从实践中学习Java（配光盘）》(欧二强　等编著)【简介_书评_在线阅读】 - 当当图书 (dangdang.com)</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://silenthly.github.io/2021/08/04/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="buyan">
      <meta itemprop="description" content="我见过真正难过的人，但他一滴泪也没流">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Buyan-Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/08/04/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/" class="post-title-link" itemprop="url">多线程的基本概念</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-08-04 07:13:48" itemprop="dateCreated datePublished" datetime="2021-08-04T07:13:48+08:00">2021-08-04</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-08-13 12:56:02" itemprop="dateModified" datetime="2021-08-13T12:56:02+08:00">2021-08-13</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/java/" itemprop="url" rel="index"><span itemprop="name">java</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2021/08/04/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2021/08/04/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>​		传统的编程语言如c/c++语言，本身并没有提供多线程编程功能，但它们可以调用操作系统的多线程功能。java语言本身就提供了多线程编程能力。为了很好的理解多线程，我们必须先了解什么是程序、什么是进程。</p>
<h3 id="程序"><a class="markdownIt-Anchor" href="#程序"></a> 程序</h3>
<p>​		“程序(Program)”是一个静态的概念，一般对应与操作系统中的一个可执行文件，比如：我们要启动酷狗听音乐，则对应酷狗的可执行程序。<strong>当我们双击酷狗，则加载程序到内存中，开始执行该程序，于是产生了“进程”。</strong></p>
<h3 id="进程"><a class="markdownIt-Anchor" href="#进程"></a> 进程</h3>
<p>​		执行中的程序叫做进程(Process)，是一个动态的概念。现代的操作系统都可以同时启动多个进程。比如：我们在用网易云听音乐，也可以使用idea 写代码，也可以同时用浏览器查看网页。进程的具有以下特性：</p>
<ul>
<li>**独立性。**进程是一个实体，每一个进程都有它自己的内存空间和系统资源，是一个能独立运行的基本单位，同时也是系统中独立获得资源和独立调度的基本单位。</li>
<li>**动态性。**动态性是进程最基本的特性，可表现为由创建而产生，由调度而执行，因得不到资源而暂停执行，以及由撤销而消亡，因而进程由一定的生命期；</li>
<li><strong>并发性。<strong>并发不是并行，并发是逻辑上同时发生，是指在某</strong>一段时间内</strong>同时运行多个进程，而并行是物理上同时发生，是指在某<strong>一个时间点内</strong>同时运行多个进程。在单cpu的计算机中，某一时刻实际上只能运行一个进程，多进程实际是cpu<strong>交替轮流执</strong>行多个进程的结果，是并发的。</li>
</ul>
<h4 id="程序与进程的区别"><a class="markdownIt-Anchor" href="#程序与进程的区别"></a> 程序与进程的区别</h4>
<p>1、动态性与静态性。程序是静态的，而进程是动态的。进程是一个能独立运行的单位，能与其他进程并发执行，而对于未建立任何进程的程序，都不能作为一个独立的单位来运行。</p>
<p>2、临时性与永久性。程序是永久的，而进程是临时的。程序可以作为一种软件资源长期保存，而进程仅是运行的程序，具有一定的生命周期，会动态的产生和消亡。</p>
<p>3、组成不同。进程包括了程序、数据和进程控制块(PCB)。</p>
<p><span style="color:red;background:背景颜色;font-size:文字大小;font-family:字体;">注意：程序与进程不一定具有一一对应的关系。一方面，一个程序可由多个进程共用，例如输入法。另一方面，一个进程在其活动中可顺序的执行若干程序。</span></p>
<h3 id="线程"><a class="markdownIt-Anchor" href="#线程"></a> 线程</h3>
<p>​		在一个进程内部又可以执行多个任务，一般将进程内部的任务称为线程。对线程的理解如下：</p>
<ul>
<li>一个进程内部的一个执行单元，它是程序中的一个单一的顺序控制流程。（程序使用cpu的基本单位）</li>
<li>一个进程至少包含一个线程，可拥有多个并行的线程。</li>
<li>线程除了在运行时占用cpu资源外，不能拥有系统资源，只能使用进程的资源。</li>
<li>同多个进程可以共享操作系统的某些资源一样，同一进程的多个线程也可以共享此进程的某些资源（比如：代码、数据），所以线程又被称为轻量级进程。</li>
</ul>
<h4 id="线程与进程的区别"><a class="markdownIt-Anchor" href="#线程与进程的区别"></a> 线程与进程的区别</h4>
<p>1、地址空间和其他资源。每个进程占有独立的地址空间，包括代码、数据及其他资源，然而，属于统一个进程中的线程智能共享这些资源，不具有独立的地址空间和其他资源。</p>
<p>2、通信。进程之间的通信(简称IPC)开销较大且受到诸多的吸纳在，必须具有明确的对象或操作接口并采用统一的通信协议。而线程将可以直接读写进程数据段(如全局变量)来进行通信，需要进程同步和互斥手段的辅助，以保证数据的一致性，开销较少且比较简单。</p>
<p>3、切换。进程将的切换开销比较大，而线程间的开销较小。在多进程程序中需要切换进程时，需要改变地址空间位置。而在多线程程序只需要改变执行次序，因为他们都位于一个存储空间内。</p>
<p>4、控制表。进程的控制表为PCB，线程的控制表为TCP，TCP中保存的线程状态远少于PCB。</p>
<p>参考链接：</p>
<p><a target="_blank" rel="noopener" href="https://zhidao.baidu.com/question/209691887.html">从动态性、并发性、独立性、上比较进程和程序_百度知道 (baidu.com)</a></p>
<p>参考书目：</p>
<p><a target="_blank" rel="noopener" href="http://product.dangdang.com/23248198.html?ref=book-35530-3032_5-231497-4">《Java编程手记——从实践中学习Java（配光盘）》(欧二强　等编著)【简介_书评_在线阅读】 - 当当图书 (dangdang.com)</a></p>
<p><a target="_blank" rel="noopener" href="https://read.douban.com/ebook/57019647/">实战Java程序设计 - 北京尚学堂科技有限公司 编著 | 豆瓣阅读 (douban.com)</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://silenthly.github.io/2021/08/03/%E5%AF%B9%E8%B1%A1%E5%BA%8F%E5%88%97%E5%8C%96/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="buyan">
      <meta itemprop="description" content="我见过真正难过的人，但他一滴泪也没流">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Buyan-Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/08/03/%E5%AF%B9%E8%B1%A1%E5%BA%8F%E5%88%97%E5%8C%96/" class="post-title-link" itemprop="url">对象序列化</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-08-03 09:14:23" itemprop="dateCreated datePublished" datetime="2021-08-03T09:14:23+08:00">2021-08-03</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-09-04 18:16:30" itemprop="dateModified" datetime="2021-09-04T18:16:30+08:00">2021-09-04</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/java/" itemprop="url" rel="index"><span itemprop="name">java</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2021/08/03/%E5%AF%B9%E8%B1%A1%E5%BA%8F%E5%88%97%E5%8C%96/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2021/08/03/%E5%AF%B9%E8%B1%A1%E5%BA%8F%E5%88%97%E5%8C%96/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>​		对象序列化是个非常复杂的问题，java API文档规范中有关于对象序列化的规范。本文不对此问题进行详细深入的介绍，只介绍对象流最简单的用法。我们只需要了解对象序列化的基本概念、对象输出流ObjectOutputStream及对象输入流ObjectInputStream即可。</p>
<h3 id="对象序列化的简介"><a class="markdownIt-Anchor" href="#对象序列化的简介"></a> 对象序列化的简介</h3>
<p>​		对象序列化是将对象状态转换为可保存或传输的格式的过程。一般的格式是与平台无关的二进制流（字节序列），可以将这种二进制持久保存在磁盘上，也可以通过网络将这种二进制流传输到另一个网络结点，即将对象写入输入流。与对象序列化相对应的是对象反序列化，是指由输入流将这种二进制流读入，重新恢复成原来的对象。将对象反序列化和对象序列化这两个过程结合起来，可以轻松地存储和传输数据，使对象可以脱离程序的运行而独立存在。</p>
<blockquote>
<p>提示：对象序列化只是实现一种轻量级的对象持久性。之所以是轻量级，是因为这种对象持久性的实现手段实际上只适合于较小的对象。</p>
</blockquote>
<p>​		一般而言，对象序列化主要有以下几个作用。</p>
<ul>
<li>RMI（Remote Method Invocation，远程方法调用）机制，它是 java EE 技术的基础。 通过各个 Socket 作为对象之间的通信，从而实现程序组件在不同操作系统之间的通信。RMI 可以大大增强 java 开发分布式应用的能力。</li>
<li>将对象转换成文件，可保存在硬盘上，以备将来继续使用对象。</li>
<li>通过序列化在进程间传递对象。</li>
</ul>
<p>​		java的对象可以分为可序列化和不可序列化对象，若需要某个对象能支持序列化机制。必须让它实现Serialization接口。Serialization接口的定义如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Serialization</span></span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>​		可以发现。Serialzation接口值是一个标记接口。实现接口无须实现任何方法，仅仅表明该类的对象是可序列化的。</p>
<p>代码示例：(定义可序列化的类)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> <span class="keyword">implements</span> <span class="title">Serializable</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line">    <span class="keyword">private</span> String school;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Student</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Student</span><span class="params">(String name,<span class="keyword">int</span> age,String school)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name=name;</span><br><span class="line">        <span class="keyword">this</span>.age=age;</span><br><span class="line">        <span class="keyword">this</span>.scool=school;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">tell</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;名字：&quot;</span>+name+<span class="string">&quot;\n年龄：&quot;</span>+age+<span class="string">&quot;\n学校：&quot;</span>+school);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>​		在以上的程序中，若不使用import关键字导入java.io.Seriablizable，则可以使用public class Student implements java.io.Serializable。由于Seriablizable接口并没有需要实现顶点方法，所以实现它的过程非常简单。</p>
<blockquote>
<p>提示：如果一个对象可以被序列，那么对象中的哪些成员参与了序列化呢？</p>
<p>​		java对象被序列化时参与序列化的内容如下。</p>
<ul>
<li>属性：如基本数据类型、数组和其他对象的引用。</li>
<li>类名。</li>
</ul>
<p>​		不能被序列化的内容有</p>
<ul>
<li>方法：类中的所有方法。</li>
<li>static关键字和transient关键字修饰的属性。</li>
</ul>
</blockquote>
<h3 id="对象输出流objectoutputstream"><a class="markdownIt-Anchor" href="#对象输出流objectoutputstream"></a> 对象输出流：ObjectOutputStream</h3>
<p>​		java.io.ObjectOutputStream类用于对象的序列化，即将一个对象输出。此类的定义为：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ObjectOutputStream</span> <span class="keyword">extends</span> <span class="title">OutputStream</span> <span class="keyword">implements</span> <span class="title">ObejctOutput</span>,<span class="title">ObjectStreamConstants</span></span></span><br></pre></td></tr></table></figure>
<p>​		可以发现ObjectOutputStreamWriter类实现了ObjectOutput接口，提供了基本的写入操作。ObjectOutputStream类的常用方法如下表所示。</p>
<table>
<thead>
<tr>
<th style="text-align:center">序号</th>
<th style="text-align:center">方法</th>
<th style="text-align:center">类型</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">public ObjectOutputStream(OutputStream out)throws IOException</td>
<td style="text-align:center">构造</td>
<td style="text-align:center">创建写入指定OutputStream的ObjectOutputStream对象</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">public void reset()throws IOException</td>
<td style="text-align:center">普通</td>
<td style="text-align:center">重置将丢弃已写入流中的所有对象的状态</td>
</tr>
<tr>
<td style="text-align:center"><strong>3</strong></td>
<td style="text-align:center"><strong>public writeObject(Object obj)throws IOException</strong></td>
<td style="text-align:center"><strong>普通</strong></td>
<td style="text-align:center"><strong>将指定的对象写入ObjectOutputStream</strong></td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:center">public void writeUnshared(Object obj)throws IOException</td>
<td style="text-align:center">普通</td>
<td style="text-align:center">将“未共享”对象写入ObjectOutputStream</td>
</tr>
</tbody>
</table>
<blockquote>
<p>提示：ObjectOutputStream类与其他的输出流一样，也包含write()、flush()和close()等方法，在此不再赘述。</p>
</blockquote>
<p>代码示例：(将对象保存在文件中)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span> <span class="keyword">implements</span> <span class="title">Serializable</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line">    <span class="keyword">private</span> String school;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Student</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Student</span><span class="params">(String name,<span class="keyword">int</span> age,String school)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name=name;</span><br><span class="line">        <span class="keyword">this</span>.age=age;</span><br><span class="line">        <span class="keyword">this</span>.school=school;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">tell</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;名字：&quot;</span>+name+<span class="string">&quot;\n年龄：&quot;</span>+age+<span class="string">&quot;\n学校：&quot;</span>+school);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Student stu1=<span class="keyword">new</span> Student(<span class="string">&quot;小强&quot;</span>,<span class="number">18</span>,<span class="string">&quot;CUMT&quot;</span>);</span><br><span class="line">        Student stu2=<span class="keyword">new</span> Student(<span class="string">&quot;小明&quot;</span>,<span class="number">19</span>,<span class="string">&quot;WHU&quot;</span>);</span><br><span class="line">        File file=<span class="keyword">new</span> File(<span class="string">&quot;Objectstudent.txt&quot;</span>);</span><br><span class="line">        FileOutputStream fout=<span class="keyword">null</span>;</span><br><span class="line">        ObjectOutputStream oos=<span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            fout=<span class="keyword">new</span> FileOutputStream(file);</span><br><span class="line">            oos=<span class="keyword">new</span> ObjectOutputStream(fout);</span><br><span class="line">            oos.writeObject(stu1);		<span class="comment">//序列化对象stu1</span></span><br><span class="line">            oos.writeObject(stu2);		<span class="comment">//序列化对象stu2</span></span><br><span class="line">            oos.close();</span><br><span class="line">        &#125;<span class="keyword">catch</span>(Exception e)</span><br><span class="line">        	&#123;</span><br><span class="line">            	e.printStackTrace();</span><br><span class="line">        	&#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>​		以上程序中，Student类要与Test类在同一个文件夹中，否则需要使用import关键字进行导入Student类。程序可将对象的内容保存在文件中，但是保存的内容是二进制数据，所以不能在文件中直接修改数据，否则会破坏数据的结构。</p>
<h3 id="对象输入流objectinputstream"><a class="markdownIt-Anchor" href="#对象输入流objectinputstream"></a> 对象输入流：ObjectInputStream</h3>
<p>​		ObjectInputStream类用于对对象进行反序列化操作。ObjectInputStream类的定义如下;</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ObjectInputStream</span> <span class="keyword">extends</span> <span class="title">InputStream</span> <span class="keyword">implements</span> <span class="title">ObjectInput</span>,<span class="title">ObjectStreamConstants</span></span>;</span><br></pre></td></tr></table></figure>
<p>​		可以发现ObjectInputStream类实现了ObjectInput接口，提供了基本类型的输入方法。ObjectInputStream类的常用方法如下表所示。</p>
<table>
<thead>
<tr>
<th style="text-align:center">序号</th>
<th style="text-align:center">方法</th>
<th style="text-align:center">类型</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">puclic ObjectInputStream(InputStream in)throws IOException</td>
<td style="text-align:center">构造</td>
<td style="text-align:center">创建从指定InputStream读取的ObjectInputStream对象</td>
</tr>
<tr>
<td style="text-align:center"><strong>2</strong></td>
<td style="text-align:center"><strong>public final readObject()throws IOException,ClassNotFoundException</strong></td>
<td style="text-align:center"><strong>普通</strong></td>
<td style="text-align:center"><strong>从ObjectInputStream中读取对象</strong></td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">public Object readUnshared()throws IOException</td>
<td style="text-align:center">普通</td>
<td style="text-align:center">从ObjectInputStream读取&quot;非共享&quot;对象</td>
</tr>
</tbody>
</table>
<blockquote>
<p>提示：ObjectInputStream 类与其他输入流类一样，具有 available()、read()和 close()等方 法。详情可以查看 API 帮助文档。</p>
</blockquote>
<p>代码示例：(从文件中将对象反序列化)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span> <span class="keyword">implements</span> <span class="title">Serializable</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line">    <span class="keyword">private</span> String school;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Student</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Student</span><span class="params">(String name,<span class="keyword">int</span> age,String school)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name=name;</span><br><span class="line">        <span class="keyword">this</span>.age=age;</span><br><span class="line">        <span class="keyword">this</span>.school=school;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">tell</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;名字：&quot;</span>+name+<span class="string">&quot;\n年龄：&quot;</span>+age+<span class="string">&quot;\n学校：&quot;</span>+school);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        File file=<span class="keyword">new</span> File(<span class="string">&quot;Objectstudent.txt&quot;</span>);</span><br><span class="line">        FileInputStream fis=<span class="keyword">null</span>;</span><br><span class="line">        ObjectInputStream ois=<span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            fis=<span class="keyword">new</span> FileInputStream(file);</span><br><span class="line">            ois=<span class="keyword">new</span> ObjectInputStream(fis);</span><br><span class="line">            Student stu1=(Student)ois.readObject();		<span class="comment">//反序列化stu1对象</span></span><br><span class="line">            Student stu2=(Student)ois.readObject();		<span class="comment">//反序列化stu2对象</span></span><br><span class="line">            ois.close();		<span class="comment">//关闭输入流</span></span><br><span class="line">            stu1.tell();		<span class="comment">//调用tell()方法输出对象信息</span></span><br><span class="line">            stu2.tell();</span><br><span class="line">        &#125;<span class="keyword">catch</span>(Exception e)</span><br><span class="line">        	&#123;</span><br><span class="line">            	e.printStackTrace();</span><br><span class="line">        	&#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">名字：小强</span><br><span class="line">年龄：<span class="number">18</span></span><br><span class="line">学校：CUMT</span><br><span class="line">名字：小明</span><br><span class="line">年龄：<span class="number">19</span></span><br><span class="line">学校：WHU</span><br></pre></td></tr></table></figure>
<p>​		以上程序依次从文件读出了各个对象的数据。</p>
<blockquote>
<p>提示：前面使用对象的序列化和反序列化操作并不是最好的，仅在一些比较特殊的情况下使用，因为需要知道文件中对象的先后顺序，否则转换数据类型时将会出错。在更多的情况下会使用集合保存多个对象，然后再对集合中的对象进行序列化和反序列化操作。</p>
</blockquote>
<h3 id="externalizable接口"><a class="markdownIt-Anchor" href="#externalizable接口"></a> Externalizable接口</h3>
<p>​		java 序列化有两种实现方法，一种是在类定义的时候实现 Serializable 接口，另一种是实现 Externalizable 接口。实现了这两种接口类的对象，均可以完成对象的序列化和反序列化。被 Serializable 接口声明的类对象的内容都将被序列化。而 Externalizable 接口声明的类的对象可以选择需要序列化的内容。</p>
<p>​		但一般选择使用 Serializable 接口实现序列化，因为该接口不需要实现任何方法；而Externalizable 接口定义了 readExternal() 和 writeExternal() 方法，实现该接口的类必须要实现这两种方法。<strong>这两个方法会在序列化和反序列化还原的过程中被自动调用，以便执行一些特殊的操作。</strong></p>
<table>
<thead>
<tr>
<th style="text-align:center">序号</th>
<th style="text-align:center">方法</th>
<th style="text-align:center">类型</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">public void readExternal(ObjectInput in)</td>
<td style="text-align:center">抽象</td>
<td style="text-align:center">调用对象需要实现该方法，通过ObjectInput类的readObject方法来为对象、字符串、数组进行反序列化</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">public void writeExternal(ObjectOutput out)</td>
<td style="text-align:center">抽象</td>
<td style="text-align:center">调用对象需要实现该方法，通过ObjectOutput类的writeObject方法来为对象、字符串、数组进行序列化</td>
</tr>
</tbody>
</table>
<p>代码示例：(实现Externalizable接口)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.Externalizable;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectInput;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectOutput;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span> <span class="keyword">implements</span> <span class="title">Externalizable</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line">    <span class="keyword">private</span> String school;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Student</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Student</span><span class="params">(String name,<span class="keyword">int</span> age,String school)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name=name;</span><br><span class="line">        <span class="keyword">this</span>.age=age;</span><br><span class="line">        <span class="keyword">this</span>.school=school;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">tell</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;名字：&quot;</span>+name+<span class="string">&quot;\n年龄：&quot;</span>+age+<span class="string">&quot;\n学校：&quot;</span>+school);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">writeExternal</span><span class="params">(ObjectOutput out)</span><span class="keyword">throws</span> IOException</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        out.writeObject(<span class="keyword">this</span>.name);			<span class="comment">//序列化指定成员属性</span></span><br><span class="line">        out.writeObject(<span class="keyword">this</span>.school);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">readExternal</span><span class="params">(ObjectInput in)</span><span class="keyword">throws</span> IOException,ClassNotFountException</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name=(String)in.readObject();		<span class="comment">//反序列化指定成员属性</span></span><br><span class="line">        <span class="keyword">this</span>.school=(String)in.readObject();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>​		以上程序中，因为 Externalizable 接口含有 writeExternal()和 readExternal()方法，所以可以选择对象具体的属性进行序列化。例如，以上程序只对 name 属性和 school 属性序列化，而不对 age 属性序列化。<strong>但在程序设计中，一般为了程序的完整性和统一性，都会将属性全部保存起来。</strong></p>
<p>代码示例：(序列化与反序列化)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.Externalizable;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span> <span class="keyword">implements</span> <span class="title">Externalizable</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line">    <span class="keyword">private</span> String school;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Student</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Student</span><span class="params">(String name,<span class="keyword">int</span> age,String school)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name=name;</span><br><span class="line">        <span class="keyword">this</span>.age=age;</span><br><span class="line">        <span class="keyword">this</span>.school=school;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">tell</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;名字：&quot;</span>+name+<span class="string">&quot;\n年龄：&quot;</span>+age+<span class="string">&quot;\n学校：&quot;</span>+school);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">writeExternal</span><span class="params">(ObjectOutput out)</span><span class="keyword">throws</span> IOException</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        out.writeObject(<span class="keyword">this</span>.name);			<span class="comment">//序列化指定成员属性</span></span><br><span class="line">        out.writeObject(<span class="keyword">this</span>.school);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">readExternal</span><span class="params">(ObjectInput in)</span><span class="keyword">throws</span> IOException,ClassNotFountException</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name=(String)in.readObject();		<span class="comment">//反序列化指定成员属性</span></span><br><span class="line">        <span class="keyword">this</span>.school=(String)in.readObject();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">serialize</span><span class="params">(File file)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Student stu1=<span class="keyword">new</span> Student(<span class="string">&quot;小强&quot;</span>,<span class="number">18</span>,<span class="string">&quot;CUMT&quot;</span>);</span><br><span class="line">        Student stu2=<span class="keyword">new</span> Student(<span class="string">&quot;小明&quot;</span>,<span class="number">19</span>,<span class="string">&quot;WHU&quot;</span>);</span><br><span class="line">        FileOutputStream fout=<span class="keyword">null</span>;</span><br><span class="line">        ObjectOutputStream oos=<span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            fout=<span class="keyword">new</span> FileOutputStream(file);</span><br><span class="line">            oos=<span class="keyword">new</span> ObjectOutputStream(fout);</span><br><span class="line">            oos.writeObject(stu1);		<span class="comment">//序列化对象stu1</span></span><br><span class="line">            oos.writeObject(stu2);		<span class="comment">//序列化对象stu2</span></span><br><span class="line">            oos.close();</span><br><span class="line">        &#125;<span class="keyword">catch</span>(Exception e)</span><br><span class="line">        	&#123;</span><br><span class="line">            	e.printStackTrace();</span><br><span class="line">        	&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">deserialization</span><span class="params">(File file)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        FileInputStream fis=<span class="keyword">null</span>;</span><br><span class="line">        ObjectInputStream ois=<span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            fis=<span class="keyword">new</span> FileInputStream(file);</span><br><span class="line">            ois=<span class="keyword">new</span> ObjectInputStream(fis);</span><br><span class="line">            Student stu1=(Student)ois.readObject();		<span class="comment">//反序列化stu1对象</span></span><br><span class="line">            Student stu2=(Student)ois.readObject();		<span class="comment">//反序列化stu2对象</span></span><br><span class="line">            ois.close();		<span class="comment">//关闭输入流</span></span><br><span class="line">            stu1.tell();		<span class="comment">//调用tell()方法输出对象信息</span></span><br><span class="line">            stu2.tell();</span><br><span class="line">        &#125;<span class="keyword">catch</span>(Exception e)</span><br><span class="line">        	&#123;</span><br><span class="line">            	e.printStackTrace();</span><br><span class="line">        	&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        File file=<span class="keyword">new</span> File(<span class="string">&quot;Es.txt&quot;</span>);</span><br><span class="line">        serialize(file);		<span class="comment">//对象序列化</span></span><br><span class="line">        deserialization(file);		<span class="comment">//对象反序列化</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">名字：小强</span><br><span class="line">年龄：<span class="number">0</span></span><br><span class="line">学校：CUMT</span><br><span class="line">名字：小明</span><br><span class="line">年龄：<span class="number">0</span></span><br><span class="line">学校：WHU</span><br></pre></td></tr></table></figure>
<p>​		从程序运行结果可以发现，age 属性没有被序列化。</p>
<h3 id="transient-关键字"><a class="markdownIt-Anchor" href="#transient-关键字"></a> transient 关键字</h3>
<p>​		虽然 Externalizable 接口可以选择需要的属性序列化，但是其实现序列化的过程明显比使用 Serializable 接口复杂。为此 java 语言为我们提供了 transient 关键字，当使用 Serializable 接口实现序列化操作时，若不需要对某个对象的属性序列化，可以使用 transient 关键字进行声明。</p>
<p>代码示例：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span> <span class="keyword">implements</span> <span class="title">Serializable</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">transient</span> <span class="keyword">int</span> age;</span><br><span class="line">    <span class="keyword">private</span> String school;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Student</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Student</span><span class="params">(String name,<span class="keyword">int</span> age,String school)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name=name;</span><br><span class="line">        <span class="keyword">this</span>.age=age;</span><br><span class="line">        <span class="keyword">this</span>.school=school;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">tell</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;名字：&quot;</span>+name+<span class="string">&quot;\n年龄：&quot;</span>+age+<span class="string">&quot;\n学校：&quot;</span>+school);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">serialize</span><span class="params">(File file)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Student stu1=<span class="keyword">new</span> Student(<span class="string">&quot;小强&quot;</span>,<span class="number">18</span>,<span class="string">&quot;CUMT&quot;</span>);</span><br><span class="line">        Student stu2=<span class="keyword">new</span> Student(<span class="string">&quot;小明&quot;</span>,<span class="number">19</span>,<span class="string">&quot;WHU&quot;</span>);</span><br><span class="line">        FileOutputStream fout=<span class="keyword">null</span>;</span><br><span class="line">        ObjectOutputStream oos=<span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            fout=<span class="keyword">new</span> FileOutputStream(file);</span><br><span class="line">            oos=<span class="keyword">new</span> ObjectOutputStream(fout);</span><br><span class="line">            oos.writeObject(stu1);		<span class="comment">//序列化对象stu1</span></span><br><span class="line">            oos.writeObject(stu2);		<span class="comment">//序列化对象stu2</span></span><br><span class="line">            oos.close();</span><br><span class="line">        &#125;<span class="keyword">catch</span>(Exception e)</span><br><span class="line">        	&#123;</span><br><span class="line">            	e.printStackTrace();</span><br><span class="line">        	&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">deserialization</span><span class="params">(File file)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        FileInputStream fis=<span class="keyword">null</span>;</span><br><span class="line">        ObjectInputStream ois=<span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            fis=<span class="keyword">new</span> FileInputStream(file);</span><br><span class="line">            ois=<span class="keyword">new</span> ObjectInputStream(fis);</span><br><span class="line">            Student stu1=(Student)ois.readObject();		<span class="comment">//反序列化stu1对象</span></span><br><span class="line">            Student stu2=(Student)ois.readObject();		<span class="comment">//反序列化stu2对象</span></span><br><span class="line">            ois.close();		<span class="comment">//关闭输入流</span></span><br><span class="line">            stu1.tell();		<span class="comment">//调用tell()方法输出对象信息</span></span><br><span class="line">            stu2.tell();</span><br><span class="line">        &#125;<span class="keyword">catch</span>(Exception e)</span><br><span class="line">        	&#123;</span><br><span class="line">            	e.printStackTrace();</span><br><span class="line">        	&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        File file=<span class="keyword">new</span> File(<span class="string">&quot;st.txt&quot;</span>);</span><br><span class="line">        serialize(file);		<span class="comment">//对象序列化</span></span><br><span class="line">        deserialization(file);		<span class="comment">//对象反序列化</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">名字：小强</span><br><span class="line">年龄：<span class="number">0</span></span><br><span class="line">学校：CUMT</span><br><span class="line">名字：小明</span><br><span class="line">年龄：<span class="number">0</span></span><br><span class="line">学校：WHU</span><br></pre></td></tr></table></figure>
<p>​		从程序运行结果可以发现，age 属性为0，说明 age 属性没有被序列化保存下来。</p>
<p>参考书目：</p>
<p><a target="_blank" rel="noopener" href="http://product.dangdang.com/23248198.html?ref=book-35530-3032_5-231497-4">《Java编程手记——从实践中学习Java（配光盘）》(欧二强　等编著)【简介_书评_在线阅读】 - 当当图书 (dangdang.com)</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://silenthly.github.io/2021/08/02/%E5%8E%8B%E7%BC%A9%E6%B5%81/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="buyan">
      <meta itemprop="description" content="我见过真正难过的人，但他一滴泪也没流">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Buyan-Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/08/02/%E5%8E%8B%E7%BC%A9%E6%B5%81/" class="post-title-link" itemprop="url">压缩流</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-08-02 08:31:58" itemprop="dateCreated datePublished" datetime="2021-08-02T08:31:58+08:00">2021-08-02</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-09-04 18:16:44" itemprop="dateModified" datetime="2021-09-04T18:16:44+08:00">2021-09-04</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/java/" itemprop="url" rel="index"><span itemprop="name">java</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2021/08/02/%E5%8E%8B%E7%BC%A9%E6%B5%81/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2021/08/02/%E5%8E%8B%E7%BC%A9%E6%B5%81/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>​		在日常的使用中经常会使用到WinRAR或7-zip等压缩文件，通过这些软件可以把一个很大的文件进行压缩以方便运输。在java中为了减少传输时的数据量也提供了专门的压缩流，可以将文件或文件夹压缩成ZIP、JAP、GZIP等文件形式。在java中要实现ZIP的压缩需要导入java.util.zip包，该包中最经常使用的类有ZipEntry、ZipFile、ZipInputStream和ZipOutputStream。</p>
<h3 id="zipentry类"><a class="markdownIt-Anchor" href="#zipentry类"></a> ZipEntry类</h3>
<p>​		ZipEntry类的对象是用来表示ZIp文件条目，代表Zip文件内的进入点(entry)。ZipEntry类的常用方法如下表所示。</p>
<table>
<thead>
<tr>
<th style="text-align:center">序号</th>
<th style="text-align:center">方法</th>
<th style="text-align:center">类型</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><strong>1</strong></td>
<td style="text-align:center"><strong>public ZipEntry(String name)</strong></td>
<td style="text-align:center"><strong>构造</strong></td>
<td style="text-align:center"><strong>使用指定名称创建新的ZipEntry对象</strong></td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">public ZipEntry(ZipEntry e)</td>
<td style="text-align:center">构造</td>
<td style="text-align:center">建立一个实例内各字段皆由e参数指定的ZipEntry对象取得</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">public Object clone()</td>
<td style="text-align:center">方法</td>
<td style="text-align:center">返回此ZipEntry的副本</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:center">public String getComment()</td>
<td style="text-align:center">方法</td>
<td style="text-align:center">返回条目的注释字符，如果没有，则返回null</td>
</tr>
<tr>
<td style="text-align:center">5</td>
<td style="text-align:center">public long getCompressdSize()</td>
<td style="text-align:center">方法</td>
<td style="text-align:center">返回压缩条目数据的大小，如果未知，则返回-1</td>
</tr>
<tr>
<td style="text-align:center">6</td>
<td style="text-align:center">public long getCrc()</td>
<td style="text-align:center">方法</td>
<td style="text-align:center">返回此entry所指向的数在未压缩时的CRC-32校验和，如果未知，则返回-1</td>
</tr>
<tr>
<td style="text-align:center">7</td>
<td style="text-align:center">public byte[] getExtra()</td>
<td style="text-align:center">方法</td>
<td style="text-align:center">返回此entry的额外字段数据，如果没有，则返回null</td>
</tr>
<tr>
<td style="text-align:center">8</td>
<td style="text-align:center">public int getMethod()</td>
<td style="text-align:center">方法</td>
<td style="text-align:center">返回此entry的压缩方法，如果未指定，则返回-1</td>
</tr>
<tr>
<td style="text-align:center">9</td>
<td style="text-align:center">public String getName()</td>
<td style="text-align:center">方法</td>
<td style="text-align:center">返回此entry名称</td>
</tr>
<tr>
<td style="text-align:center">10</td>
<td style="text-align:center">public long getSize()</td>
<td style="text-align:center">方法</td>
<td style="text-align:center">返回此entry数据的未压缩大小，如果未知，则返回-1</td>
</tr>
<tr>
<td style="text-align:center">11</td>
<td style="text-align:center">public long getTime()</td>
<td style="text-align:center">方法</td>
<td style="text-align:center">返回此entry的修改时间，如果为指定，则返回-1</td>
</tr>
<tr>
<td style="text-align:center">12</td>
<td style="text-align:center">public int hashCode()</td>
<td style="text-align:center">方法</td>
<td style="text-align:center">返回此entry的哈希码值</td>
</tr>
<tr>
<td style="text-align:center">13</td>
<td style="text-align:center">public boolean isDirectory()</td>
<td style="text-align:center">方法</td>
<td style="text-align:center">判断此entry是否为目录，若是目录，则返回ture</td>
</tr>
<tr>
<td style="text-align:center">14</td>
<td style="text-align:center">public void setComment(String comment)</td>
<td style="text-align:center">方法</td>
<td style="text-align:center">设置此entry的注释字符</td>
</tr>
<tr>
<td style="text-align:center">15</td>
<td style="text-align:center">public void setComment(long csize)</td>
<td style="text-align:center">方法</td>
<td style="text-align:center">设置此entry所指的数据压缩后大小</td>
</tr>
<tr>
<td style="text-align:center">16</td>
<td style="text-align:center">public void setCrc()</td>
<td style="text-align:center">方法</td>
<td style="text-align:center">设置此entry所指的数据在未压缩前的CRC-32校验和</td>
</tr>
<tr>
<td style="text-align:center">17</td>
<td style="text-align:center">public void setMethod(int method)</td>
<td style="text-align:center">方法</td>
<td style="text-align:center">设置此entry的压缩方法</td>
</tr>
<tr>
<td style="text-align:center">18</td>
<td style="text-align:center">public void setTime()</td>
<td style="text-align:center">方法</td>
<td style="text-align:center">设置此entry的修改时间</td>
</tr>
<tr>
<td style="text-align:center">19</td>
<td style="text-align:center">public String toString()</td>
<td style="text-align:center">方法</td>
<td style="text-align:center">返回一个能代表ZipEntry对象的字符串</td>
</tr>
</tbody>
</table>
<h3 id="zipoutputstream类"><a class="markdownIt-Anchor" href="#zipoutputstream类"></a> ZipOutputStream类</h3>
<p>​		java.util.zip.ZipOutputStream类是FilterOutputStream的子类，用来写出zip文件，即可以将一个文件或文件夹压缩为一个zip文件，而且所支持的包括有压缩及未压缩的进入点(entry)。ZipOutputStream类的常用方法如下表所示。</p>
<table>
<thead>
<tr>
<th style="text-align:center">序号</th>
<th style="text-align:center">方法</th>
<th style="text-align:center">类型</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><strong>1</strong></td>
<td style="text-align:center"><strong>public ZipOutputStream(OutputStream out)</strong></td>
<td style="text-align:center"><strong>构造</strong></td>
<td style="text-align:center"><strong>创建新的zip输出流</strong></td>
</tr>
<tr>
<td style="text-align:center"><strong>2</strong></td>
<td style="text-align:center"><strong>public void close()</strong></td>
<td style="text-align:center"><strong>普通</strong></td>
<td style="text-align:center"><strong>关闭zip输出流和正在过滤的流</strong></td>
</tr>
<tr>
<td style="text-align:center"><strong>3</strong></td>
<td style="text-align:center"><strong>public void closeEntry() throws IOException</strong></td>
<td style="text-align:center"><strong>普通</strong></td>
<td style="text-align:center"><strong>关闭当前ZipEntry并让流内的内容指到适当的位置，以便定位写入下一个entry</strong></td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:center">public void finish()</td>
<td style="text-align:center">普通</td>
<td style="text-align:center">完成写入zip输出流的内容，但不关闭与其配合的OutputStream流</td>
</tr>
<tr>
<td style="text-align:center"><strong>5</strong></td>
<td style="text-align:center"><strong>public void putNextEntry(ZipEntry e) throws IOException</strong></td>
<td style="text-align:center"><strong>普通</strong></td>
<td style="text-align:center"><strong>开始写入新的ZipEntry并将流定位到entry数据的开始处，弱现在的entry没有结束，它将会被关闭。若压缩方法为被指定，将会采用默认的压缩方法。而且新的entry的时间未指定，则采用现在的时间</strong></td>
</tr>
<tr>
<td style="text-align:center"><strong>6</strong></td>
<td style="text-align:center"><strong>public void setComment(String comment)</strong></td>
<td style="text-align:center"><strong>普通</strong></td>
<td style="text-align:center"><strong>设置ZipEntry的注释文字</strong></td>
</tr>
<tr>
<td style="text-align:center">7</td>
<td style="text-align:center">public setLevel(int level)</td>
<td style="text-align:center">普通</td>
<td style="text-align:center">设定其压缩方法为ZipEntry.DEFLATED的所有entry的压缩程度，压缩程度介于0~9之间</td>
</tr>
<tr>
<td style="text-align:center">8</td>
<td style="text-align:center">public void setMethod(int Method)</td>
<td style="text-align:center">普通</td>
<td style="text-align:center">设置其后所有entry的默认压缩方法，为ZipInputStream.DEFLATED或ZipOutputStream.DEFLATED</td>
</tr>
<tr>
<td style="text-align:center"><strong>9</strong></td>
<td style="text-align:center"><strong>public void write(byte[] b,int off,int len) throws IOException</strong></td>
<td style="text-align:center"><strong>普通</strong></td>
<td style="text-align:center"><strong>将字节数组的某部分写入当前ZipEntry数据</strong></td>
</tr>
</tbody>
</table>
<h4 id="zipoutputstream压缩文件"><a class="markdownIt-Anchor" href="#zipoutputstream压缩文件"></a> ZipOutputStream压缩文件</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.zip.ZipEntry;</span><br><span class="line"><span class="keyword">import</span> java.util.zip.ZipOutputStream;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        File f1=<span class="keyword">new</span> File(<span class="string">&quot;D:\\myjava\\123.txt&quot;</span>);</span><br><span class="line">        File f2=<span class="keyword">new</span> File(<span class="string">&quot;D:\\myjava\\111.zip&quot;</span>);</span><br><span class="line">        <span class="keyword">byte</span> b[]=<span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</span><br><span class="line">        <span class="keyword">int</span> temp=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            FileInputStream fis=<span class="keyword">new</span> FileInputStream(f1);</span><br><span class="line">            FileOutputStream fout=<span class="keyword">new</span> FileOutputStream(f2);</span><br><span class="line">            ZipOutputStream zout=<span class="keyword">new</span> ZipOutputStream(fout);</span><br><span class="line">            zout.putNextEntry(<span class="keyword">new</span> ZipEntry(f1.getName()));		<span class="comment">//设置压缩条目的名字</span></span><br><span class="line">            zout.setComment(<span class="string">&quot;Use ZipOutputStream compression 123.txt&quot;</span>);		<span class="comment">//设置注释</span></span><br><span class="line">            <span class="keyword">while</span>((temp=fis.read(b))!=-<span class="number">1</span>)	<span class="comment">//读取内容</span></span><br><span class="line">            &#123;</span><br><span class="line">                zout.write(b,<span class="number">0</span>,temp);		<span class="comment">//输出压缩文件</span></span><br><span class="line">            &#125;</span><br><span class="line">            zout.close();</span><br><span class="line">            fout.close();</span><br><span class="line">            fis.close();</span><br><span class="line">            System.out.println(<span class="string">&quot;压缩成功！&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">catch</span>(IOException e)</span><br><span class="line">        &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;压缩失败！&quot;</span>);</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="zipoutputstream压缩文件夹"><a class="markdownIt-Anchor" href="#zipoutputstream压缩文件夹"></a> ZipOutputStream压缩文件夹</h4>
<p>​		ZipOutputStream类不仅可以压缩文件，还可以压缩文件夹，甚至可以方便地压缩多个文件。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.zip.ZipEntry;</span><br><span class="line"><span class="keyword">import</span> java.util.zip.ZipOutputStream;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        File f1=<span class="keyword">new</span> File(<span class="string">&quot;D:\\myjava\\111&quot;</span>);</span><br><span class="line">        File f2=<span class="keyword">new</span> File(<span class="string">&quot;D:\\myjava\\zip111.zip&quot;</span>);</span><br><span class="line">        String fileName[]=<span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">byte</span> b[]=<span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</span><br><span class="line">        <span class="keyword">int</span> temp=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            FileOutputStream fout=<span class="keyword">new</span> FileOutputStream(f2);</span><br><span class="line">            ZipOutputStream zout=<span class="keyword">new</span> ZipOutputStream(fout);</span><br><span class="line">            FileInputStream fis=<span class="keyword">null</span>;</span><br><span class="line">            zout.setComment(<span class="string">&quot;Use ZipOutputStream compression orgDirectory&quot;</span>);		<span class="comment">//设置注释</span></span><br><span class="line">            <span class="keyword">if</span>(f1.isDirectory())		<span class="comment">//判断是否为目录</span></span><br><span class="line">            &#123;</span><br><span class="line">                fileName=f1.list();		<span class="comment">//获取文件夹内所有文件或文件夹的名称</span></span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;fileName.length;i++)</span><br><span class="line">                &#123;</span><br><span class="line">                    fis=<span class="keyword">new</span> FileInputStream(fileName[i]);	<span class="comment">//在默认路径下读取文件</span></span><br><span class="line">                    zout.putNextEntry(<span class="keyword">new</span> ZipEntry(fileName[i]));</span><br><span class="line">                    System.out.println(<span class="string">&quot;正在压缩&quot;</span>+fileName[i]+<span class="string">&quot;.......&quot;</span>);</span><br><span class="line">                    <span class="keyword">while</span>((temp=fis.read(b))!=-<span class="number">1</span>)</span><br><span class="line">                    &#123;</span><br><span class="line">                        zout.write(b,<span class="number">0</span>,temp);</span><br><span class="line">                    &#125;</span><br><span class="line">                    System.out.println(<span class="string">&quot;压缩&quot;</span>+fileName[i]+<span class="string">&quot;完成&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            zout.close();</span><br><span class="line">            fout.close();</span><br><span class="line">            fis.close();</span><br><span class="line">            System.out.println(<span class="string">&quot;压缩成功！&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">catch</span>(IOException e)</span><br><span class="line">        &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;压缩失败！&quot;</span>);</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>​		以上程序，能且仅能压缩&quot;类路径&quot;下的文件(不包括文件夹)，若想要压缩类路径以外其他文件夹的文件或者压缩类路径下子目录的文件时，就会出现&quot;java.io.FileNotFoundException: XXX (系统找不到指定的文件。)&quot;的异常。原因是在创建读取文件流时，使用了文件名进行实例化，在读取文件时，系统在默认的“类路径”下寻找该文件并进行压缩，而当类路径中不存在该文件时，就会抛出异常。解决方法是在获取目录下的所有文件时，使用listFiles()返回文件的绝对路径名，由于listFiles()返回的是对象而不是字符串，所以接收数组类型也要更改为File。代码如下，注释部分为更改部分。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.zip.ZipEntry;</span><br><span class="line"><span class="keyword">import</span> java.util.zip.ZipOutputStream;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        File f1=<span class="keyword">new</span> File(<span class="string">&quot;D:\\CloudMusic&quot;</span>);</span><br><span class="line">        File f2=<span class="keyword">new</span> File(<span class="string">&quot;D:\\myjava\\zip111.zip&quot;</span>);</span><br><span class="line">        File fileName[]=<span class="keyword">null</span>;				<span class="comment">//创建对象数组</span></span><br><span class="line">        <span class="keyword">byte</span> b[]=<span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</span><br><span class="line">        <span class="keyword">int</span> temp=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            FileOutputStream fout=<span class="keyword">new</span> FileOutputStream(f2);</span><br><span class="line">            ZipOutputStream zout=<span class="keyword">new</span> ZipOutputStream(fout);</span><br><span class="line">            FileInputStream fis=<span class="keyword">null</span>;</span><br><span class="line">            zout.setComment(<span class="string">&quot;Use ZipOutputStream compression orgDirectory&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span>(f1.isDirectory())</span><br><span class="line">            &#123;</span><br><span class="line">                fileName=f1.listFiles();		<span class="comment">//获取文件夹内所有文件或文件夹的绝对路径</span></span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;fileName.length;i++)</span><br><span class="line">                &#123;</span><br><span class="line">                    fis=<span class="keyword">new</span> FileInputStream(fileName[i]);		<span class="comment">//在绝对路径中读取文件</span></span><br><span class="line">                    zout.putNextEntry(<span class="keyword">new</span> ZipEntry(fileName[i].getName()));	<span class="comment">//以该文件的名称设置为压缩后的文件条目名称</span></span><br><span class="line">                    System.out.println(<span class="string">&quot;正在压缩&quot;</span>+fileName[i]+<span class="string">&quot;.......&quot;</span>);</span><br><span class="line">                    <span class="keyword">while</span>((temp=fis.read(b))!=-<span class="number">1</span>)</span><br><span class="line">                    &#123;</span><br><span class="line">                        zout.write(b,<span class="number">0</span>,temp);</span><br><span class="line">                    &#125;</span><br><span class="line">                    System.out.println(<span class="string">&quot;压缩&quot;</span>+fileName[i]+<span class="string">&quot;完成&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            zout.close();</span><br><span class="line">            fout.close();</span><br><span class="line">            fis.close();</span><br><span class="line">            System.out.println(<span class="string">&quot;压缩成功！&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">catch</span>(IOException e)</span><br><span class="line">        &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;压缩失败！&quot;</span>);</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>​		以上程序，只能实现压缩目标文件夹内的文件，不能压缩子文件夹，那么如何把目标文件里的子文件夹也压缩了呢？代码如下所示。</p>
<h4 id="zipoutputstream压缩多层嵌套文件夹"><a class="markdownIt-Anchor" href="#zipoutputstream压缩多层嵌套文件夹"></a> ZipOutputStream压缩多层嵌套文件夹</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.zip.ZipEntry;</span><br><span class="line"><span class="keyword">import</span> java.util.zip.ZipOutputStream;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> SIZE=<span class="number">512</span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">compression</span><span class="params">(File file,ZipOutputStream zos,String name)</span><span class="keyword">throws</span> IOException</span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">	    <span class="keyword">if</span>(file.isDirectory())	<span class="comment">//如果路径为目录（文件夹）</span></span><br><span class="line">	    &#123;</span><br><span class="line">            File fileName[]=file.listFiles();	<span class="comment">//取出文件夹中的文件（或子文件夹）</span></span><br><span class="line">            <span class="keyword">if</span>(fileName==<span class="keyword">null</span>||fileName.length==<span class="number">0</span>)	<span class="comment">//如果文件夹为空，则只需在目的地zip文件中写入一个目录进入点</span></span><br><span class="line">         	&#123;</span><br><span class="line">                zos.putNextEntry(<span class="keyword">new</span> ZipEntry(name+<span class="string">&quot;/&quot;</span>));</span><br><span class="line">                zos.closeEntry();</span><br><span class="line">            &#125;<span class="keyword">else</span>	<span class="comment">//如果文件夹不为空，则递归调用compress，文件夹中的每一个文件（或文件夹）进行压缩</span></span><br><span class="line">      			&#123;</span><br><span class="line">          		    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;fileName.length;i++)</span><br><span class="line">                    &#123;</span><br><span class="line">                		compression(fileName[i],zos,name+<span class="string">&quot;/&quot;</span>+fileName[i].getName());</span><br><span class="line">            	    &#125;</span><br><span class="line">        	  	&#125;</span><br><span class="line"></span><br><span class="line">        &#125;<span class="keyword">else</span>		<span class="comment">//如果不是目录（文件夹），即为文件，则先写入目录进入点，之后将文件写入zip文件中</span></span><br><span class="line">    	    &#123;</span><br><span class="line">    	        <span class="keyword">byte</span> b[]=<span class="keyword">new</span> <span class="keyword">byte</span>[SIZE];</span><br><span class="line">	         	<span class="keyword">int</span> temp;</span><br><span class="line">            	zos.putNextEntry(<span class="keyword">new</span> ZipEntry(name));</span><br><span class="line">            	FileInputStream fis=<span class="keyword">new</span> FileInputStream(file);</span><br><span class="line">                System.out.println(<span class="string">&quot;正在压缩&quot;</span>+file+<span class="string">&quot;.......&quot;</span>);</span><br><span class="line">            	<span class="keyword">while</span>((temp=fis.read(b))!=-<span class="number">1</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    zos.write(b,<span class="number">0</span>,temp);</span><br><span class="line">                &#125;</span><br><span class="line">                System.out.println(<span class="string">&quot;压缩&quot;</span>+file+<span class="string">&quot;完成&quot;</span>);</span><br><span class="line">            	zos.closeEntry();</span><br><span class="line">            	fis.close();</span><br><span class="line">        	&#125;</span><br><span class="line">	&#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            File f1=<span class="keyword">new</span> File(<span class="string">&quot;D:/myjava/org&quot;</span>);		<span class="comment">//源文件（带压缩的文件或文件夹）</span></span><br><span class="line">            File f2=<span class="keyword">new</span> File(<span class="string">&quot;D:/myjava/org.zip&quot;</span>);  <span class="comment">//目的地Zip文件</span></span><br><span class="line">            FileOutputStream fout=<span class="keyword">new</span> FileOutputStream(f2);</span><br><span class="line">            ZipOutputStream zos=<span class="keyword">new</span> ZipOutputStream(fout);		<span class="comment">//创建zip输出流</span></span><br><span class="line">            compression(f1,zos,f1.getName());	<span class="comment">//调用函数</span></span><br><span class="line">            zos.close();</span><br><span class="line">            fout.close();</span><br><span class="line">            System.out.println(<span class="string">&quot;压缩成功！&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">catch</span>(IOException e)</span><br><span class="line">        	&#123;</span><br><span class="line">            	System.out.println(<span class="string">&quot;压缩终止！&quot;</span>);</span><br><span class="line">            	e.printStackTrace();</span><br><span class="line">        	&#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="zipinputstream类"><a class="markdownIt-Anchor" href="#zipinputstream类"></a> ZipInputStream类</h3>
<p>​		ZipInputStream类是FilterInputStream的子类，通过此类可以方便的读取zip压缩格式的文件，而且支持用压缩或没有压缩的进入点(entry)。ZipInputStream类的常用方法如下表所示。</p>
<table>
<thead>
<tr>
<th style="text-align:center">序号</th>
<th style="text-align:center">方法</th>
<th style="text-align:center">类型</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><strong>1</strong></td>
<td style="text-align:center"><strong>public ZipInputStream(InputStream in)</strong></td>
<td style="text-align:center"><strong>构造</strong></td>
<td style="text-align:center"><strong>创建新的ZipInputStream输入流</strong></td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">public int avaliable() throws IOException</td>
<td style="text-align:center">普通</td>
<td style="text-align:center">判断是否读完当前的entry所指的数据。若读取完毕(EOF)，则返回0，否则返回1</td>
</tr>
<tr>
<td style="text-align:center"><strong>3</strong></td>
<td style="text-align:center"><strong>public close() throws IOException</strong></td>
<td style="text-align:center"><strong>普通</strong></td>
<td style="text-align:center"><strong>关闭zip输入流并释放与此流关联的所有系统资源</strong></td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:center">public void closeEntry() throws IOException</td>
<td style="text-align:center">普通</td>
<td style="text-align:center">关闭当前ZipEntry并定位流以备读取下一个entry</td>
</tr>
<tr>
<td style="text-align:center">5</td>
<td style="text-align:center">public protected ZipEntry createZipEntry(String name)</td>
<td style="text-align:center">普通</td>
<td style="text-align:center">创建一个指定名称为name的新ZipEntry对象</td>
</tr>
<tr>
<td style="text-align:center"><strong>6</strong></td>
<td style="text-align:center"><strong>public ZipEntry  getNextEntry()</strong></td>
<td style="text-align:center"><strong>普通</strong></td>
<td style="text-align:center"><strong>读取下一个ZipEntry 并将流定位到该entry所指示数据的开始处</strong></td>
</tr>
<tr>
<td style="text-align:center"><strong>7</strong></td>
<td style="text-align:center"><strong>public int read(byte[] ,int off,int len) throws IOException</strong></td>
<td style="text-align:center"><strong>普通</strong></td>
<td style="text-align:center"><strong>从当前ZipEntry 读入字节数据</strong></td>
</tr>
<tr>
<td style="text-align:center">8</td>
<td style="text-align:center">public long skip(long n) throws IOException</td>
<td style="text-align:center">普通</td>
<td style="text-align:center">跳过当前ZipEntry中指定的n个字节数</td>
</tr>
</tbody>
</table>
<p>​		使用ZipInputStream类可以将zip压缩格式的文件解压缩。需要注意的是，若需要解压缩的zip文件本身含有文件夹，在解压前，应根据zip文件中的文件夹的名称，在相应的磁盘位置创建一个对应的文件夹。</p>
<h4 id="zipinputstream类解压缩"><a class="markdownIt-Anchor" href="#zipinputstream类解压缩"></a> ZipInputStream类解压缩</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.zip.ZipEntry;</span><br><span class="line"><span class="keyword">import</span> java.util.zip.ZipInputStream;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        File dirf=<span class="keyword">new</span> File(<span class="string">&quot;D:/myjava&quot;</span>);		<span class="comment">//压缩文件存放的目录</span></span><br><span class="line">        File zipf=<span class="keyword">new</span> File(<span class="string">&quot;D:/myjava/org.zip&quot;</span>);	<span class="comment">//需要解压的zip文件</span></span><br><span class="line">        <span class="keyword">byte</span> b[]=<span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">512</span>];</span><br><span class="line">        <span class="keyword">int</span> temp=<span class="number">0</span>;</span><br><span class="line">        ZipEntry z=<span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            ZipInputStream zin=<span class="keyword">new</span> ZipInputStream(<span class="keyword">new</span> FileInputStream(zipf));</span><br><span class="line">            <span class="keyword">while</span>((z=zin.getNextEntry())!=<span class="keyword">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;正在解压缩&quot;</span>+z.getName()+<span class="string">&quot;......&quot;</span>);</span><br><span class="line">                File f=<span class="keyword">new</span> File(dirf+File.separator+z.getName());</span><br><span class="line">                <span class="keyword">if</span>(z.isDirectory())		<span class="comment">//判断该ZipEntry对象是否为目录</span></span><br><span class="line">                &#123;</span><br><span class="line">                    f.mkdirs();			<span class="comment">//每次都貌似从最底层开始遍历的</span></span><br><span class="line">                &#125;<span class="keyword">else</span></span><br><span class="line">                	&#123;</span><br><span class="line">                    	<span class="keyword">if</span>(!f.getParentFile().exists())		<span class="comment">//检查父类路径是否存在</span></span><br><span class="line">                        &#123;</span><br><span class="line">                            f.getParentFile().mkdirs();		<span class="comment">//创建父类路径</span></span><br><span class="line">                        &#125;</span><br><span class="line">                    	FileOutputStream fout=<span class="keyword">new</span> FileOutputStream(f);</span><br><span class="line">                    	<span class="keyword">while</span>((temp=zin.read(b))!=-<span class="number">1</span>)	<span class="comment">//读取内容</span></span><br><span class="line">                        &#123;</span><br><span class="line">                            fout.write(b,<span class="number">0</span>,temp);</span><br><span class="line">                        &#125;</span><br><span class="line">                    	fout.close();</span><br><span class="line">                	&#125;</span><br><span class="line">                System.out.println(<span class="string">&quot;解压缩&quot;</span>+z.getName()+<span class="string">&quot;完成！&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            zin.close();</span><br><span class="line">            System.out.println(<span class="string">&quot;解压成功！&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">catch</span>(IOException e)</span><br><span class="line">        &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;解压中止！&quot;</span>);</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>​		上面的程序中，只有在创建文件时才需检测存放解压文件的目录是否存在，仅有空目录时，若此目录的父目录不存在，mkdirs()会自动创建父目录。需要注意的是，实际上getNextEntry()似乎每次都是从底层开始读取的，所以在有文件的文件夹中，不会先检测到目录，而是先检测到目录中的文件，所以此时需先创建目录再进行读取，否则会出现系统找不到指定的路径的异常。</p>
<h3 id="zipfile类"><a class="markdownIt-Anchor" href="#zipfile类"></a> ZipFile类</h3>
<p>​		ZipFile类可以表示一个压缩文件，用来读取一个zip文件含有的文件的进入点，还可以取得某个进入点对应文件的输入流，ZipFile类的常用方法如下表所示。</p>
<table>
<thead>
<tr>
<th style="text-align:center">序号</th>
<th style="text-align:center">方法</th>
<th style="text-align:center">类型</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">public ZipFile(File file)throws IOException</td>
<td style="text-align:center">构造</td>
<td style="text-align:center">在给定指定的File对象的情况下打开ZIP文件以进行读取</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">public ZipFile(File file,int mode) throws IOException</td>
<td style="text-align:center">构造</td>
<td style="text-align:center">打开新的 ZipFile以从指定模式下的指定File对象读取</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">public ZipFile(String name) throws IOException</td>
<td style="text-align:center">构造</td>
<td style="text-align:center">打开ZipFile进行阅读，由name参数指定的对象</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:center">public void close() throws IOException</td>
<td style="text-align:center">普通</td>
<td style="text-align:center">关闭ZipFile</td>
</tr>
<tr>
<td style="text-align:center">5</td>
<td style="text-align:center">public Enumeration&lt;? extends ZipEntry&gt; entries()</td>
<td style="text-align:center">普通</td>
<td style="text-align:center">返回zip文件内所有的entry枚举对象</td>
</tr>
<tr>
<td style="text-align:center">6</td>
<td style="text-align:center">public void finalize() throws IOException</td>
<td style="text-align:center">普通</td>
<td style="text-align:center">确保在没有对此ZipFile对象的引用时释放此ZipFile对象所拥有的系统资源。</td>
</tr>
<tr>
<td style="text-align:center">7</td>
<td style="text-align:center">public ZipEntry getEntry(String name)</td>
<td style="text-align:center">普通</td>
<td style="text-align:center">返回指定名称的zip文件条目，如果未找到，则返回null</td>
</tr>
<tr>
<td style="text-align:center"><strong>8</strong></td>
<td style="text-align:center"><strong>public InputStream getInputStream(ZipEntry entry) throws IOException</strong></td>
<td style="text-align:center"><strong>普通</strong></td>
<td style="text-align:center"><strong>返回用于读取指定zip文件条目内容的输入流</strong></td>
</tr>
<tr>
<td style="text-align:center">9</td>
<td style="text-align:center">public String getName()</td>
<td style="text-align:center">普通</td>
<td style="text-align:center">返回ZIP文件的路径名</td>
</tr>
<tr>
<td style="text-align:center">10</td>
<td style="text-align:center">public int size()</td>
<td style="text-align:center">普通</td>
<td style="text-align:center">返回ZIP文件中的条目(entry)数</td>
</tr>
</tbody>
</table>
<h4 id="获取zip文件的属性"><a class="markdownIt-Anchor" href="#获取zip文件的属性"></a> 获取zip文件的属性</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.util.zip.ZipFile;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        File f=<span class="keyword">new</span> File(<span class="string">&quot;D:/myjava/org.zip&quot;</span>);</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            ZipFile zip=<span class="keyword">new</span> ZipFile(f);</span><br><span class="line">            System.out.println(<span class="string">&quot;文件名称：&quot;</span>+zip.getName());</span><br><span class="line">            System.out.println(<span class="string">&quot;压缩文件内文件数：&quot;</span>+zip.size());</span><br><span class="line">            System.out.println(<span class="string">&quot;文件大小：&quot;</span>+f.length());</span><br><span class="line">            System.out.println(<span class="string">&quot;文件最后修改时间&quot;</span>+f.lastModified());</span><br><span class="line">            zip.close();</span><br><span class="line">        &#125;<span class="keyword">catch</span>(IOException e)</span><br><span class="line">        	&#123;</span><br><span class="line">            	e.printStackTrace();</span><br><span class="line">        	&#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">文件名称：D:\myjava\org.zip</span><br><span class="line">压缩文件内文件数：<span class="number">3</span></span><br><span class="line">文件大小：<span class="number">5696834</span></span><br><span class="line">文件最后修改时间<span class="number">1628423124341</span></span><br></pre></td></tr></table></figure>
<h4 id="zipfile类读取zip中指定文件"><a class="markdownIt-Anchor" href="#zipfile类读取zip中指定文件"></a> ZipFile类读取zip中指定文件</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.zip.ZipEntry;</span><br><span class="line"><span class="keyword">import</span> java.util.zip.ZipFile;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        File f=<span class="keyword">new</span> File(<span class="string">&quot;D:/myjava/z123.txt&quot;</span>);		<span class="comment">//自定义解压缩文件</span></span><br><span class="line">        File zipf=<span class="keyword">new</span> File(<span class="string">&quot;D:/myjava/org.zip&quot;</span>);	<span class="comment">//需要解压的zip文件</span></span><br><span class="line">        <span class="keyword">int</span> temp=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">byte</span> b[]=<span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">512</span>];</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            ZipFile zip=<span class="keyword">new</span> ZipFile(zipf);		<span class="comment">//zip对象表示该压缩文件</span></span><br><span class="line">            ZipEntry z=<span class="keyword">new</span> ZipEntry(<span class="string">&quot;org/123.txt&quot;</span>);		<span class="comment">//以zip文件内指定文件的进入点创建对象</span></span><br><span class="line">            InputStream in=zip.getInputStream(z);		<span class="comment">//从压缩文件中读取指定文件的进入点</span></span><br><span class="line">            FileOutputStream fout=<span class="keyword">new</span> FileOutputStream(f);		<span class="comment">//创建输出流</span></span><br><span class="line">            <span class="keyword">while</span>((temp=in.read(b))!=-<span class="number">1</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                fout.write(b,<span class="number">0</span>,temp);</span><br><span class="line">            &#125;</span><br><span class="line">            zip.close();</span><br><span class="line">            fout.close();</span><br><span class="line">        &#125;<span class="keyword">catch</span>(IOException e)</span><br><span class="line">        	&#123;</span><br><span class="line">            	e.printStackTrace();</span><br><span class="line">        	&#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>​		以上程序，只能适用于给定ZipEntry对象的情况。如果文件中含有多个文件夹或多个ZipEntry时，实用性不强。但是与ZipInputStream相比，其用于读取zip文件中的某一个文件会更加合适。</p>
<p>参考链接：</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/Ltp_zy/article/details/100035190">Zip条目_Ltp_zy的博客-CSDN博客</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/Ustinian0/article/details/109359455">java.io.FileNotFoundException: student.txt (系统找不到指定的文件。)_Ustinian0的博客-CSDN博客</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/zeng1994/p/7862288.html">Java实现将文件或者文件夹压缩成zip - zeng1994 - 博客园 (cnblogs.com)</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/qingergege/p/5768376.html">Java Zip压缩实现 - 青儿哥哥 - 博客园 (cnblogs.com)</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/iteye_2699/article/details/81816581?spm=3001.4430">java 解压缩ZIP文件方法_AresYM-CSDN博客</a></p>
<p>参考书目：</p>
<p><a target="_blank" rel="noopener" href="http://product.dangdang.com/23248198.html?ref=book-35530-3032_5-231497-4">《Java编程手记——从实践中学习Java（配光盘）》(欧二强　等编著)【简介_书评_在线阅读】 - 当当图书 (dangdang.com)</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://silenthly.github.io/2021/08/01/%E9%9A%8F%E6%9C%BA%E8%AE%BF%E9%97%AE%E6%96%87%E4%BB%B6%E7%B1%BB%EF%BC%9ARandomAccessFile%E7%B1%BB/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="buyan">
      <meta itemprop="description" content="我见过真正难过的人，但他一滴泪也没流">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Buyan-Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/08/01/%E9%9A%8F%E6%9C%BA%E8%AE%BF%E9%97%AE%E6%96%87%E4%BB%B6%E7%B1%BB%EF%BC%9ARandomAccessFile%E7%B1%BB/" class="post-title-link" itemprop="url">随机访问文件类：RandomAccessFile类</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-08-01 21:39:22" itemprop="dateCreated datePublished" datetime="2021-08-01T21:39:22+08:00">2021-08-01</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-08-13 12:55:56" itemprop="dateModified" datetime="2021-08-13T12:55:56+08:00">2021-08-13</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/java/" itemprop="url" rel="index"><span itemprop="name">java</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2021/08/01/%E9%9A%8F%E6%9C%BA%E8%AE%BF%E9%97%AE%E6%96%87%E4%BB%B6%E7%B1%BB%EF%BC%9ARandomAccessFile%E7%B1%BB/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2021/08/01/%E9%9A%8F%E6%9C%BA%E8%AE%BF%E9%97%AE%E6%96%87%E4%BB%B6%E7%B1%BB%EF%BC%9ARandomAccessFile%E7%B1%BB/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>​		java.io.RandomAccessFile类不属于流，是Object的子类，但它融合了流类InputStream和OutputStream的功能，既提供InputStream类似的read()方法，又提供与OutputStream类似的write()方法，还提供更高级的直接读写各种基本数据类型的读写方法，例如readInt()个writeInt()等。</p>
<p>​		RandomAccessFile类的中文翻译是随机访问文件类，但是实际含义是“任意访问文件类”。因为随机不具有确定性，而RandomAccessFile类有明确的读写位置。RandomAccessFile类不需要从头读到尾，可以从文件的任意位置开始访问文件，这是其他“流”类的不同之处。</p>
<p>​		为支持读写，RandomAccessFile类将文件内容存储在一个大型的byte数据中。RandomAccessFile设置指向该隐含的B数组的索引，称为文件指针，通过从文件开头就开始计算的偏移量来计算当前读写的位置。RandomAccessFile类的常用方法如下表所示。</p>
<table>
<thead>
<tr>
<th style="text-align:center">序号</th>
<th style="text-align:center">方法</th>
<th style="text-align:center">类型</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><strong>1</strong></td>
<td style="text-align:center"><strong>public RandomAccessFile(File file,String mode)</strong></td>
<td style="text-align:center"><strong>构造</strong></td>
<td style="text-align:center"><strong>访问file参数指定的文件，访问的形式由mode参数指定</strong></td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">public RandomAccessFile(String name,String mode)</td>
<td style="text-align:center">构造</td>
<td style="text-align:center">访问name参数指定的文件，访问的形式由mode参数指定</td>
</tr>
<tr>
<td style="text-align:center"><strong>3</strong></td>
<td style="text-align:center"><strong>public void close() throws IOException</strong></td>
<td style="text-align:center"><strong>普通</strong></td>
<td style="text-align:center"><strong>关闭此随机存取文件流并释放与该流关联的所有系统资源</strong></td>
</tr>
<tr>
<td style="text-align:center"><strong>4</strong></td>
<td style="text-align:center"><strong>public long length() throws IOException</strong></td>
<td style="text-align:center"><strong>普通</strong></td>
<td style="text-align:center"><strong>返回指定文件的长度</strong></td>
</tr>
<tr>
<td style="text-align:center">5</td>
<td style="text-align:center">public int read() throws IOException</td>
<td style="text-align:center">普通</td>
<td style="text-align:center">从指定文件的当前的指针位置读取一个数据字节</td>
</tr>
<tr>
<td style="text-align:center">6</td>
<td style="text-align:center">public int read(byte[] b) throws IOException</td>
<td style="text-align:center">普通</td>
<td style="text-align:center">一次读取多个字节，读取的长度为byte数组b的长度，将读取的内容存放在byte数组中</td>
</tr>
<tr>
<td style="text-align:center"><strong>7</strong></td>
<td style="text-align:center"><strong>public byte readByte()throws IOException</strong></td>
<td style="text-align:center"><strong>普通</strong></td>
<td style="text-align:center"><strong>从指定文件读取一个字节，即一个有符号的八位值，可更换为其他类型</strong></td>
</tr>
<tr>
<td style="text-align:center">8</td>
<td style="text-align:center">public String readLine()throws IOException</td>
<td style="text-align:center">普通</td>
<td style="text-align:center">从此文件读取文本的下一行</td>
</tr>
<tr>
<td style="text-align:center">9</td>
<td style="text-align:center">public String readUTF()throws IOException</td>
<td style="text-align:center">普通</td>
<td style="text-align:center">从指定文件读取一个字符串</td>
</tr>
<tr>
<td style="text-align:center"><strong>10</strong></td>
<td style="text-align:center"><strong>public void seek(long pos)throws IOException</strong></td>
<td style="text-align:center"><strong>普通</strong></td>
<td style="text-align:center"><strong>指定从文件起始位置开始的指针偏移量</strong></td>
</tr>
<tr>
<td style="text-align:center">11</td>
<td style="text-align:center">public int skipByte(int n)throws IOException</td>
<td style="text-align:center">普通</td>
<td style="text-align:center">指针跳过输入的n个字节</td>
</tr>
<tr>
<td style="text-align:center">12</td>
<td style="text-align:center">public void write(byte[] b)throws IOException</td>
<td style="text-align:center">普通</td>
<td style="text-align:center">在指定文件的当前指针位置写入多个字节，写入的长度为byte数组b的长度</td>
</tr>
<tr>
<td style="text-align:center">13</td>
<td style="text-align:center">public void write(int b)throws IOException</td>
<td style="text-align:center">普通</td>
<td style="text-align:center">向指定文件写入指定的字节</td>
</tr>
<tr>
<td style="text-align:center">14</td>
<td style="text-align:center">public void writeBytes(String s)throws IOException</td>
<td style="text-align:center">普通</td>
<td style="text-align:center">按字节序列将该字符串写入该文件</td>
</tr>
<tr>
<td style="text-align:center"><strong>15</strong></td>
<td style="text-align:center"><strong>public void writeInt(int v)throws IOException</strong></td>
<td style="text-align:center"><strong>普通</strong></td>
<td style="text-align:center"><strong>按4个字节将int写入该文件，先写高字节</strong></td>
</tr>
<tr>
<td style="text-align:center"><strong>16</strong></td>
<td style="text-align:center"><strong>public void writeUTF(String str)throws IOException</strong></td>
<td style="text-align:center"><strong>普通</strong></td>
<td style="text-align:center"><strong>使用modified UTF-8编码以与机器无关的方式将一个字符串写入指定文件</strong></td>
</tr>
</tbody>
</table>
<p>​		以上构造方法中，第一个参数指定了文件，第二个参数mode用于指定访问模式，可使用的模式如下表所示。</p>
<table>
<thead>
<tr>
<th style="text-align:center">序号</th>
<th style="text-align:center">参考值</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">“r”</td>
<td style="text-align:center">以只读的方式打开文件。调用结果对象的任何write()方法都会导致抛出IOException异常</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">“rw”</td>
<td style="text-align:center">用读写方式打开文件。如果文件不存在，则尝试创建该文件</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">“rws”</td>
<td style="text-align:center">用读写方式打开文件。相对于rw，还要求对文件的内容或元数据的每一个更新都同步写入到底层存储设备</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:center">“rwd”</td>
<td style="text-align:center">用读写方式打开文件。相对于rw，还要求文件内容的每一个更新都同步写入到底层存储设备</td>
</tr>
</tbody>
</table>
<h4 id="randomaccessfile写入文件"><a class="markdownIt-Anchor" href="#randomaccessfile写入文件"></a> RandomAccessFile写入文件</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.RandomAccessFile;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        File f=<span class="keyword">new</span> File(<span class="string">&quot;D:\\myjava\\测试.txt&quot;</span>);</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            RandomAccessFile raf=<span class="keyword">new</span> RandomAccessFile(f,<span class="string">&quot;rw&quot;</span>);</span><br><span class="line">            raf.writeUTF(<span class="string">&quot;中国共产党成立&quot;</span>);</span><br><span class="line">            raf.writeInt(<span class="number">100</span>);</span><br><span class="line">            raf.writeChar(<span class="string">&#x27;周&#x27;</span>);</span><br><span class="line">            raf.writeChar(<span class="string">&#x27;年&#x27;</span>);</span><br><span class="line">            raf.close();</span><br><span class="line">            System.out.println(<span class="string">&quot;写入成功！&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">catch</span>(IOException e)</span><br><span class="line">        &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>​		以上程序生成的文件，在打开时发现很多是乱码的，原因在于一部分方法是以二进制的表示写入文件，如writeInt()，<a target="_blank" rel="noopener" href="https://www.oschina.net/question/2626178_2154514">点击此处</a>了解。</p>
<h4 id="randomaccessfile类随机读取"><a class="markdownIt-Anchor" href="#randomaccessfile类随机读取"></a> RandomAccessFile类随机读取</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.RandomAccessFile;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        File f=<span class="keyword">new</span> File(<span class="string">&quot;D:\\myjava\\测试.txt&quot;</span>);</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            RandomAccessFile raf=<span class="keyword">new</span> RandomAccessFile(f,<span class="string">&quot;rw&quot;</span>);</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">10</span>;i++)		<span class="comment">//写入int类型数字0~9</span></span><br><span class="line">            &#123;</span><br><span class="line">                raf.writeInt(i);</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println(<span class="string">&quot;当前指针位置：&quot;</span>+raf.getFilePointer());</span><br><span class="line">            System.out.println(<span class="string">&quot;文件长度：&quot;</span>+raf.length()+<span class="string">&quot;字节&quot;</span>);</span><br><span class="line">            raf.seek(<span class="number">0</span>);		<span class="comment">//使指针指向文件开头</span></span><br><span class="line">            System.out.println(<span class="string">&quot;当前指针位置：&quot;</span>+raf.getFilePointer());</span><br><span class="line">            System.out.println(<span class="string">&quot;读取数据&quot;</span>);</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">6</span>;i++)</span><br><span class="line">            &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;数值：&quot;</span>+raf.readInt()+<span class="string">&quot;---&gt;对应指针&quot;</span>+raf.getFilePointer());</span><br><span class="line">                <span class="keyword">if</span>(i==<span class="number">3</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    raf.seek(<span class="number">32</span>);		<span class="comment">//指针跳过32个字节，即4个int类型数据4、5、6、7</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">catch</span>(IOException e)</span><br><span class="line">        &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">当前指针位置：<span class="number">40</span></span><br><span class="line">文件长度：<span class="number">40</span>字节</span><br><span class="line">当前指针位置：<span class="number">0</span></span><br><span class="line">读取数据</span><br><span class="line">数值：<span class="number">0</span>---&gt;对应指针<span class="number">4</span></span><br><span class="line">数值：<span class="number">1</span>---&gt;对应指针<span class="number">8</span></span><br><span class="line">数值：<span class="number">2</span>---&gt;对应指针<span class="number">12</span></span><br><span class="line">数值：<span class="number">3</span>---&gt;对应指针<span class="number">16</span></span><br><span class="line">数值：<span class="number">8</span>---&gt;对应指针<span class="number">36</span></span><br><span class="line">数值：<span class="number">9</span>---&gt;对应指针<span class="number">40</span></span><br></pre></td></tr></table></figure>
<p>​		以上程序中，先向文件写入0~9。此时文件长度为40字节，数据指针位置为40。若要读取文件的数据，则需要将指针移到文件的起始位置，执行seek(0)即可。虽然开始时会循环读取数据，但在i=3时，将指针移到32，即跳过4、5、6、7，直接开始读取8和9。</p>
<p>参考链接：</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/1130136248wlxk/articles/5109331.html">使用RandomAccessFile类-解决readLine乱码问题 - 1130136248 - 博客园 (cnblogs.com)</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/xudong-bupt/archive/2013/04/20/3028980.html">Java对文件的读、写随机访问，RandomAccessFile类的使用分析 - 旭东的博客 - 博客园 (cnblogs.com)</a></p>
<p>参考书目：</p>
<p><a target="_blank" rel="noopener" href="http://product.dangdang.com/23248198.html?ref=book-35530-3032_5-231497-4">《Java编程手记——从实践中学习Java（配光盘）》(欧二强　等编著)【简介_书评_在线阅读】 - 当当图书 (dangdang.com)</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://silenthly.github.io/2021/08/01/Scanner%E7%B1%BB/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="buyan">
      <meta itemprop="description" content="我见过真正难过的人，但他一滴泪也没流">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Buyan-Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/08/01/Scanner%E7%B1%BB/" class="post-title-link" itemprop="url">Scanner类</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-08-01 15:44:52" itemprop="dateCreated datePublished" datetime="2021-08-01T15:44:52+08:00">2021-08-01</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-09-10 01:01:31" itemprop="dateModified" datetime="2021-09-10T01:01:31+08:00">2021-09-10</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/java/" itemprop="url" rel="index"><span itemprop="name">java</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2021/08/01/Scanner%E7%B1%BB/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2021/08/01/Scanner%E7%B1%BB/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="scanner类简介"><a class="markdownIt-Anchor" href="#scanner类简介"></a> Scanner类简介</h3>
<p>​		java.util.Scanner类是JDK1.5以后新增的类，既是一个用于扫描输入文本的实用程序，也是使用正则表达式来分析基本类型和字符串的简单文本扫描器。除了能使用正则表达式之外，Scanner类还可以任意的对字符串和基本类型的数据进行分析。Scanner类的常用方法如下表所示。</p>
<table>
<thead>
<tr>
<th style="text-align:center">序号</th>
<th style="text-align:center">方法</th>
<th style="text-align:center">类型</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><strong>1</strong></td>
<td style="text-align:center"><strong>public Scanner(File source)</strong></td>
<td style="text-align:center"><strong>构造</strong></td>
<td style="text-align:center"><strong>构造一个新的Scanner类对象，从指定文件获取内容</strong></td>
</tr>
<tr>
<td style="text-align:center"><strong>2</strong></td>
<td style="text-align:center"><strong>public Scanner(InputStream source)</strong></td>
<td style="text-align:center"><strong>构造</strong></td>
<td style="text-align:center"><strong>构造一个新的Scanner类对象，从指定输入流获取内容</strong></td>
</tr>
<tr>
<td style="text-align:center"><strong>3</strong></td>
<td style="text-align:center"><strong>public boolean hasNext(Pattern pattern)</strong></td>
<td style="text-align:center"><strong>普通</strong></td>
<td style="text-align:center"><strong>判断输入的数据是否符合指定的正则式，若符合，则返回ture，否则返回false</strong></td>
</tr>
<tr>
<td style="text-align:center"><strong>4</strong></td>
<td style="text-align:center"><strong>public boolean hasNextInt()</strong></td>
<td style="text-align:center"><strong>普通</strong></td>
<td style="text-align:center"><strong>判断输入的数据是否为int值，若符合，则返回ture，否则返回false</strong></td>
</tr>
<tr>
<td style="text-align:center">5</td>
<td style="text-align:center">public boolean hasNextLine()</td>
<td style="text-align:center">普通</td>
<td style="text-align:center">判断输入的数据是否还有下一行(包括空行)，若有，则返回ture，否则返回false</td>
</tr>
<tr>
<td style="text-align:center"><strong>6</strong></td>
<td style="text-align:center"><strong>public String next()</strong></td>
<td style="text-align:center"><strong>普通</strong></td>
<td style="text-align:center"><strong>接收输入内容，不能读取空白符及其后的数据</strong></td>
</tr>
<tr>
<td style="text-align:center"><strong>7</strong></td>
<td style="text-align:center"><strong>public int nextInt()</strong></td>
<td style="text-align:center"><strong>普通</strong></td>
<td style="text-align:center"><strong>接收int类型数据</strong></td>
</tr>
<tr>
<td style="text-align:center">8</td>
<td style="text-align:center">public String next(Pattern pattern)</td>
<td style="text-align:center">普通</td>
<td style="text-align:center">接收输入的内容并进行正则式验证</td>
</tr>
<tr>
<td style="text-align:center">9</td>
<td style="text-align:center">public Scanner useDelimiter(String patten)</td>
<td style="text-align:center">普通</td>
<td style="text-align:center">设置读取的分隔符</td>
</tr>
</tbody>
</table>
<p>​		Scanner类的方法很多是可以重载的，详情可以查阅API帮助文档。</p>
<p>​		需要注意的是，Scanner是一个扫描器，它扫描数据都是去内存中的一块缓冲区中进行扫描并读入数据的，而我们在控制台中输入的数据也都是被先存入缓冲区中等待扫描器的扫描读取。<strong>这个扫描器在扫描过程中判断停止的依据就是&quot;空白符&quot;，空格、回车也算是空白符。</strong></p>
<p>​		nextInt()方法在扫描到空白符的时候会将前面的数据读取走，但会丢下空白符&quot;\r&quot;在缓冲区中，但是，<strong>nextLine()方法在扫描的时候会将扫描到的空白符接收进来，然后把缓冲区的空白符一同清理掉</strong>。在这个过程，nextInt()方法是执行过的，并没有不执行 。</p>
<h3 id="使用scanner类输入数据"><a class="markdownIt-Anchor" href="#使用scanner类输入数据"></a> 使用Scanner类输入数据</h3>
<h4 id="从键盘获取数据"><a class="markdownIt-Anchor" href="#从键盘获取数据"></a> 从键盘获取数据</h4>
<p>​		Scanner类最简单方便的功能就是可以直接获取键盘输入的数据，可以使用next()方法获取字符串，也可以使用nextInt()获取int值。</p>
<p>代码示例：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Scanner scan=<span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">        <span class="keyword">int</span> num=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">float</span> f=<span class="number">0.0f</span>;</span><br><span class="line">        System.out.println(<span class="string">&quot;请输入int型整数：&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span>(scan.hasNextInt())		<span class="comment">//判断输入的数据是否为int型</span></span><br><span class="line">        &#123;</span><br><span class="line">            num=scan.nextInt();</span><br><span class="line">        &#125;<span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;输入的不是整数！&quot;</span>);</span><br><span class="line">            System.exit(<span class="number">0</span>);		<span class="comment">//退出程序</span></span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        System.out.println(<span class="string">&quot;请输入float型小数：&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span>(scan.hasNextFloat())		<span class="comment">//判断输入的数据是否为float型</span></span><br><span class="line">        &#123;</span><br><span class="line">            f=scan.nextFloat();</span><br><span class="line">        &#125;<span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;输入的不是小数！&quot;</span>);</span><br><span class="line">            System.exit(<span class="number">0</span>);		<span class="comment">//退出程序</span></span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        System.out.println(<span class="string">&quot;请输入字符串：&quot;</span>);</span><br><span class="line">        String str=scan.next();</span><br><span class="line">        System.out.println(<span class="string">&quot;整数：&quot;</span>+num+<span class="string">&quot;\n小数：&quot;</span>+f+<span class="string">&quot;\n字符串：&quot;</span>+str);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">请输入int型整数：</span><br><span class="line">645</span><br><span class="line">请输入float型小数：</span><br><span class="line">3.14159</span><br><span class="line">请输入字符串：</span><br><span class="line">Scanner</span><br><span class="line">整数：645</span><br><span class="line">小数：3.14159</span><br><span class="line">字符串：Scanner</span><br></pre></td></tr></table></figure>
<p>​		上面程序中，在使用nextXxx()方法时最好要验证，否则容易产生异常。<strong>若输入的字符串中间含有空格，那么空格之后的数据就没有了</strong>。可以使用useDelimiter()将分隔符修改为换行符“\n”。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Scanner scan=<span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">        scan.useDelimiter(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;请输入字符串：&quot;</span>);</span><br><span class="line">        String str=scan.next();</span><br><span class="line">        System.out.println(str);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">请输入字符串：</span><br><span class="line">java is a programming language</span><br><span class="line">java is a programming language</span><br></pre></td></tr></table></figure>
<h4 id="使用正则式验证输入的数据"><a class="markdownIt-Anchor" href="#使用正则式验证输入的数据"></a> 使用正则式验证输入的数据</h4>
<p>​		前面介绍过，Scanner类可以使用正则表达式来分析基本类型和字符串的简单文本扫描器。下面使用正则式验证邮箱的格式。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Scanner scan=<span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">        String pattern=<span class="string">&quot;^[a-zA-z0-9_\\.]+@[a-zA-z0-9-]+[\\.a-zA-Z]+$&quot;</span>;</span><br><span class="line">        System.out.println(<span class="string">&quot;请输入邮箱地址：&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span>(scan.hasNext(pattern))</span><br><span class="line">        &#123;</span><br><span class="line">            String mail=scan.next();</span><br><span class="line">            System.out.println(<span class="string">&quot;您输入的邮箱为：&quot;</span>+mail);</span><br><span class="line">        &#125;<span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;您输入的邮箱格式不正确！&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">请输入邮箱地址：</span><br><span class="line">123456789@qq.com</span><br><span class="line">您输入的邮箱为：123456789@qq.com</span><br></pre></td></tr></table></figure>
<h4 id="从文件中获取数据"><a class="markdownIt-Anchor" href="#从文件中获取数据"></a> 从文件中获取数据</h4>
<p>​		Scanner类不但可以方便、简洁地从键盘获取数据，还可以从文件获取相应的数据，只需使用Scanner类的public Scanner(InputStream source)构造方法收取文件数据即可。</p>
<p>代码示例：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        File f=<span class="keyword">new</span> File(<span class="string">&quot;D:\\myjava\\测试.txt&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span>(!(f.exists()))		<span class="comment">//判断文件是否存在</span></span><br><span class="line">        &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;文件不存在！&quot;</span>);</span><br><span class="line">            System.exit(<span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        Scanner scan=<span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            FileInputStream fis=<span class="keyword">new</span> FileInputStream(f);</span><br><span class="line">            scan=<span class="keyword">new</span> Scanner(fis);</span><br><span class="line">        &#125;<span class="keyword">catch</span>(IOException e)</span><br><span class="line">        &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        StringBuffer sbu=<span class="keyword">new</span> StringBuffer();</span><br><span class="line">        <span class="keyword">while</span>(scan.hasNext())		<span class="comment">//判断是否还有内容</span></span><br><span class="line">        &#123;</span><br><span class="line">            sbu.append(scan.next()).append(<span class="string">&quot;\n&quot;</span>);		<span class="comment">//读取内容</span></span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(sbu);		<span class="comment">//输入获取的数据</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">2021年08月01日09时37分33秒</span><br><span class="line">123</span><br><span class="line">圆周率：</span><br><span class="line">3.14159</span><br></pre></td></tr></table></figure>
<p>原文：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">2021年08月01日09时37分33秒</span><br><span class="line">123</span><br><span class="line">圆周率：	3.14159</span><br></pre></td></tr></table></figure>
<p>​		next()一定要读取到有效字符后才可以结束输入，对输入有效字符之前遇到的空格键、Tab键或Enter键等结束符，next()方法会自动将其去掉，只有在输入有效字符之后，next()方法才将其后输入的空格键、Tab键或Enter键等视为分隔符或结束符。</p>
<p>参考链接：</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/fnlingnzb-learner/p/6593069.html">java中Scanner类nextLine()和next()的区别和使用方法 - Boblim - 博客园 (cnblogs.com)</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_44743615/article/details/112411556">Scanner.next()无法识别字符串中的空格_凋敝臣楷鸽的博客-CSDN博客</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_36242811/article/details/105463062">java输入hasNext()和hasNextLine()方法的区别ghimi的博客-CSDN博客_hasnext和hasnextline</a></p>
<p>参考书目：</p>
<p><a target="_blank" rel="noopener" href="http://product.dangdang.com/23248198.html?ref=book-35530-3032_5-231497-4">《Java编程手记——从实践中学习Java（配光盘）》(欧二强　等编著)【简介_书评_在线阅读】 - 当当图书 (dangdang.com)</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/4/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/4/">4</a><span class="page-number current">5</span><a class="page-number" href="/page/6/">6</a><span class="space">&hellip;</span><a class="page-number" href="/page/10/">10</a><a class="extend next" rel="next" href="/page/6/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="buyan"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">buyan</p>
  <div class="site-description" itemprop="description">我见过真正难过的人，但他一滴泪也没流</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">98</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">5</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">7</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/silenthly/silenthly.github.io" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;silenthly&#x2F;silenthly.github.io" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://gitee.com/silenthty/silenthty" title="Gitee → https:&#x2F;&#x2F;gitee.com&#x2F;silenthty&#x2F;silenthty" rel="noopener" target="_blank"><i class="fab fa-gitee fa-fw"></i>Gitee</a>
      </span>
  </div>



<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=86 src="//music.163.com/outchain/player?type=2&id=22829933&auto=0&height=66"></iframe>
      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">不言</span>
</div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : 'svTDHGGetnbuzqV1kUczzXeM-gzGzoHsz',
      appKey     : 'lihxfavVgrdWrQwN6xB7C0OS',
      placeholder: "Just go go",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : false,
      lang       : '' || 'zh-cn',
      path       : location.pathname,
      recordIP   : false,
      serverURLs : ''
    });
  }, window.Valine);
});
</script>

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"model":{"jsonPath":"/live2dw/assets/wanko.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"log":false});</script></body>
</html>
